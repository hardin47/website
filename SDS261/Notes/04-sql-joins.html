<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Jo Hardin">
<title>Data Science, the SQL - 4&nbsp; Combining tables in SQL</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./p3-build-db.html" rel="next">
<link href="./03-sql-verbs.html" rel="prev">
<link href="./images/favicon.ico" rel="icon">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script type="text/x-mathjax-config">
const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers){
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');
  
  // Will this work with TeX on its own line?
  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
  	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
  	MathJax.Hub.Queue(function(){
      popover.setAttribute('data-content', div.innerHTML);
  	})
  }
}
</script><link rel="shortcut icon" href="figs/favicon.ico">
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script><link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="site_libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="site_libs/bsTable-3.3.7/bootstrapTable.js"></script><script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script><link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.28/datatables.js"></script><script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script><link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css2?family=Quicksand" type="text/css">
</head>
<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./p2-using-sql.html">Using SQL</a></li><li class="breadcrumb-item"><a href="./04-sql-joins.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Combining tables in SQL</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science, the SQL</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hardin47/SDS261-SQL" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Data Science, the SQL</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p1-intro-to-sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to databases and SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-db.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Databases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-sql-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">SQL in R</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p2-using-sql.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using SQL</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-sql-verbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">SQL clauses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-sql-joins.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Combining tables in SQL</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p3-build-db.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Building databases</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-creating-db.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Creating databases</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-const-change-db.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Creating databases</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./p4-reg-expr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Regular expressions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-reg-expr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regular Expressions</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#subqueries" id="toc-subqueries" class="nav-link active" data-scroll-target="#subqueries"><span class="header-section-number">4.1</span> Subqueries</a></li>
  <li>
<a href="#all-the-joins" id="toc-all-the-joins" class="nav-link" data-scroll-target="#all-the-joins"><span class="header-section-number">4.2</span> All the <code>JOIN</code>s</a>
  <ul class="collapse">
<li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join"><span class="header-section-number">4.2.1</span> <code>JOIN</code></a></li>
  <li><a href="#other-joins" id="toc-other-joins" class="nav-link" data-scroll-target="#other-joins"><span class="header-section-number">4.2.2</span> Other <code>JOIN</code>s</a></li>
  </ul>
</li>
  <li><a href="#union" id="toc-union" class="nav-link" data-scroll-target="#union"><span class="header-section-number">4.3</span> <code>UNION</code></a></li>
  <li>
<a href="#union-all" id="toc-union-all" class="nav-link" data-scroll-target="#union-all"><span class="header-section-number">4.4</span> <code>UNION ALL</code></a>
  <ul class="collapse">
<li><a href="#full-outer-join" id="toc-full-outer-join" class="nav-link" data-scroll-target="#full-outer-join"><span class="header-section-number">4.4.1</span> <code>FULL OUTER JOIN</code></a></li>
  </ul>
</li>
  </ul><div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/hardin47/SDS261-SQL/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title"><span id="sec-join" class="quarto-section-identifier"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Combining tables in SQL</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><p>Beyond <code>SELECT</code> queries, the next most fundamental actions in <strong>SQL</strong> have to do with working with two or more tables simultaneously. If you have worked in <strong>R</strong>, you may be familiar with the <code>join_()</code> family of functions. Moving beyond <code>JOIN</code>, we will also cover subqueries which create temporary tables inside a <strong>SQL</strong> statement.</p>
<p>The database we’ll work with for learning how to combine tables is on Yelp reviews. There are three tables: <code>businesses</code>, <code>reviews</code>, and <code>users</code>, see <span class="quarto-unresolved-ref">?tbl-yelp-tables</span>. From the <code>EXPLAIN</code> output <span class="quarto-unresolved-ref">?tbl-bus-vars</span>, <span class="quarto-unresolved-ref">?tbl-rev-vars</span>, <span class="quarto-unresolved-ref">?tbl-user-vars</span>, we can see that the tables match up by ID. The variable <code>id</code> in the <code>businesses</code> table is the same as the variable <code>business_id</code> in the <code>reviews</code> table. <code>user_id</code> is the same variable in both the <code>reviews</code> and <code>users</code> tables. The connections across the tables will be important when performing <code>JOIN</code>s.</p>
<div class="cell" data-fig.asp="0.618">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">con_imdb</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html">dbConnect</a></span><span class="op">(</span></span>
<span>  <span class="fu">RMariaDB</span><span class="fu">::</span><span class="fu"><a href="https://rmariadb.r-dbi.org/reference/dbConnect-MariaDBDriver-method.html">MariaDB</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  dbname <span class="op">=</span> <span class="st">"imdb"</span>,</span>
<span>  host <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SMITH_HOST"</span><span class="op">)</span>,</span>
<span>  user <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SMITH_USER"</span><span class="op">)</span>,</span>
<span>  password <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span><span class="op">(</span><span class="st">"SMITH_PWD"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As seen in <a href="#tbl-imdb-tables">Table&nbsp;<span>4.1</span></a>, there are 21 tables in the <code>imdb</code> database! We won’t go into details about what each one of them means, but it is a <strong>huge</strong> database with details on movies, TV series, video games, and more. For our work, we are interested only in movies (and details within, like actors and ratings).</p>
<div class="cell" data-output.var="imdb_tables" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>SHOW <span class="kw">TABLES</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-imdb-tables" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.1: SHOW all the TABLES in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Tables_in_imdb</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">aka_name</td>
</tr>
<tr class="even">
<td style="text-align: left;">aka_title</td>
</tr>
<tr class="odd">
<td style="text-align: left;">cast_info</td>
</tr>
<tr class="even">
<td style="text-align: left;">char_name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">comp_cast_type</td>
</tr>
<tr class="even">
<td style="text-align: left;">company_name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">company_type</td>
</tr>
<tr class="even">
<td style="text-align: left;">complete_cast</td>
</tr>
<tr class="odd">
<td style="text-align: left;">info_type</td>
</tr>
<tr class="even">
<td style="text-align: left;">keyword</td>
</tr>
<tr class="odd">
<td style="text-align: left;">kind_type</td>
</tr>
<tr class="even">
<td style="text-align: left;">link_type</td>
</tr>
<tr class="odd">
<td style="text-align: left;">movie_companies</td>
</tr>
<tr class="even">
<td style="text-align: left;">movie_info</td>
</tr>
<tr class="odd">
<td style="text-align: left;">movie_info_idx</td>
</tr>
<tr class="even">
<td style="text-align: left;">movie_keyword</td>
</tr>
<tr class="odd">
<td style="text-align: left;">movie_link</td>
</tr>
<tr class="even">
<td style="text-align: left;">name</td>
</tr>
<tr class="odd">
<td style="text-align: left;">person_info</td>
</tr>
<tr class="even">
<td style="text-align: left;">role_type</td>
</tr>
<tr class="odd">
<td style="text-align: left;">title</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>If you are curious about the database, you can glance through each of the tables separately using a <code>SELECT</code> command (don’t forget to use <code>LIMIT</code>, especially on a table you haven’t previously explored).</p>
<div class="cell" data-output.var="select_kind" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> kind_type</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-select-kind" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.2: SELECT to glance at the kind_type table in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">kind</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">movie</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">tv series</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">tv movie</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">video movie</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">tv mini series</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">video game</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">episode</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<section id="subqueries" class="level2" data-number="4.1"><h2 data-number="4.1" class="anchored" data-anchor-id="subqueries">
<span class="header-section-number">4.1</span> Subqueries</h2>
<p>A <strong>SQL</strong> <strong>subquery</strong> is a query used as a data source in the <code>FROM</code> clause, instead of the usual table. There was a subquery in <a href="03-sql-verbs.html#tbl-length-time2">Table&nbsp;<span>3.6</span></a> when the task required a function of the <em>results set</em> within the <code>SELECT</code> clause.</p>
</section><section id="all-the-joins" class="level2" data-number="4.2"><h2 data-number="4.2" class="anchored" data-anchor-id="all-the-joins">
<span class="header-section-number">4.2</span> All the <code>JOIN</code>s</h2>
<p>Recall that <strong>SQL</strong> is a programming language that works on <em>relational databases</em>. One of its major strengths is being able to efficiently store information in separate tables that can be easily connected as needed. The syntax for tying together information from multiple tables is done with a <code>JOIN</code> clause.</p>
<p>Each <code>JOIN</code> clause needs four specific pieces of information:</p>
<ol type="1">
<li>The name of the first table you want to <code>JOIN</code>.</li>
<li>The type of <code>JOIN</code> being used.</li>
<li>The name of the second table you want to <code>JOIN</code>.</li>
<li>The condition(s) under which you want the records in the first table to match records in the second table.</li>
</ol>
<p>Some types of <code>JOIN</code>s available in <strong>MySQL</strong> include the following, which are represented as Venn diagrams in <a href="#fig-venn-joins">Figure&nbsp;<span>4.1</span></a>.</p>
<ul>
<li>
<code>JOIN</code>: include all of the rows that exist in both tables (similar to <code>inner_join()</code> in <strong>R</strong>, the intersection of the two tables). <code>INNER JOIN</code> is alternative, and identical, function to <code>JOIN</code>.</li>
<li>
<code>LEFT JOIN</code>: include all of the rows in the first table. Connect them, as much as possible, to the rows in the second table. Rows that have no match in the second table will have a value of <code>NULL</code> for the new “second table” variables.</li>
<li>
<code>RIGHT JOIN</code>: include all of the rows in the second table. Connect them, as much as possible, to the rows in the first table. Rows that have no match in the first table will have a value of <code>NULL</code> for the new “first table” variables. A <code>RIGHT JOIN</code> with the tables in the opposite order is the same as a <code>LEFT JOIN</code> with the tables in the original order.</li>
<li>
<code>FULL OUTER JOIN</code>: include all rows in either table. Rows that have no match in the other table will have a value of <code>NULL</code> for the other table variables. (similar to <code>full_join()</code> in <strong>R</strong>, the union of the two tables). The functionality doesn’t exist in <strong>MySQL</strong> but can be created using joins and <code>UNION</code>.</li>
<li>
<code>CROSS JOIN</code>: match each row of the first table with each row in the second table.</li>
</ul>
<p><a href="#fig-venn-joins">Figure&nbsp;<span>4.1</span></a> shows Venn diagrams of the different types of joins. <a href="#fig-table-joins">Figure&nbsp;<span>4.2</span></a> shows four of the <code>JOIN</code> functions with mini data tables. Note that in <strong>SQL</strong> the missing values will be labeled as <code>NULL</code> (not <code>NA</code>).</p>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="fig-venn-joins" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/join-types.png" class="img-fluid figure-img" style="width:70.0%" alt="Venn diagrams describing different types of JOINs."></p>
<figcaption class="figure-caption">Figure&nbsp;4.1: Venn diagrams describing different JOINs, image credit: phoenixNAP https://phoenixnap.com/kb/mysql-join</figcaption></figure>
</div>
</div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="fig-table-joins" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="images/table-joins.png" class="img-fluid figure-img" style="width:70.0%" alt="Mini data tables describing different types of JOINs."></p>
<figcaption class="figure-caption">Figure&nbsp;4.2: Mini data tables describing different JOINs, image credit: Statistics Globe blog, https://statisticsglobe.com/r-dplyr-join-inner-left-right-full-semi-anti</figcaption></figure>
</div>
</div>
</div>
<section id="join" class="level3" data-number="4.2.1"><h3 data-number="4.2.1" class="anchored" data-anchor-id="join">
<span class="header-section-number">4.2.1</span> <code>JOIN</code>
</h3>
<p>–&gt; to make the JOINs different, make the the tables something… either smaller or random sample or something. Maybe just one year? Do ther WHERE command before the JOIN command.</p>
<p>In the <code>imdb</code> database, the <code>title</code> table includes information about the 4,626,322 titles in the database, including the <code>id</code>, <code>title</code>, <code>kind_id</code> (indicator for the kind of ID it is), and <code>production_year</code>. It does not, however, include the review of the title. See <a href="#tbl-title-glance">Table&nbsp;<span>4.3</span></a>.</p>
<div class="cell" data-output.var="title_glance" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> title <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-title-glance" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.3: SELECT to glance at the title table in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">title</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">imdb_index</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">kind_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">production_year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">imdb_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">phonetic_code</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">episode_of_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">season_nr</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">episode_nr</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">series_years</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">md5sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">78460</td>
<td style="text-align: left;">Adults Recat to the Simpsons (30th Anniversary)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;"></td>
<td style="text-align: left;">A3432</td>
<td style="text-align: right;">78406</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">2ae09eed7d576cc2c24774fed5b18168</td>
</tr>
<tr class="even">
<td style="text-align: right;">70273</td>
<td style="text-align: left;">(2016-05-18)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">68058</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">511dfc14cfff7589d29a95abb30cd66a</td>
</tr>
<tr class="odd">
<td style="text-align: right;">60105</td>
<td style="text-align: left;">(2014-04-11)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">59138</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">c6cdce7e667e07713e431805c407feed</td>
</tr>
<tr class="even">
<td style="text-align: right;">32120</td>
<td style="text-align: left;">(2008-05-01)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2008</td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">32060</td>
<td style="text-align: right;"></td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">100df65742caf5afd092b2e0ead67d8e</td>
</tr>
<tr class="odd">
<td style="text-align: right;">97554</td>
<td style="text-align: left;">SchmÃ¶lders Traum</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2001</td>
<td style="text-align: right;"></td>
<td style="text-align: left;">S2543</td>
<td style="text-align: right;">97302</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">46862a2f96f9fb2d59e8c9a11ecfdd28</td>
</tr>
<tr class="even">
<td style="text-align: right;">57966</td>
<td style="text-align: left;">(#1.1)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2013</td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">57965</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">409c37703766c4b24f8a86162fd9cf85</td>
</tr>
<tr class="odd">
<td style="text-align: right;">76391</td>
<td style="text-align: left;">Anniversary</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">1971</td>
<td style="text-align: right;"></td>
<td style="text-align: left;">A5162</td>
<td style="text-align: right;">76385</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">5e12ce73fac1d1dcf94136b6e9acd8f8</td>
</tr>
<tr class="even">
<td style="text-align: right;">11952</td>
<td style="text-align: left;">Angus Black/Lester Barrie/DC Curry</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2009</td>
<td style="text-align: right;"></td>
<td style="text-align: left;">A5214</td>
<td style="text-align: right;">11937</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">9c38b9e5601dc154444b73b518034aa1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1554</td>
<td style="text-align: left;">New Orleans</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;"></td>
<td style="text-align: left;">N6452</td>
<td style="text-align: right;">1508</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">621bea735740a547e862e4a3226f35d2</td>
</tr>
<tr class="even">
<td style="text-align: right;">58442</td>
<td style="text-align: left;">Kiss Me Kate</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">2011</td>
<td style="text-align: right;"></td>
<td style="text-align: left;">K2523</td>
<td style="text-align: right;">58436</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">293e8c75c7f35a4035abf617962be5a9</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>The <code>movie_info_idx</code> table does not contain much information about each particular film. It does, however, have an indicator for the movie ID (given by <code>movie_id</code>) as well as the rating (given by <code>info</code> where <code>type_id = 100</code>).</p>
<div class="cell" data-output.var="idx_glance" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> movie_info_idx <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">6</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-idx-glance" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.4: SELECT to glance at the movie_info_idx table in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">movie_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">info_type_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">info</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">note</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">99</td>
<td style="text-align: left;">31.2.1..2.</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">4.1</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">99</td>
<td style="text-align: left;">1000000102</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">100</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">101</td>
<td style="text-align: left;">6.4</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Let’s say we want to combine the titles with the ratings so that each title with user rating is included. That is, only keep the titles that have a corresponding rating. And also, only keep the rating if there is an associated title (which means we use <code>INNER JOIN</code> or just plain <code>JOIN</code>).</p>
<p>Remember that <code>WHERE</code> will work on the raw variables, and <code>HAVING</code> works on the results set.</p>
<p>Some aspects of the query are worth pointing out: * The variables in the output are given in the <code>SELECT</code> clause. The <code>id</code> and <code>title</code> (both from the <code>title</code> table) and the <code>info</code> fromt he <code>movie_info_idx</code> which represents the number of IMDb votes. * The variables are preceded by the table from which they came. While not always necessary, it is good practice so as to avoid confusion. * The <code>JOIN</code> happens by linking the <code>id</code> variable in the <code>title</code> table with the <code>movie_id</code> variable in the <code>movie_info_idx</code> table. * The <code>LIMIT</code> wasn’t necessary (there are only 12 observations), but it’s good practice so that we don’t end up with unwieldy query results. * The <code>WHERE</code> clause happens before the <code>JOIN</code> action, despite being written after. * In the <code>WHERE</code> clause, we keep only movies, only 2015 production year, and only at least 150,000 votes.</p>
<div class="cell" data-output.var="movie_join" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> title.<span class="kw">id</span>,</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>       title.title,</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>       movie_info_idx.info</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">ON</span> title.<span class="kw">id</span> <span class="op">=</span> movie_info_idx.movie_id </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> title.production_year <span class="op">=</span> <span class="dv">2015</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> title.kind_id <span class="op">=</span> <span class="dv">1</span>                  # movies <span class="kw">only</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> movie_info_idx.info_type_id <span class="op">=</span> <span class="dv">100</span>  # rating <span class="kw">is</span> votes</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> movie_info_idx.info <span class="op">&gt;</span> <span class="dv">150000</span>       # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">150</span>,<span class="dv">000</span> votes</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> movie_info_idx.info <span class="kw">DESC</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">20</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-movie-join" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.5: Movies from 2015 that have at least 150,000 votes in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">title</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">info</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4260166</td>
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
</tr>
<tr class="even">
<td style="text-align: right;">3915213</td>
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4389619</td>
<td style="text-align: left;">The Martian</td>
<td style="text-align: left;">583987</td>
</tr>
<tr class="even">
<td style="text-align: right;">3313672</td>
<td style="text-align: left;">Avengers: Age of Ultron</td>
<td style="text-align: left;">540606</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4414139</td>
<td style="text-align: left;">The Revenant</td>
<td style="text-align: left;">526189</td>
</tr>
<tr class="even">
<td style="text-align: right;">3787790</td>
<td style="text-align: left;">Jurassic World</td>
<td style="text-align: left;">471237</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3752999</td>
<td style="text-align: left;">Inside Out</td>
<td style="text-align: left;">443051</td>
</tr>
<tr class="even">
<td style="text-align: right;">3292159</td>
<td style="text-align: left;">Ant-Man</td>
<td style="text-align: left;">390965</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4364483</td>
<td style="text-align: left;">The Hateful Eight</td>
<td style="text-align: left;">363199</td>
</tr>
<tr class="even">
<td style="text-align: right;">4251736</td>
<td style="text-align: left;">Spectre</td>
<td style="text-align: left;">319875</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3630368</td>
<td style="text-align: left;">Furious Seven</td>
<td style="text-align: left;">310970</td>
</tr>
<tr class="even">
<td style="text-align: right;">4255450</td>
<td style="text-align: left;">Spotlight</td>
<td style="text-align: left;">290362</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3961438</td>
<td style="text-align: left;">Mission: Impossible - Rogue Nation</td>
<td style="text-align: left;">266759</td>
</tr>
<tr class="even">
<td style="text-align: right;">4321769</td>
<td style="text-align: left;">The Big Short</td>
<td style="text-align: left;">262598</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4221220</td>
<td style="text-align: left;">Sicario</td>
<td style="text-align: left;">260996</td>
</tr>
<tr class="even">
<td style="text-align: right;">3600120</td>
<td style="text-align: left;">Fifty Shades of Grey</td>
<td style="text-align: left;">250962</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4164324</td>
<td style="text-align: left;">Room</td>
<td style="text-align: left;">244210</td>
</tr>
<tr class="even">
<td style="text-align: right;">3379559</td>
<td style="text-align: left;">Bridge of Spies</td>
<td style="text-align: left;">229440</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4368666</td>
<td style="text-align: left;">The Hunger Games: Mockingjay - Part 2</td>
<td style="text-align: left;">214569</td>
</tr>
<tr class="even">
<td style="text-align: right;">4387967</td>
<td style="text-align: left;">The Man from U.N.C.L.E.</td>
<td style="text-align: left;">213754</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Let’s say we also want to obtain information about the actors and actresses in each of the movies. In the <code>cast_info</code> table, there is a <code>person_id</code>, a <code>movie_id</code>, and <code>person_role_id</code> is <code>1</code> if actor and <code>2</code> if actress.</p>
<div class="cell" data-output.var="cast_glance" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> cast_info <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-cast-glance" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.6: SELECT to glance at the cast_info table in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">person_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">movie_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">person_role_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">note</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nr_order</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">role_id</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3432997</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1901690</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;"></td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4027567</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4282876</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3542672</td>
<td style="text-align: right;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">12</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">3331520</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">(as $hutter Boy)</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4027191</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">(as $hutter Boy)</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4195731</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">(uncredited)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4263956</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">(uncredited)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4267787</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">(uncredited)</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>We also want the name of the actress which is in the table <code>aka_name</code>. Note that there is no <em>movie</em> information in the <code>aka_name</code> table!</p>
<div class="cell" data-output.var="name_glance" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span> aka_name <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">10</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-name-glance" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.7: SELECT to glance at the aka_name table in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">person_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">imdb_index</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name_pcode_cf</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name_pcode_nf</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">surname_pcode</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">md5sum</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">6188450</td>
<td style="text-align: left;">Smith, Jessica Noel</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">S5325</td>
<td style="text-align: left;">J2542</td>
<td style="text-align: left;">S53</td>
<td style="text-align: left;">25c9d464e3ff2957533546aa92b397ed</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">5125059</td>
<td style="text-align: left;">Pain, L. $ham</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">P545</td>
<td style="text-align: left;">L515</td>
<td style="text-align: left;">P5</td>
<td style="text-align: left;">569b1e885ccb51211c01753f0dad9b2c</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">Boy, $hutter</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">B36</td>
<td style="text-align: left;">H361</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">35092b5604ce378fc48c8a6fc0038a49</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">4152053</td>
<td style="text-align: left;">Dollasign, Ty</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">D4253</td>
<td style="text-align: left;">T3425</td>
<td style="text-align: left;">D425</td>
<td style="text-align: left;">0f565a2d8027cfb8ed6c5f4bba719fcd</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">4152053</td>
<td style="text-align: left;">Sign, Ty Dolla</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">S2534</td>
<td style="text-align: left;">T3425</td>
<td style="text-align: left;">S25</td>
<td style="text-align: left;">2eded1b021b96333b4b74e0fec959650</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">Moore, Brandon</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">M6165</td>
<td style="text-align: left;">B6535</td>
<td style="text-align: left;">M6</td>
<td style="text-align: left;">193a6f5adf4756320f622162d2475608</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: right;">8</td>
<td style="text-align: left;">$torm, Country</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">T6525</td>
<td style="text-align: left;">C5363</td>
<td style="text-align: left;">T65</td>
<td style="text-align: left;">1654400b707d34323ea392b87060e6cc</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">'Hooper', Simon P.J. Kelly</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">H1625</td>
<td style="text-align: left;">S5124</td>
<td style="text-align: left;">H16</td>
<td style="text-align: left;">3fd8885372c23f8c74e583da91d1fd05</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">Hooper</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">H16</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">24ddc68ab605ee95857ad45b65ffa2d8</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">Kelly, Simon P.J.</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">K4251</td>
<td style="text-align: left;">S5124</td>
<td style="text-align: left;">K4</td>
<td style="text-align: left;">33d976f22e276b73c61513bc5f6e72a6</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Connecting the most popular movies of 2015 with the actresses in those movies requires a series of <code>JOIN</code>s. Note that to make the code less onerous, the <code>title</code> table has been aliased by <code>t</code>, the <code>movie_info_idx</code> table has been aliased by <code>idx</code>, the <code>cast_info</code> table has been aliased by <code>a</code>, and the <code>aka_name</code> table has been aliased by <code>n</code>.</p>
<p>There is a lot of data cleaning to do as some of the <code>person_id</code> values are one to many!! That is, the <code>person_id</code> matches multiple names in the <code>aka_name</code> database.</p>
<div class="cell" data-output.var="movie_join_actress" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.title,</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>       idx.info,</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>       a.person_id,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>       n.name</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> t.<span class="kw">id</span> <span class="op">=</span> idx.movie_id </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> cast_info <span class="kw">AS</span> a <span class="kw">ON</span> idx.movie_id <span class="op">=</span> a.movie_id</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>           # movies <span class="kw">only</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>  # rating <span class="kw">is</span> votes</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">150000</span>       # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">150</span>,<span class="dv">000</span> votes</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> a.role_id <span class="op">=</span> <span class="dv">2</span>           # actresses <span class="kw">only</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> idx.info <span class="kw">DESC</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">50</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-movie-join-actress" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.8: Movies from 2015 that have at least 150,000 votes in the imdb database with the actress name joined.</caption>
<thead><tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">title</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">info</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">person_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">2698188</td>
<td style="text-align: left;">Sam</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">2806101</td>
<td style="text-align: left;">Gillespie, Hilary Catherine</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">2959609</td>
<td style="text-align: left;">Cuzner, Natalie</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3089483</td>
<td style="text-align: left;">Fisher, Carrie Frances</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3150880</td>
<td style="text-align: left;">Class, Clare</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3150880</td>
<td style="text-align: left;">Glass, Claire</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3231758</td>
<td style="text-align: left;">Henwick, Jessica Yu Li</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3265686</td>
<td style="text-align: left;">Hui, Karen</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3305561</td>
<td style="text-align: left;">Kamen, Hannah John</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3462940</td>
<td style="text-align: left;">Billy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3462940</td>
<td style="text-align: left;">Lourd, Billie Catherine</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3569409</td>
<td style="text-align: left;">Fran</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3649948</td>
<td style="text-align: left;">Nyongo, Lupita</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3649948</td>
<td style="text-align: left;">Nyong'o, Lupita Amondi</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3785240</td>
<td style="text-align: left;">Ridley, Daisy Jazz Isobel</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3835377</td>
<td style="text-align: left;">Giagrande, Meredith J.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3835377</td>
<td style="text-align: left;">Salinger, Meredith</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3835377</td>
<td style="text-align: left;">Salenger, Meredith Dawn</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3850834</td>
<td style="text-align: left;">Phi</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3875581</td>
<td style="text-align: left;">Fox, Claudia</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3879039</td>
<td style="text-align: left;">Arti</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3907812</td>
<td style="text-align: left;">Slade, Sandy</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3907812</td>
<td style="text-align: left;">Sandy</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3907812</td>
<td style="text-align: left;">Sandy Slade</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3938795</td>
<td style="text-align: left;">Ryan, Karol Lesley</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Stevens, Cat</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Taber, Cat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Tabor, Cat</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Cat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Stevens, Cat</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Taber, Cat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Tabor, Cat</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">3970637</td>
<td style="text-align: left;">Cat</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">4073883</td>
<td style="text-align: left;">Walter, Dame Harriet</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">4073883</td>
<td style="text-align: left;">Walter, Harriet Mary</td>
</tr>
<tr class="even">
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">4094732</td>
<td style="text-align: left;">White, Kelsey Marie</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">2681098</td>
<td style="text-align: left;">Michelle, Debra</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">2782138</td>
<td style="text-align: left;">Ali</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">2873752</td>
<td style="text-align: left;">Cardona, Helena</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">2873752</td>
<td style="text-align: left;">Cardona, Helene</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">2873752</td>
<td style="text-align: left;">Cardona, HÃ©lÃ¨ne Vania</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">2957052</td>
<td style="text-align: left;">Cunico, Lillie</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3087531</td>
<td style="text-align: left;">Finlay, Sandi 'Hotrod'</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3087531</td>
<td style="text-align: left;">Finlay, Sandi 'Hotrod'</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3146859</td>
<td style="text-align: left;">Gilles, Coco Jack</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3146859</td>
<td style="text-align: left;">Gillies, Coco</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3268456</td>
<td style="text-align: left;">Rose</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3268456</td>
<td style="text-align: left;">Huntington-Whiteley, Rosie Alice</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3343489</td>
<td style="text-align: left;">Kellerman, Antoinette</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">3348513</td>
<td style="text-align: left;">Riley</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section><section id="other-joins" class="level3" data-number="4.2.2"><h3 data-number="4.2.2" class="anchored" data-anchor-id="other-joins">
<span class="header-section-number">4.2.2</span> Other <code>JOIN</code>s</h3>
<p>first, do an example with the band members https://rpubs.com/will-kent/stds-vignette</p>
<p>Consider the following two tables. The first has seven movies in it (from 2015 with at least 400,000 IMDb votes). The second consists of almost 3 million actresses (<code>person_role_id = 2</code>). In order to find a subset of actresses, the <code>person_id &gt; 3900000</code> was set arbitrarily (in order to have a smaller group with which to work).</p>
<section id="movies" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="movies">movies:</h4>
<div class="cell" data-output.var="top_movies" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>       t.title,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>       idx.info,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>       <span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>       <span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>       <span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>             <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>             <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>             <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> row_count</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>             # movies <span class="kw">only</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>    # rating <span class="kw">is</span> votes</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>         # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="kw">ORDER</span> <span class="kw">BY</span> idx.info <span class="kw">DESC</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-top-movies" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.9: Movies from 2015 that have at least 400,000 votes in the imdb database.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">title</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">info</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">row_count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">4260166</td>
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: left;">691691</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3915213</td>
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: left;">666484</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4389619</td>
<td style="text-align: left;">The Martian</td>
<td style="text-align: left;">583987</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3313672</td>
<td style="text-align: left;">Avengers: Age of Ultron</td>
<td style="text-align: left;">540606</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4414139</td>
<td style="text-align: left;">The Revenant</td>
<td style="text-align: left;">526189</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: right;">3787790</td>
<td style="text-align: left;">Jurassic World</td>
<td style="text-align: left;">471237</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3752999</td>
<td style="text-align: left;">Inside Out</td>
<td style="text-align: left;">443051</td>
<td style="text-align: right;">7</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section><section id="actresses" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="actresses">actresses:</h4>
<div class="cell" data-output.var="actresses" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> a.person_id,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>       a.movie_id,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>       n.name,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>       (<span class="kw">SELECT</span> <span class="fu">COUNT</span>(<span class="op">*</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>       <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>       <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>       <span class="kw">WHERE</span> a.person_role_id <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>             <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">390000</span>) <span class="kw">AS</span> row_count</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>       <span class="kw">WHERE</span> a.person_role_id <span class="op">=</span> <span class="dv">2</span>  </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>             <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">20</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-actresses" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.10: Actresses whose <code>person_id</code> is greater than 400000. Note that some actresses have different spelling or phrasing of their names.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">person_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">movie_id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">name</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">row_count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3900141</td>
<td style="text-align: right;">759802</td>
<td style="text-align: left;">Simons, Rita Joanne</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3902258</td>
<td style="text-align: right;">4365829</td>
<td style="text-align: left;">Singer, Rabbi Tovia</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3902699</td>
<td style="text-align: right;">3109788</td>
<td style="text-align: left;">Singh, Sabine Erika</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3903035</td>
<td style="text-align: right;">3215866</td>
<td style="text-align: left;">Val</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3904831</td>
<td style="text-align: right;">2468067</td>
<td style="text-align: left;">Masha</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3904928</td>
<td style="text-align: right;">3654347</td>
<td style="text-align: left;">Fei, Siu Yin</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3904928</td>
<td style="text-align: right;">3654347</td>
<td style="text-align: left;">Hsiao, Yen-fei</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3904928</td>
<td style="text-align: right;">3654347</td>
<td style="text-align: left;">Siu, Yinfei</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3904928</td>
<td style="text-align: right;">3654347</td>
<td style="text-align: left;">Xiao, Yanfei</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3904928</td>
<td style="text-align: right;">3654347</td>
<td style="text-align: left;">Yin-Fai, Siu</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3905289</td>
<td style="text-align: right;">115191</td>
<td style="text-align: left;">Coso, Cosondra</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3905289</td>
<td style="text-align: right;">115191</td>
<td style="text-align: left;">Sjostrom, Cossondra</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3905289</td>
<td style="text-align: right;">115191</td>
<td style="text-align: left;">Coso</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3909355</td>
<td style="text-align: right;">2939100</td>
<td style="text-align: left;">SlovÃ¡ckovÃ¡, Anna Julie</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3911826</td>
<td style="text-align: right;">4379610</td>
<td style="text-align: left;">Meador, Constance June</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3912134</td>
<td style="text-align: right;">2675144</td>
<td style="text-align: left;">DJ</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3912134</td>
<td style="text-align: right;">2675144</td>
<td style="text-align: left;">Smith, DJ</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3912134</td>
<td style="text-align: right;">2675144</td>
<td style="text-align: left;">Smith, Dujonette</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3912134</td>
<td style="text-align: right;">2675144</td>
<td style="text-align: left;">DJ Smith</td>
<td style="text-align: right;">2904759</td>
</tr>
<tr class="even">
<td style="text-align: right;">3913519</td>
<td style="text-align: right;">1678444</td>
<td style="text-align: left;">Keely, Dorothy Jacqueline</td>
<td style="text-align: right;">2904759</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Using subqueries, we can <code>JOIN</code> the two datasets using different <code>JOIN</code> techniques.</p>
</section><section id="inner-join" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="inner-join">Inner <code>JOIN</code>
</h4>
<p>With an inner <code>JOIN</code>, there are 32 rows corresponding to all the actresses in the seven 2015 films with the most votes. Because the <code>JOIN</code> is an intersection of the two tables, only the actresses with <code>person_id</code> above 3900000 are included.</p>
<div class="cell" data-output.var="inner_movie_actress" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>(<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>       t.title</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # rating <span class="kw">is</span> votes</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes     </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a><span class="kw">INNER</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>       a.movie_id,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>       n.name</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">300</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tbl-inner-movie-actress" class="cell tbl-parent quarto-layout-panel anchored" data-tbl-cap="Inner `JOIN` of movies and actresses." data-fig.asp="0.618">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-86dc17bbd8304768193a" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-86dc17bbd8304768193a">{"x":{"filter":"none","vertical":false,"data":[[3313672,3752999,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3915213,3915213,3915213,3915213,3915213,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4389619],["Avengers: Age of Ultron","Inside Out","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Mad Max: Fury Road","Mad Max: Fury Road","Mad Max: Fury Road","Mad Max: Fury Road","Mad Max: Fury Road","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","The Martian"],[3916648,4122876,3938423,3938423,3950111,4079047,4079047,4084626,4084626,4084626,4099458,3958614,3990819,3990819,4081131,4081131,3907812,3907812,3907812,3938795,3970637,3970637,3970637,3970637,3970637,3970637,3970637,3970637,4073883,4073883,4094732,4098918],[3313672,3752999,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3915213,3915213,3915213,3915213,3915213,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4389619],["Smulders, Jacoba Francisca Maria","Kuzniar, Lennon Wynn","Norvell, Ingrid","Norvell, Ingrid","Sallaway, Seannon Jane","Washington, Kelly Lynn","Washington, Kelly Lynn","Weeks, Jency","Jenc","Little J","Curtis, Bonnie","Ness","Teron, Sharliz","Charlie","Lumb, Leanne","Watson, Leanne","Slade, Sandy","Sandy","Sandy Slade","Ryan, Karol Lesley","Stevens, Cat","Taber, Cat","Tabor, Cat","Cat","Stevens, Cat","Taber, Cat","Tabor, Cat","Cat","Walter, Dame Harriet","Walter, Harriet Mary","White, Kelsey Marie","Wiig, Kristen Carroll"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>movie ID<\/th>\n      <th>movie title<\/th>\n      <th>actress ID<\/th>\n      <th>movie ID<\/th>\n      <th>actress<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"columnDefs":[{"className":"dt-right","targets":[0,2,3]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</section><section id="right-join" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="right-join"><code>RIGHT JOIN</code></h4>
<p>With a <code>RIGHT JOIN</code>, there are more than 300 rows (the <code>LIMIT</code> clause keeps us from knowing how many rows, but there are a LOT!) corresponding to all the actresses whose <code>person_id</code> above 3900000 are included. Those actresses who acted in one of the seven top 2015 films are also included in the full results table, but they don’t happen to be in the truncated output here.</p>
<div class="cell" data-output.var="right_movie_actress" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>(<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>       t.title</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # rating <span class="kw">is</span> votes</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes     </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="kw">RIGHT</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>       a.movie_id,</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>       n.name</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">300</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tbl-right-movie-actress" class="cell tbl-parent quarto-layout-panel anchored" data-tbl-cap="`RIGHT JOIN` of movies and actresses." data-fig.asp="0.618">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-f50f63c007c2286b17b9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-f50f63c007c2286b17b9">{"x":{"filter":"none","vertical":false,"data":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900001,3900006,3900006,3900006,3900006,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900023,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900025,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026,3900026],[3355298,3509490,3739780,3943329,165963,268249,268370,268406,268475,279082,279273,339664,675926,676205,677227,679656,775378,871147,989916,1083325,1083404,1108209,1129333,1153344,1233492,1393158,1405819,1512713,1630881,1630908,1630928,1660000,1666275,1666292,1666308,1666348,1666381,1791827,1791843,1791856,1930879,2147044,2186734,2186762,2186829,2186931,2186960,2186971,2186974,2186983,2187019,2187082,2187094,2187158,2223989,2388250,2508034,2508193,2938020,3073094,3169335,3177261,3355298,3509490,3739780,3943329,165963,268249,268370,268406,268475,279082,279273,339664,675926,676205,677227,679656,775378,871147,989916,1083325,1083404,1108209,1129333,1153344,1233492,1393158,1405819,1512713,1630881,1630908,1630928,1660000,1666275,1666292,1666308,1666348,1666381,1791827,1791843,1791856,1930879,2147044,2186734,2186762,2186829,2186931,2186960,2186971,2186974,2186983,2187019,2187082,2187094,2187158,2223989,2388250,2508034,2508193,2938020,3073094,3169335,3177261,3812588,1014440,3812588,1014440,3816683,3911969,4033206,4109319,1385492,1385492,1530382,1530387,1530388,1530389,1722643,3816683,3911969,4033206,4109319,1385492,1385492,1530382,1530387,1530388,1530389,1722643,3816683,3911969,4033206,4109319,1385492,1385492,1530382,1530387,1530388,1530389,1722643,3519698,3760415,4109663,4171616,4176897,4294407,4494503,4534730,4589261,244167,1589238,2392628,2945406,3065023,3243621,3255682,3323673,3342584,3491112,3513296,3522540,3522876,3540195,3540281,3562030,3620780,3636370,3655139,3792993,3796326,3796751,3814077,3816391,3819665,3885945,3934589,3963515,4033695,4097163,4110770,4114028,4116601,4116602,4117811,4121499,4130771,4135167,4162264,4171619,4194161,4216755,4229825,4239244,4287425,4477961,4486269,4515670,4535627,4593087,451164,644655,662741,662771,861478,868199,868200,868201,1281504,1347728,1398927,1398928,1398931,2016596,2462087,3044932,3243621,3255682,3323673,3342584,3491112,3513296,3522540,3522876,3540195,3540281,3562030,3620780,3636370,3655139,3792993,3796326,3796751,3814077,3816391,3819665,3885945,3934589,3963515,4033695,4097163,4110770,4114028,4116601,4116602,4117811,4121499,4130771,4135167,4162264,4171619,4194161,4216755,4229825,4239244,4287425,4477961,4486269,4515670,4535627,4593087,451164,644655,662741,662771,861478,868199,868200,868201,1281504,1347728,1398927,1398928,1398931,2016596,2462087,3044932,3243621,3255682,3323673],["Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Simonis, Heidi","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Steinhardt, Heide","Simonna","Simonna","Milinyte, Simona","Milinyte, Simona","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, E.","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ekaterina","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Belikova, Ye.","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Bychkova, Elena","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Jevgenija","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Ye.","Simonova, Yevgeniya","Simonova, Yevgeniya","Simonova, Yevgeniya"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>movie ID<\/th>\n      <th>movie title<\/th>\n      <th>actress ID<\/th>\n      <th>movie ID<\/th>\n      <th>actress<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"columnDefs":[{"className":"dt-right","targets":[0,2,3]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</section><section id="left-join" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="left-join"><code>LEFT JOIN</code></h4>
<p>With a <code>LEFT JOIN</code>, there are 33 rows corresponding to the actresses in the seven top 2015 movies. Only <strong>The Revenant</strong> did not have any actresses whose <code>person_id</code> is greater than 3900000.</p>
<div class="cell" data-output.var="left_movie_actress" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> <span class="op">*</span> <span class="kw">FROM</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>(<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>       t.title</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # rating <span class="kw">is</span> votes</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes     </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="kw">LEFT</span> <span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>       a.movie_id,</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>       n.name</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">300</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="tbl-left-movie-actress" class="cell tbl-parent quarto-layout-panel anchored" data-tbl-cap="`LEFT JOIN` of movies and actresses." data-fig.asp="0.618">
<div class="panel-caption table-caption">
<p><strong>?(caption)</strong></p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6a6eb478b7e198ca6fef" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6a6eb478b7e198ca6fef">{"x":{"filter":"none","vertical":false,"data":[[3313672,3752999,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3915213,3915213,3915213,3915213,3915213,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4389619,4414139],["Avengers: Age of Ultron","Inside Out","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Jurassic World","Mad Max: Fury Road","Mad Max: Fury Road","Mad Max: Fury Road","Mad Max: Fury Road","Mad Max: Fury Road","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","Star Wars: Episode VII - The Force Awakens","The Martian","The Revenant"],[3916648,4122876,3938423,3938423,3950111,4079047,4079047,4084626,4084626,4084626,4099458,3958614,3990819,3990819,4081131,4081131,3907812,3907812,3907812,3938795,3970637,3970637,3970637,3970637,3970637,3970637,3970637,3970637,4073883,4073883,4094732,4098918,null],[3313672,3752999,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3787790,3915213,3915213,3915213,3915213,3915213,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4260166,4389619,null],["Smulders, Jacoba Francisca Maria","Kuzniar, Lennon Wynn","Norvell, Ingrid","Norvell, Ingrid","Sallaway, Seannon Jane","Washington, Kelly Lynn","Washington, Kelly Lynn","Weeks, Jency","Jenc","Little J","Curtis, Bonnie","Ness","Teron, Sharliz","Charlie","Lumb, Leanne","Watson, Leanne","Slade, Sandy","Sandy","Sandy Slade","Ryan, Karol Lesley","Stevens, Cat","Taber, Cat","Tabor, Cat","Cat","Stevens, Cat","Taber, Cat","Tabor, Cat","Cat","Walter, Dame Harriet","Walter, Harriet Mary","White, Kelsey Marie","Wiig, Kristen Carroll",null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>movie ID<\/th>\n      <th>movie title<\/th>\n      <th>actress ID<\/th>\n      <th>movie ID<\/th>\n      <th>actress<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":15,"columnDefs":[{"className":"dt-right","targets":[0,2,3]}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[10,15,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</section><section id="counting-repeat-actresses" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="counting-repeat-actresses">Counting repeat actresses</h4>
<p>We might, for example, want to know how many names / spellings of a name with a specific <code>person_id</code> (above 3900000) exist for each <code>person_id</code> in each of the top voted seven films of 2015.</p>
<div class="cell" data-output.var="num_repeat_names" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> acts.person_id, </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> num_repeat_names</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>       t.title</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # rating <span class="kw">is</span> votes</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>       a.movie_id,</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>       n.name</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> acts.person_id;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-num-repeat-names" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.11: For each <code>person_id</code> (&gt; 3900000) in the seven top voted 2015 films, how many names / spellings are associated with the <code>person_id</code>?</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">person_id</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">num_repeat_names</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3916648</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4122876</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3938423</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">3950111</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4079047</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4084626</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4099458</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">3958614</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3990819</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4081131</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3907812</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">3938795</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3970637</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: right;">4073883</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4094732</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">4098918</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section><section id="counting-number-of-actresses-per-film" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="counting-number-of-actresses-per-film">Counting number of actresses per film</h4>
<p>We might, for example, want to know how many actresses with a specific <code>person_id</code> (above 3900000) are in each of the top voted seven films of 2015.</p>
<div class="cell" data-output.var="num_actress" data-fig.asp="0.618">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode sql code-with-copy"><code class="sourceCode sql"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> movs.<span class="kw">id</span>, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       movs.title,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">COUNT</span>(<span class="op">*</span>) <span class="kw">AS</span> num_actress</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> (<span class="kw">SELECT</span> t.<span class="kw">id</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>       t.title</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="kw">FROM</span> title <span class="kw">AS</span> t</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> movie_info_idx <span class="kw">AS</span> idx <span class="kw">ON</span> idx.movie_id <span class="op">=</span> t.<span class="kw">id</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="kw">WHERE</span> t.production_year <span class="op">=</span> <span class="dv">2015</span>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> t.kind_id <span class="op">=</span> <span class="dv">1</span>               # movies <span class="kw">only</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info_type_id <span class="op">=</span> <span class="dv">100</span>      # rating <span class="kw">is</span> votes</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">AND</span> idx.info <span class="op">&gt;</span> <span class="dv">400000</span>) <span class="kw">AS</span> movs  # <span class="kw">at</span> <span class="fu">least</span> <span class="dv">400</span>,<span class="dv">000</span> votes</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="kw">JOIN</span> (<span class="kw">SELECT</span> a.person_id,</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>       a.movie_id,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>       n.name</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    <span class="kw">FROM</span> cast_info <span class="kw">AS</span> a</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">JOIN</span> aka_name <span class="kw">AS</span> n <span class="kw">ON</span> a.person_id <span class="op">=</span> n.person_id</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="kw">WHERE</span> a.role_id <span class="op">=</span> <span class="dv">2</span>             # acresses <span class="kw">only</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">AND</span> a.person_id <span class="op">&gt;</span> <span class="dv">3900000</span>) <span class="kw">AS</span> acts <span class="kw">ON</span> acts.movie_id <span class="op">=</span> movs.<span class="kw">id</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="kw">GROUP</span> <span class="kw">BY</span> movs.<span class="kw">id</span>;</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="tbl-num-actress" class="anchored">
<table class="table table-striped table-condensed table-sm small" data-quarto-postprocess="true">
<caption>Table&nbsp;4.12: Number of actresses (with person_id &gt; 3900000) in each of the seven top voted films of 2015. Recall that The Revenant had no actresses with person_id &gt; 3900000, so there are only six movies listed.</caption>
<thead><tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">id</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">title</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">num_actress</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">3313672</td>
<td style="text-align: left;">Avengers: Age of Ultron</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">3752999</td>
<td style="text-align: left;">Inside Out</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3787790</td>
<td style="text-align: left;">Jurassic World</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: right;">3915213</td>
<td style="text-align: left;">Mad Max: Fury Road</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4260166</td>
<td style="text-align: left;">Star Wars: Episode VII - The Force Awakens</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: right;">4389619</td>
<td style="text-align: left;">The Martian</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</section></section></section><section id="union" class="level2" data-number="4.3"><h2 data-number="4.3" class="anchored" data-anchor-id="union">
<span class="header-section-number">4.3</span> <code>UNION</code>
</h2>
<div class="cell" data-fig.asp="0.618">
<div class="cell-output-display">
<div id="fig-table-union" class="quarto-figure quarto-figure-center anchored">
<figure class="figure"><p><img src="04-sql-joins_files/figure-html/fig-table-union-1.png" class="img-fluid figure-img" style="width:120.0%" alt="Mini data tables describing how UNION binds rows and JOIN appends columns."></p>
<figcaption class="figure-caption">Figure&nbsp;4.3: UNION binds rows while JOIN appends columns, image credit: Jane Williams https://blog.devart.com/mysql-union-tutorial-html.html</figcaption></figure>
</div>
</div>
</div>
</section><section id="union-all" class="level2" data-number="4.4"><h2 data-number="4.4" class="anchored" data-anchor-id="union-all">
<span class="header-section-number">4.4</span> <code>UNION ALL</code>
</h2>
<section id="full-outer-join" class="level3" data-number="4.4.1"><h3 data-number="4.4.1" class="anchored" data-anchor-id="full-outer-join">
<span class="header-section-number">4.4.1</span> <code>FULL OUTER JOIN</code>
</h3>
<p><strong>MySQL</strong> doesn’t have a <code>FULL OUTER JOIN</code> (although other implementations of <strong>SQL</strong> do have full join functionality). However, we can mimick a full join using right and left joins with <code>UNION</code>.</p>
<p>It is always a good idea to terminate the <strong>SQL</strong> connection when you are done with it.</p>
<div class="cell" data-fig.asp="0.618">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">con_imdb</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./03-sql-verbs.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">SQL clauses</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./p3-build-db.html" class="pagination-link">
        <span class="nav-page-text">Building databases</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Data Science, the SQL by Jo Hardin.</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">Built with 💚 and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>