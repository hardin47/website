<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 4 Simple Linear Regression | Methods in Biostatistics</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="Though we’ve discussed the relationship between tests of means and simple linear regression, we will really consider simple linear regression in a much broader context (one where both the...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 4 Simple Linear Regression | Methods in Biostatistics">
<meta property="og:type" content="book">
<meta property="og:description" content="Though we’ve discussed the relationship between tests of means and simple linear regression, we will really consider simple linear regression in a much broader context (one where both the...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 4 Simple Linear Regression | Methods in Biostatistics">
<meta name="twitter:description" content="Though we’ve discussed the relationship between tests of means and simple linear regression, we will really consider simple linear regression in a much broader context (one where both the...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><link rel="shortcut icon" href="figs/favicon.ico">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Methods in Biostatistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="rfunc.html"><span class="header-section-number">1</span> R functions</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="t-tests-vs-slr.html"><span class="header-section-number">3</span> t-tests vs SLR</a></li>
<li><a class="active" href="SLR.html"><span class="header-section-number">4</span> Simple Linear Regression</a></li>
<li><a class="" href="analysis-of-categorical-data.html"><span class="header-section-number">5</span> Analysis of Categorical Data</a></li>
<li><a class="" href="logistic-regression.html"><span class="header-section-number">6</span> Logistic Regression</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">7</span> Survival Analysis</a></li>
<li><a class="" href="multiple-comparisons.html"><span class="header-section-number">8</span> Multiple Comparisons</a></li>
<li><a class="" href="poisson-regression.html"><span class="header-section-number">9</span> Poisson Regression</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="SLR" class="section level1" number="4">
<h1>
<span class="header-section-number">4</span> Simple Linear Regression<a class="anchor" aria-label="anchor" href="#SLR"><i class="fas fa-link"></i></a>
</h1>
<p>Though we’ve discussed the relationship between tests of means and simple linear regression, we will really consider simple linear regression in a much broader context (one where both the explanatory and response variables are quantitative).</p>
<p>The data below represents 10 different variables on health of a country measured on 143 countries. Data taken from <span class="citation">(<a href="references.html#ref-Lock5" role="doc-biblioref">Lock et al. 2016</a>)</span>, originally from the <a href="http://www.happyplanetindex.org/" target="_blank">Happy Planet Index Project</a>. Region of the world is coded as 1 = Latin America, 2 = Western nations, 3 = Middle East, 4 = Sub-Saharan Africa, 5 = South Asia, 6 = East Asia, 7 = former Communist countries. We are going to investigate happiness and life expectancy.</p>
<div id="inference-on-the-linear-model" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Inference on the Linear Model<a class="anchor" aria-label="anchor" href="#inference-on-the-linear-model"><i class="fas fa-link"></i></a>
</h2>
<p>In order to make an inferential claims on a linear regression model (e.g., p-values on hypotheses about coefficients, confidence intervals for coefficients, confidence interval for the line, prediction interval for the points, …), we have a set of technical conditions that provide the mathematical structure leading to the t-procedures (e.g., t-test). A course more focused on linear regression would spend time discussing how robust the model is to various deviations from the following technical conditions. For now, we will say that sometimes transformations of either the explanatory or response variables can be an effective way to mitigate deviations from the model.</p>
<p>As with any measurement of the data / population, regression models are built from either statistics (Roman letters to describe a sample) or parameters (Greek letters to describe a population). For linear regression, we have one additional differentiation due to whether the observed values <span class="math inline">\((y_i)\)</span> or the average values <span class="math inline">\((\hat{y}_i\)</span> or <span class="math inline">\(E[Y_i])\)</span> are being modeled.</p>
<p><span class="math display">\[\begin{eqnarray*}
E[Y_i|x_i] &amp;=&amp; \beta_0 + \beta_1 x_i \\
y_i &amp;=&amp; \beta_0 + \beta_1 x_i + \epsilon_i\\
&amp;&amp; \epsilon_i = y_i -  (\beta_0 + \beta_1 x_i)\\
\hat{y}_i &amp;=&amp; b_0 + b_1 x_i\\
y_i &amp;=&amp; b_0 + b_1 x_i + e_i\\
&amp;&amp; e_i = y_i - \hat{y}_i = y_i -  (b_0 + b_1 x_i)\\
\epsilon_i &amp;\sim&amp; N(0, \sigma^2)
\end{eqnarray*}\]</span></p>
<div id="technical-conditions" class="section level3" number="4.1.1">
<h3>
<span class="header-section-number">4.1.1</span> Technical Conditions<a class="anchor" aria-label="anchor" href="#technical-conditions"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>The average value for the response variable is a linear function of the explanatory variable.</li>
<li>The error terms follow a normal distribution around the linear model.</li>
<li>The error terms have a mean of zero.</li>
<li>The error terms have a constant variance of <span class="math inline">\(\sigma^2.\)</span>
</li>
<li>The error terms are independent (and identically distributed).</li>
<li><a href="http://www.rossmanchance.com/applets/2021/regshuffle/regshuffle.htm" target="_blank">Regression applet</a></li>
</ul>
<p>How do we tell whether the assumptions are met? We can’t always. But it’s good to look at plots: scatter plot, residual plot, histograms of residuals. We denote the residuals for this model as:</p>
<p><span class="math display">\[\begin{align}
r_i = \hat{e}_i = y_i - \hat{y}_i
\end{align}\]</span></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="figs/transfor.jpg" alt="Figs 3.13 and 3.15 taken from @kutner." width="95%"><p class="caption">
Figure 1.2: Figs 3.13 and 3.15 taken from <span class="citation">Kutner et al. (<a href="references.html#ref-kutner" role="doc-biblioref">2004</a>)</span>.
</p>
</div>
<p><strong>important note!!</strong> The idea behind transformations is to make the model as appropriate as possible for the data at hand. We want to find the correct <strong>linear</strong> model; we want our assumptions to hold. We are not trying to find the most <em>significant</em> model or big <span class="math inline">\(R^2.\)</span></p>
<p>See section 2.9 in <span class="citation">Kuiper and Sklar (<a href="references.html#ref-KuiperSklar" role="doc-biblioref">2013</a>)</span>. No normal probability plots (qq-plots); use histograms or boxplots to assess the symmetry and normality of the residuals.</p>
</div>
</div>
<div id="fitting-the-regression-line" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Fitting the regression line<a class="anchor" aria-label="anchor" href="#fitting-the-regression-line"><i class="fas fa-link"></i></a>
</h2>
<p>How do we fit a regression line? Find <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize the sum of squared distance of the points to the line (called ordinary least squares):</p>
<p><span class="math display">\[\begin{align}
\min \sum (y_i - \hat{y}_i)^2 &amp;= \min RSS \mbox{ residual sum of squares}\\
RSS &amp;= \sum (y_i - b_0 - b_1 x_i)^2\\
\frac{\partial RSS}{\partial b_0} &amp;= 0\\
\frac{\partial RSS}{\partial b_1} &amp;= 0\\
b_0 &amp;= \overline{y} - b_1 \overline{x}\\
b_1 &amp;= r \frac{s_y}{s_x}\\
&amp;= \frac{\sum(x_i - \overline{X})(y_i - \overline{y})}{\sum(x_i - \overline{x})^2}
\end{align}\]</span></p>
<ul>
<li>Is that the only way to find values for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>? (absolute distances, maximum likelihood,…)</li>
<li>Resistance to outliers?</li>
<li>What is <span class="math inline">\(\hat{y}\)</span> at <span class="math inline">\(\overline{x}\)</span>?</li>
</ul>
<p><span class="math display">\[\begin{align}
\hat{y} &amp;= b_0 + b_1 \overline{x}\\
&amp;= \overline{y} - b_1 \overline{x} + b_1 \overline{x}\\
&amp;= \overline{y}
\end{align}\]</span></p>
<p>The regression line will always pass through the point <span class="math inline">\((\overline{x}, \overline{y}).\)</span></p>
<div class="definition">
<p><span id="def:unlabeled-div-3" class="definition"><strong>Definition 4.1  </strong></span>An estimate is <em>unbiased</em> if, over many repeated samples drawn from the population, the average value of the estimates based on the different samples would equal the population value of the parameter being estimated. That is, a statistic is unbiased if the mean of its sampling distribution is the population parameter.</p>
</div>
</div>
<div id="correlation" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Correlation<a class="anchor" aria-label="anchor" href="#correlation"><i class="fas fa-link"></i></a>
</h2>
<p>Consider a scatterplot, you’ll have variability in both directions: <span class="math inline">\((x_i - \overline{x}) \ \ \&amp; \ \ (y_i - \overline{y}).\)</span></p>
<p><span class="math display">\[\begin{align}
\mbox{sample covariance}&amp;\\
cov(x,y) &amp;= \frac{1}{n-1}\sum (x_i - \overline{x}) (y_i - \overline{y})\\
\mbox{sample correlation}&amp;\\
r(x,y) &amp;= \frac{cov(x,y)}{s_x s_y}\\
&amp;= \frac{\frac{1}{n-1} \sum (x_i - \overline{x}) (y_i - \overline{y})}{\sqrt{\frac{\sum(x_i - \overline{x})^2}{n-1} \frac{\sum(y_i - \overline{y})^2}{n-1}}}\\
\mbox{pop cov} &amp;= \sigma_{xy}\\
\mbox{pop cor} &amp;= \rho = \frac{\sigma_{xy}}{\sigma_x \sigma_y}\\
\end{align}\]</span></p>
<ul>
<li>
<span class="math inline">\(-1 \leq r \leq 1 \ \ \ \ \ \&amp; \ \ \ -1 \leq \rho \leq 1.\)</span><br>
</li>
<li>No Spearman’s rank correlation or Kendall’s <span class="math inline">\(\tau.\)</span><br>
</li>
<li>
<span class="math inline">\(b_1 = r \frac{s_y}{s_x}\)</span>
<ul>
<li>if <span class="math inline">\(r=0, b_1=0\)</span><br>
</li>
<li>if <span class="math inline">\(r=1, b_1 &gt; 0\)</span> but can be anything!<br>
</li>
<li>
<span class="math inline">\(r &lt; 0 \leftrightarrow b_1 &lt; 0, r &gt; 0 \leftrightarrow b_1 &gt; 0\)</span><br>
</li>
</ul>
</li>
<li>Recall that <span class="math inline">\(R^2\)</span> is the proportion of variability explained by the line.</li>
</ul>
</div>
<div id="errors-residuals" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Errors / Residuals<a class="anchor" aria-label="anchor" href="#errors-residuals"><i class="fas fa-link"></i></a>
</h2>
<p>Recall, part of the technical conditions required that <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2).\)</span> How do we estimate <span class="math inline">\(\sigma^2?\)</span></p>
<p><span class="math display">\[\begin{align}
RSS &amp;= \sum (y_i - \hat{y}_i)^2 \ \ \ \mbox{ residual sum of squares}\\
MSS &amp;= \sum (\hat{y}_i - \overline{y})^2 \ \ \ \mbox{ model sum of squares}\\
TSS &amp;= \sum (y_i - \overline{y})^2 \ \ \ \mbox{ total sum of squares}\\
s_{y|x}^2 &amp;= \hat{\sigma^2} = \frac{1}{n-2} RSS\\
s_x^2 &amp;= \frac{1}{n-1} \sum (x_i - \overline{x})^2\\
s_y^2 &amp;= \frac{1}{n-1} \sum (y_i - \overline{y})^2\\
var(\epsilon) &amp;= s_{y|x}^2 = \frac{RSS}{n-2} = \frac{\sum(y_i - \hat{y}_i)^2}{n-2} = SE(\epsilon)\\
var(b_1) &amp;= \frac{s_{y|x}^2}{(n-1) s_x^2}\\
SE(b_1) &amp;= \frac{s_{y|x}}{\sqrt{(n-1)} s_x}\\
&amp;= \frac{\hat{\sigma}}{\sqrt{\sum(x_i - \overline{x})^2}} = \frac{\sqrt{\sum(y_i - \hat{y}_i)^2/(n-2)}}{\sqrt{\sum(x_i - \overline{x})^2}}\\
\end{align}\]</span></p>
<ul>
<li>
<span class="math inline">\(SE(b_1) \downarrow\)</span> as <span class="math inline">\(\sigma \downarrow\)</span>
</li>
<li>
<span class="math inline">\(SE(b_1) \downarrow\)</span> as <span class="math inline">\(n \uparrow\)</span>
</li>
<li>
<span class="math inline">\(SE(b_1) \downarrow\)</span> as <span class="math inline">\(s_x \uparrow\)</span>
</li>
<li>WHY?</li>
<li>What do we mean by <span class="math inline">\(SE(b_1)\)</span>?</li>
</ul>
<p>As we saw above, the correlation and the slope estimates are intimately related. They are also both related to the <em>coefficient of determination</em>.
<span class="math display">\[\begin{align}
R^2 = r^2 = \frac{MSS}{TSS}
\end{align}\]</span></p>
<p><span class="math inline">\(R^2\)</span> is the proportion of total variability explained by the regression line (the linear relationship between the explanatory and response variables).</p>
<ul>
<li>If <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are not at all correlated, <span class="math inline">\(\hat{y}_i \approx \overline{y},\)</span> MSS = 0, <span class="math inline">\(R^2=0.\)</span>
</li>
<li>If <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> are perfectly correlated, <span class="math inline">\(\hat{y}_i = y_i,\)</span> MSS=TSS, <span class="math inline">\(R^2 = 1.\)</span>
</li>
</ul>
<div id="testing-beta_1" class="section level3" number="4.4.1">
<h3>
<span class="header-section-number">4.4.1</span> Testing <span class="math inline">\(\beta_1\)</span><a class="anchor" aria-label="anchor" href="#testing-beta_1"><i class="fas fa-link"></i></a>
</h3>
<p>If the technical conditions hold, the mathematics describing the sampling distribution of <span class="math inline">\(b_1\)</span> are well defined. That is:</p>
<p>If <span class="math inline">\(H_0: \beta=0\)</span> is true, then
<span class="math display">\[\begin{align}
\frac{b_1 - 0}{SE(b_1)} \sim t_{n-2}
\end{align}\]</span>
Note that the degrees of freedom are now <span class="math inline">\(n-2\)</span> because we are estimating two parameters <span class="math inline">\((\beta_0\)</span> and <span class="math inline">\(\beta_1).\)</span> We can also find a <span class="math inline">\((1-\alpha)100\%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span>:
<span class="math display">\[\begin{align}
b_1 \pm t_{\alpha/2, n-2} SE(b_1)
\end{align}\]</span></p>
</div>
</div>
<div id="intervals" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Intervals<a class="anchor" aria-label="anchor" href="#intervals"><i class="fas fa-link"></i></a>
</h2>
<p>As with anything that has some type of standard error, we can create intervals that give us some confidence in the statements we are making.</p>
<div id="confidence-intervals-1" class="section level3" number="4.5.1">
<h3>
<span class="header-section-number">4.5.1</span> Confidence Intervals<a class="anchor" aria-label="anchor" href="#confidence-intervals-1"><i class="fas fa-link"></i></a>
</h3>
<p>In general, confidence intervals are of the form:</p>
<pre><code>point estimate +/- multiplier * SE(point estimate)</code></pre>
</div>
<div id="slope" class="section level3" number="4.5.2">
<h3>
<span class="header-section-number">4.5.2</span> Slope<a class="anchor" aria-label="anchor" href="#slope"><i class="fas fa-link"></i></a>
</h3>
<p>We can create a CI for the slope parameter, <span class="math inline">\(\beta_1\)</span>:
<span class="math display">\[\begin{align}
b_1 &amp;\pm t_{\alpha/2,n-2} SE(b_1)\\
b_1 &amp;\pm t_{\alpha/2, n-2} \frac{s_{y|x}}{\sqrt{(n-1)}s_x}\\
6.693 &amp;\pm t_{.025, 141} 0.375\\
t_{.025,141} &amp;= qt(0.025, 141) = -1.977\\
\mbox{CI: } &amp; (5.95 \mbox{ years/unit of happy}, 7.43 \mbox{ years/unit of happy})
\end{align}\]</span>
How can we interpret the CI? Does it make sense to talk about a unit of happiness?</p>
</div>
<div id="mean-response" class="section level3" number="4.5.3">
<h3>
<span class="header-section-number">4.5.3</span> Mean Response<a class="anchor" aria-label="anchor" href="#mean-response"><i class="fas fa-link"></i></a>
</h3>
<p>We can also create a CI for the mean response, <span class="math inline">\(E[Y|x^*] = \beta_0 + \beta_1 x^*.\)</span> Note that the standard error of the point estimate <span class="math inline">\((\hat{y}=b_0 + b_1 x^*)\)</span> now depends on the variability associated with two things (<span class="math inline">\(b_0, b_1).\)</span>
<span class="math display">\[\begin{align}
SE(\hat{y(x^*)}) &amp;= \sqrt{ \frac{s^2_{y|x}}{n} + (x^* - \overline{x})^2 SE(b_1)^2}\\
SE(\hat{y}(\overline{x})) &amp;= s_{y|x}/\sqrt{n}\\
SE(\hat{y}(x)) &amp;\geq s_{y|x}/\sqrt{n} \ \ \ \forall x
\end{align}\]</span>
How would you interpret the associated interval?</p>
</div>
<div id="prediction-of-an-individual-response" class="section level3" number="4.5.4">
<h3>
<span class="header-section-number">4.5.4</span> Prediction of an Individual Response<a class="anchor" aria-label="anchor" href="#prediction-of-an-individual-response"><i class="fas fa-link"></i></a>
</h3>
<p>As should be obvious, predicting an individual is more variable than predicting a mean.</p>
<p><span class="math display">\[\begin{align}
SE(y(x^*)) &amp;= \sqrt{ \frac{s^2_{y|x}}{n} + (x^* - \overline{x})^2 SE(b_1)^2 + s^2_{y|x}}\\
SE(y(x^*)) &amp;= \sqrt{ SE(\hat{y}(x^*))^2 + s^2_{y|x}}\\
\end{align}\]</span>
How would you interpret the associated interval?</p>
</div>
</div>
<div id="infl" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Influential Points<a class="anchor" aria-label="anchor" href="#infl"><i class="fas fa-link"></i></a>
</h2>
<p><strong>We are skipping Section <a href="SLR.html#infl">4.6</a>; you are not responsible for it.</strong></p>
<div class="theorem">
<p><span id="thm:unlabeled-div-4" class="theorem"><strong>Theorem 4.1  </strong></span><em>High leverage points</em> are x-outliers with the potential to exert undue influence on regression coefficient estimates. <em>Influential points</em> are points that have exerted undue influence on the regression coefficient estimates.</p>
</div>
<p>Note: typically we think of more data as better; more values will tend to decrease the sampling variability of our statistic. But if I give you a lot more data and put it all at <span class="math inline">\(\overline{x},\)</span> <span class="math inline">\(SE(b_1)\)</span> stays exactly the same. Why??</p>
<p>Recall
<span class="math display">\[\begin{align}
y_{i} &amp;= \beta_0 + \beta_1 x_i \ \ \ \epsilon_i \sim N(0,\sigma^2)\\
e_i &amp;= y_i - \hat{y}_i
\end{align}\]</span></p>
<p>We plot <span class="math inline">\(e_i\)</span> versus <span class="math inline">\(\hat{y}_i.\)</span> (Why? Typically, we want the <span class="math inline">\(e_i\)</span> to be constant at each value of <span class="math inline">\(x_i.\)</span> Note that <span class="math inline">\(\hat{y}_i\)</span> is a simple linear transformation of <span class="math inline">\(x_i,\)</span> so the plot is identical.) We want to see if the distributions of the residuals is different across the fitted line (we look for patterns).</p>
<p><strong>Not all residuals have an equal effect on the regression line!!</strong></p>
<div id="leverage" class="section level3" number="4.6.1">
<h3>
<span class="header-section-number">4.6.1</span> leverage<a class="anchor" aria-label="anchor" href="#leverage"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[\begin{align}
h_i = \frac{1}{n} +\frac{(x_i - \overline{x})^2}{\sum_{j=1}^n (x_j - \overline{x})^2}\\
\frac{1}{n} \leq h_i \leq 1\\
\end{align}\]</span>
Leverage represents the effect of point <span class="math inline">\(x_i\)</span> on the line. We need large leverage for a particular value to have a large effect.</p>
<p>Note:
<span class="math display">\[\begin{align}
SE(\hat{y}(x_i)) &amp;= s_{y|x} \sqrt{h_i}\\
SE(y(x_i)) &amp;= s_{y|x} \sqrt{(h_i + 1)}\\
SE(e_i) &amp;= s_{y|x} \sqrt{(1-h_i)}\\
\hat{y}(x^*) &amp;\pm t_{n-2, .025} (s_{y|x} \sqrt{h(x^*)+1})\\
\end{align}\]</span>
is a 95% prediction interval at <span class="math inline">\(x^*.\)</span> High leverage reduces the variability because the line gets pulled toward the point.</p>
</div>
<div id="standardized-residuals" class="section level3" number="4.6.2">
<h3>
<span class="header-section-number">4.6.2</span> standardized residuals<a class="anchor" aria-label="anchor" href="#standardized-residuals"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[\begin{align}
\frac{e_i}{s_{y|x} \sqrt{1-h_i}} \sim t_{n-2}\\
\end{align}\]</span></p>
</div>
<div id="studentized-residuals" class="section level3" number="4.6.3">
<h3>
<span class="header-section-number">4.6.3</span> studentized residuals<a class="anchor" aria-label="anchor" href="#studentized-residuals"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[\begin{align}
\frac{e_i}{s_{y|x, (i)} \sqrt{1-h_i}} &amp;\sim t_{n-3}\\
s_{y|x, (i)} &amp;= \frac{1}{n-3} \sum_{j \ne i} (y_j - \hat{y}_{j(i)})^2
\end{align}\]</span></p>
<p>Where do we predict 90% of residuals? <span class="math inline">\(\pm t_{n-2,3 , .05}.\)</span> Approximately <span class="math inline">\(\pm 2.\)</span></p>
</div>
<div id="dfbetas" class="section level3" number="4.6.4">
<h3>
<span class="header-section-number">4.6.4</span> DFBETAs<a class="anchor" aria-label="anchor" href="#dfbetas"><i class="fas fa-link"></i></a>
</h3>
<p>DFBETAs represent the change in the parameter estimate due to one observation.</p>
<p><span class="math display">\[\begin{align}
DFBETAS_i &amp;= \frac{b_1 - b_{1(i)}}{\frac{s_{y|x, (i)}}{\sqrt{(n-1)} s_x}}\\
\end{align}\]</span></p>
</div>
</div>
<div id="r-example-slr-happy-planet" class="section level2" number="4.7">
<h2>
<span class="header-section-number">4.7</span> R Example (SLR): Happy Planet<a class="anchor" aria-label="anchor" href="#r-example-slr-happy-planet"><i class="fas fa-link"></i></a>
</h2>
<p>The data below represents 10 different variables on health of a country measured on 143 countries. Data taken from <span class="citation">(<a href="references.html#ref-Lock5" role="doc-biblioref">Lock et al. 2016</a>)</span>, originally from the Happy Planet Index Project [<a href="http://www.happyplanetindex.org/" class="uri">http://www.happyplanetindex.org/</a>]. Region of the world is coded as 1 = Latin America, 2 = Western nations, 3 = Middle East, 4 = Sub-Saharan Africa, 5 = South Asia, 6 = East Asia, 7 = former Communist countries. We are going to investigate happiness and life expectancy.</p>
<div id="reading-the-data-into-r" class="section level3" number="4.7.1">
<h3>
<span class="header-section-number">4.7.1</span> Reading the data into R<a class="anchor" aria-label="anchor" href="#reading-the-data-into-r"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">happy</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"./data/happyPlanet.txt"</span>, delim<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span></span>
<span><span class="fu">glimpse</span><span class="op">(</span><span class="va">happy</span><span class="op">)</span>  </span>
<span><span class="co">#&gt; Rows: 143</span></span>
<span><span class="co">#&gt; Columns: 11</span></span>
<span><span class="co">#&gt; $ Country        &lt;chr&gt; "Albania", "Algeria", "Angola", "Argentina", "Armenia",…</span></span>
<span><span class="co">#&gt; $ Region         &lt;dbl&gt; 7, 3, 4, 1, 7, 2, 2, 7, 5, 7, 2, 1, 4, 5, 1, 7, 4, 1, 7…</span></span>
<span><span class="co">#&gt; $ Happiness      &lt;dbl&gt; 5.5, 5.6, 4.3, 7.1, 5.0, 7.9, 7.8, 5.3, 5.3, 5.8, 7.6, …</span></span>
<span><span class="co">#&gt; $ LifeExpectancy &lt;dbl&gt; 76.2, 71.7, 41.7, 74.8, 71.7, 80.9, 79.4, 67.1, 63.1, 6…</span></span>
<span><span class="co">#&gt; $ Footprint      &lt;dbl&gt; 2.2, 1.7, 0.9, 2.5, 1.4, 7.8, 5.0, 2.2, 0.6, 3.9, 5.1, …</span></span>
<span><span class="co">#&gt; $ HLY            &lt;dbl&gt; 41.7, 40.1, 17.8, 53.4, 36.1, 63.7, 61.9, 35.4, 33.1, 4…</span></span>
<span><span class="co">#&gt; $ HPI            &lt;dbl&gt; 47.9, 51.2, 26.8, 59.0, 48.3, 36.6, 47.7, 41.2, 54.1, 3…</span></span>
<span><span class="co">#&gt; $ HPIRank        &lt;dbl&gt; 54, 40, 130, 15, 48, 102, 57, 85, 31, 104, 64, 27, 134,…</span></span>
<span><span class="co">#&gt; $ GDPperCapita   &lt;dbl&gt; 5316, 7062, 2335, 14280, 4945, 31794, 33700, 5016, 2053…</span></span>
<span><span class="co">#&gt; $ HDI            &lt;dbl&gt; 0.801, 0.733, 0.446, 0.869, 0.775, 0.962, 0.948, 0.746,…</span></span>
<span><span class="co">#&gt; $ Population     &lt;dbl&gt; 3.15, 32.85, 16.10, 38.75, 3.02, 20.40, 8.23, 8.39, 153…</span></span></code></pre></div>
</div>
<div id="running-the-linear-model-lm" class="section level3" number="4.7.2">
<h3>
<span class="header-section-number">4.7.2</span> Running the linear model (lm)<a class="anchor" aria-label="anchor" href="#running-the-linear-model-lm"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">happy.lm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">LifeExpectancy</span> <span class="op">~</span> <span class="va">Happiness</span>, data<span class="op">=</span><span class="va">happy</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">happy.lm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 5</span></span>
<span><span class="co">#&gt;   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)    28.2      2.28       12.4 2.76e-24</span></span>
<span><span class="co">#&gt; 2 Happiness       6.69     0.375      17.8 5.78e-38</span></span></code></pre></div>
</div>
<div id="ouptut" class="section level3" number="4.7.3">
<h3>
<span class="header-section-number">4.7.3</span> Ouptut<a class="anchor" aria-label="anchor" href="#ouptut"><i class="fas fa-link"></i></a>
</h3>
<p>Some analyses will need the residuals, fitted values, or coefficients individually.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">happy.lm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 143 × 8</span></span>
<span><span class="co">#&gt;   LifeExpectancy Happiness .fitted  .resid    .hat .sigma   .cooksd .std.resid</span></span>
<span><span class="co">#&gt;            &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1           76.2       5.5    65.0  11.2   0.00765   6.09 0.0128        1.83  </span></span>
<span><span class="co">#&gt; 2           71.7       5.6    65.7   6.00  0.00737   6.14 0.00357       0.980 </span></span>
<span><span class="co">#&gt; 3           41.7       4.3    57.0 -15.3   0.0168    6.02 0.0539       -2.51  </span></span>
<span><span class="co">#&gt; 4           74.8       7.1    75.7  -0.944 0.0122    6.16 0.000148     -0.155 </span></span>
<span><span class="co">#&gt; 5           71.7       5      61.7  10.0   0.0101    6.10 0.0138        1.64  </span></span>
<span><span class="co">#&gt; 6           80.9       7.9    81.1  -0.198 0.0216    6.16 0.0000118    -0.0326</span></span>
<span><span class="co">#&gt; # … with 137 more rows</span></span></code></pre></div>
<p>We can plot the main relationship, or we can plot the residuals (to check that technical conditions hold):</p>
<pre><code>happy %&gt;%
         ggplot(aes(x=Happiness, y=LifeExpectancy)) + 
         geom_point() + 
         geom_smooth(method="lm", se=FALSE) 

happy.lm %&gt;% 
         augment() %&gt;% 
         ggplot(aes(x = .fitted, y = .resid)) + 
         geom_point() + 
         geom_hline(yintercept=0)</code></pre>
<div class="inline-figure"><img src="03-SLR_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;"></div>
<p>Intervals of interest: mean response, individual response, and parameter(s).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span><span class="op">(</span><span class="va">happy.lm</span>, newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Happiness<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>,interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"conf"</span><span class="op">)</span>, level<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;    fit  lwr  upr</span></span>
<span><span class="co">#&gt; 1 55.0 53.2 56.7</span></span>
<span><span class="co">#&gt; 2 75.1 73.8 76.4</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.lm.html">predict.lm</a></span><span class="op">(</span><span class="va">happy.lm</span>, newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>Happiness<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>,<span class="fl">7</span><span class="op">)</span><span class="op">)</span>,interval<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"pred"</span><span class="op">)</span>, level<span class="op">=</span><span class="fl">.95</span><span class="op">)</span></span>
<span><span class="co">#&gt;    fit  lwr  upr</span></span>
<span><span class="co">#&gt; 1 55.0 42.7 67.3</span></span>
<span><span class="co">#&gt; 2 75.1 62.9 87.3</span></span>
<span></span>
<span><span class="va">happy.lm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">tidy</span><span class="op">(</span>conf.int <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 7</span></span>
<span><span class="co">#&gt;   term        estimate std.error statistic  p.value conf.low conf.high</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 (Intercept)    28.2      2.28       12.4 2.76e-24    23.7      32.7 </span></span>
<span><span class="co">#&gt; 2 Happiness       6.69     0.375      17.8 5.78e-38     5.95      7.43</span></span></code></pre></div>
<div id="residuals-in-r" class="section level4" number="4.7.3.1">
<h4>
<span class="header-section-number">4.7.3.1</span> Residuals in R<a class="anchor" aria-label="anchor" href="#residuals-in-r"><i class="fas fa-link"></i></a>
</h4>
<p>We skipped the residuals section, so you are not responsible for finding residuals in R, but the R code is here for completion in case you are interested:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">happy.lm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 143 × 8</span></span>
<span><span class="co">#&gt;   LifeExpectancy Happiness .fitted  .resid    .hat .sigma   .cooksd .std.resid</span></span>
<span><span class="co">#&gt;            &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1           76.2       5.5    65.0  11.2   0.00765   6.09 0.0128        1.83  </span></span>
<span><span class="co">#&gt; 2           71.7       5.6    65.7   6.00  0.00737   6.14 0.00357       0.980 </span></span>
<span><span class="co">#&gt; 3           41.7       4.3    57.0 -15.3   0.0168    6.02 0.0539       -2.51  </span></span>
<span><span class="co">#&gt; 4           74.8       7.1    75.7  -0.944 0.0122    6.16 0.000148     -0.155 </span></span>
<span><span class="co">#&gt; 5           71.7       5      61.7  10.0   0.0101    6.10 0.0138        1.64  </span></span>
<span><span class="co">#&gt; 6           80.9       7.9    81.1  -0.198 0.0216    6.16 0.0000118    -0.0326</span></span>
<span><span class="co">#&gt; # … with 137 more rows</span></span></code></pre></div>

</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="t-tests-vs-slr.html"><span class="header-section-number">3</span> t-tests vs SLR</a></div>
<div class="next"><a href="analysis-of-categorical-data.html"><span class="header-section-number">5</span> Analysis of Categorical Data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#SLR"><span class="header-section-number">4</span> Simple Linear Regression</a></li>
<li>
<a class="nav-link" href="#inference-on-the-linear-model"><span class="header-section-number">4.1</span> Inference on the Linear Model</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#technical-conditions"><span class="header-section-number">4.1.1</span> Technical Conditions</a></li></ul>
</li>
<li><a class="nav-link" href="#fitting-the-regression-line"><span class="header-section-number">4.2</span> Fitting the regression line</a></li>
<li><a class="nav-link" href="#correlation"><span class="header-section-number">4.3</span> Correlation</a></li>
<li>
<a class="nav-link" href="#errors-residuals"><span class="header-section-number">4.4</span> Errors / Residuals</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#testing-beta_1"><span class="header-section-number">4.4.1</span> Testing \(\beta_1\)</a></li></ul>
</li>
<li>
<a class="nav-link" href="#intervals"><span class="header-section-number">4.5</span> Intervals</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#confidence-intervals-1"><span class="header-section-number">4.5.1</span> Confidence Intervals</a></li>
<li><a class="nav-link" href="#slope"><span class="header-section-number">4.5.2</span> Slope</a></li>
<li><a class="nav-link" href="#mean-response"><span class="header-section-number">4.5.3</span> Mean Response</a></li>
<li><a class="nav-link" href="#prediction-of-an-individual-response"><span class="header-section-number">4.5.4</span> Prediction of an Individual Response</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#infl"><span class="header-section-number">4.6</span> Influential Points</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#leverage"><span class="header-section-number">4.6.1</span> leverage</a></li>
<li><a class="nav-link" href="#standardized-residuals"><span class="header-section-number">4.6.2</span> standardized residuals</a></li>
<li><a class="nav-link" href="#studentized-residuals"><span class="header-section-number">4.6.3</span> studentized residuals</a></li>
<li><a class="nav-link" href="#dfbetas"><span class="header-section-number">4.6.4</span> DFBETAs</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#r-example-slr-happy-planet"><span class="header-section-number">4.7</span> R Example (SLR): Happy Planet</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#reading-the-data-into-r"><span class="header-section-number">4.7.1</span> Reading the data into R</a></li>
<li><a class="nav-link" href="#running-the-linear-model-lm"><span class="header-section-number">4.7.2</span> Running the linear model (lm)</a></li>
<li><a class="nav-link" href="#ouptut"><span class="header-section-number">4.7.3</span> Ouptut</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/03-SLR.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/03-SLR.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Methods in Biostatistics</strong>" was written by Jo Hardin. It was last built on 2023-02-01.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
