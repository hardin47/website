<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 Logistic Regression | Methods in Biostatistics</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="5.1 Motivation for Logistic Regression During investigation of the US space shuttle Challenger disaster, it was learned that project managers had judged the probability of mission failure to be...">
<meta name="generator" content="bookdown 0.26 with bs4_book()">
<meta property="og:title" content="Chapter 5 Logistic Regression | Methods in Biostatistics">
<meta property="og:type" content="book">
<meta property="og:description" content="5.1 Motivation for Logistic Regression During investigation of the US space shuttle Challenger disaster, it was learned that project managers had judged the probability of mission failure to be...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 Logistic Regression | Methods in Biostatistics">
<meta name="twitter:description" content="5.1 Motivation for Logistic Regression During investigation of the US space shuttle Challenger disaster, it was learned that project managers had judged the probability of mission failure to be...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/bsTable-3.3.7/bootstrapTable.min.css" rel="stylesheet">
<script src="libs/bsTable-3.3.7/bootstrapTable.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Methods in Biostatistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="t-tests-vs-slr.html"><span class="header-section-number">2</span> t-tests vs SLR</a></li>
<li><a class="" href="SLR.html"><span class="header-section-number">3</span> Simple Linear Regression</a></li>
<li><a class="" href="analysis-of-categorical-data.html"><span class="header-section-number">4</span> Analysis of Categorical Data</a></li>
<li><a class="active" href="logistic-regression.html"><span class="header-section-number">5</span> Logistic Regression</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="logistic-regression" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> Logistic Regression<a class="anchor" aria-label="anchor" href="#logistic-regression"><i class="fas fa-link"></i></a>
</h1>
<div id="logmodel" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Motivation for Logistic Regression<a class="anchor" aria-label="anchor" href="#logmodel"><i class="fas fa-link"></i></a>
</h2>
<p>During investigation of the US space shuttle <em>Challenger</em> disaster, it was learned that project managers had judged the probability of mission failure to be 0.00001, whereas engineers working on the project had estimated failure probability at 0.005. The difference between these two probabilities, 0.00499 was discounted as being too small to worry about. Is a different picture provided by considering odds? How is it interpreted?</p>
<p>The logistic regression model is a <em>generalized</em> linear model. That is, a linear model as a function of the expected value of the response variable. We can now model binary response variables.
<span class="math display">\[\begin{align}
GLM: g(E[Y | X]) = \beta_0 + \beta_1 X
\end{align}\]</span>
where <span class="math inline">\(g(\cdot)\)</span> is the link function. For logistic regression, we use the logit link function:
<span class="math display">\[\begin{align}
\mbox{logit} (p) = \ln \bigg( \frac{p}{1-p} \bigg)
\end{align}\]</span></p>
<div id="ex:burnexamp" class="section level4" number="5.1.0.1">
<h4>
<span class="header-section-number">5.1.0.1</span> Surviving Third-degree Burns<a class="anchor" aria-label="anchor" href="#ex:burnexamp"><i class="fas fa-link"></i></a>
</h4>
<p>These data refer to 435 adults who were treated for third-degree burns by the University of Southern California General Hospital Burn Center. The patients were grouped according to the area of third-degree burns on the body (measured in square cm). In the table below are recorded, for each midpoint of the groupings <code>log(area +1)</code>, the number of patients in the corresponding group who survived, and the number who died from the burns. <span class="citation">(<a href="references.html#ref-burn" role="doc-biblioref">Fan, Heckman, and Wand 1995</a>)</span></p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="center">log(area+1) midpoint</th>
<th align="center">survived</th>
<th align="center">died</th>
<th align="center">prop surv</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1.35</td>
<td align="center">13</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">1.60</td>
<td align="center">19</td>
<td align="center">0</td>
<td align="center">1</td>
</tr>
<tr class="odd">
<td align="center">1.75</td>
<td align="center">67</td>
<td align="center">2</td>
<td align="center">0.971</td>
</tr>
<tr class="even">
<td align="center">1.85</td>
<td align="center">45</td>
<td align="center">5</td>
<td align="center">0.900</td>
</tr>
<tr class="odd">
<td align="center">1.95</td>
<td align="center">71</td>
<td align="center">8</td>
<td align="center">0.899</td>
</tr>
<tr class="even">
<td align="center">2.05</td>
<td align="center">50</td>
<td align="center">20</td>
<td align="center">0.714</td>
</tr>
<tr class="odd">
<td align="center">2.15</td>
<td align="center">35</td>
<td align="center">31</td>
<td align="center">0.530</td>
</tr>
<tr class="even">
<td align="center">2.25</td>
<td align="center">7</td>
<td align="center">49</td>
<td align="center">0.125</td>
</tr>
<tr class="odd">
<td align="center">2.35</td>
<td align="center">1</td>
<td align="center">12</td>
<td align="center">0.077</td>
</tr>
</tbody>
</table></div>
<div class="inline-figure"><img src="05-log_files/figure-html/unnamed-chunk-2-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>We can see that the logit transformation linearizes the relationship.</p>
<p>A first idea might be to model the relationship between the probability of success (that the patient survives) and the explanatory variable <code>log(area +1)</code> as a simple linear regression model. However, the scatterplot of the proportions of patients surviving a third-degree burn against the explanatory variable shows a distinct curved relationship between the two variables, rather than a linear one. It seems that a transformation of the data is in place.</p>
<p>The functional form relating x and the probability of success looks like it could be an <code>S</code> shape. But we’d have to do some work to figure out what the form of that <code>S</code> looks like. Below I’ve given some different relationships between x and the probability of success using <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> values that are yet to be defined. Regardless, we can see that by tuning the functional relationship of the <code>S</code> curve, we can get a good fit to the data.</p>
<div class="inline-figure"><img src="05-log_files/figure-html/unnamed-chunk-3-1.png" width="95%" style="display: block; margin: auto;"></div>
<p>S-curves ( <code>y = exp(linear) / (1+exp(linear))</code> ) for a variety of different parameter settings. Note that the x-axis is some continuous variable <code>x</code> while the y-axis is the probability of success at that value of <code>x</code>. More on this as we move through this model.</p>
<p>Why doesn’t linear regression work here?</p>
<ul>
<li>The response isn’t normal<br>
</li>
<li>The response isn’t linear (until we transform)<br>
</li>
<li>The predicted values go outside the bounds of (0,1)<br>
</li>
<li>Note: it <em>does</em> work to think about values inside (0,1) as probabilities</li>
</ul>
</div>
<div id="the-logistic-model" class="section level3" number="5.1.1">
<h3>
<span class="header-section-number">5.1.1</span> The logistic model<a class="anchor" aria-label="anchor" href="#the-logistic-model"><i class="fas fa-link"></i></a>
</h3>
<p>Instead of trying to model the using <em>linear regression</em>, let’s say that we consider the relationship between the variable <span class="math inline">\(x\)</span> and the probability of success to be given by the following generalized linear model. (The logistic model is just one model, there isn’t anything magical about it. We do have good reasons for how we defined it, but that doesn’t mean there aren’t other good ways to model the relationship.)</p>
<p><span class="math display">\[\begin{align}
p(x) = \frac{e^{\beta_0 + \beta_1 x}}{1+e^{\beta_0 + \beta_1 x}}
\end{align}\]</span>
Where <span class="math inline">\(p(x)\)</span> is the probability of success (here surviving a burn). <span class="math inline">\(\beta_1\)</span> still determines the direction and <em>slope</em> of the line. <span class="math inline">\(\beta_0\)</span> now determines the location (median survival).</p>
<ul>
<li><p><strong>Note 1</strong> What is the probability of success for a patient with covariate of <span class="math inline">\(x = -\beta_0 / \beta_1\)</span>?<br><span class="math display">\[\begin{align}
x &amp;= - \beta_0 / \beta_1\\
\beta_0 + \beta_1 x &amp;= 0\\
e^{0} &amp;= 1\\
p(-\beta_0 / \beta_1) &amp;= p(x) = 0.5
\end{align}\]</span>
(for a given <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_0\)</span> determines the median survival value)</p></li>
<li><p><strong>Note 2</strong> If <span class="math inline">\(x=0\)</span>,
<span class="math display">\[\begin{align}
p(0) = \frac{e^{\beta_0}}{1+e^{\beta_0}}
\end{align}\]</span>
<span class="math inline">\(x=0\)</span> can often be thought of as the baseline condition, and the probability at <span class="math inline">\(x=0\)</span> takes the place of thinking about the intercept in a linear regression.</p></li>
<li><p><strong>Note 3</strong><br><span class="math display">\[\begin{align}
1 - p(x) = \frac{1}{1+e^{\beta_0 + \beta_1 x}}
\end{align}\]</span><br>
gives the probability of failure.
<span class="math display">\[\begin{align}
\frac{p(x)}{1-p(x)} = e^{\beta_0 + \beta_1 x}
\end{align}\]</span><br>
gives the odds of success.
<span class="math display">\[\begin{align}
\ln \bigg( \frac{p(x)}{1-p(x)} \bigg) = \beta_0 + \beta_1 x
\end{align}\]</span><br>
gives the <span class="math inline">\(\ln\)</span> odds of success .</p></li>
<li><p><strong>Note 4</strong> Every type of generalized linear model has a link function. Ours is called the <em>logit</em>. The link is the relationship between the response variable and the <em>linear</em> function in x.
<span class="math display">\[\begin{align}
\mbox{logit}(\star) = \ln \bigg( \frac{\star}{1-\star} \bigg) \ \ \ \ 0 &lt; \star &lt; 1
\end{align}\]</span></p></li>
</ul>
<div id="model-assumptions" class="section level4" number="5.1.1.1">
<h4>
<span class="header-section-number">5.1.1.1</span> model assumptions<a class="anchor" aria-label="anchor" href="#model-assumptions"><i class="fas fa-link"></i></a>
</h4>
<p>Just like in linear regression, our <code>Y</code> response is the only random component.</p>
<p><span class="math display">\[\begin{align}
y &amp;= \begin{cases}
1 &amp; \mbox{ died}\\
0 &amp; \mbox{ survived}
\end{cases}
\end{align}\]</span></p>
<p><span class="math display">\[\begin{align}
Y &amp;\sim \mbox{Bernoulli}(p)\\
P(Y=y) &amp;= p^y(1-p)^{1-y}
\end{align}\]</span></p>
<!--
%\begin{align}
%Y &\sim \mbox{Binomial}(m,p)\\
%P(Y=y) &= {m \choose y}p^y(1-p)^{m-y}\\
%E(Y/m) &= p\\
%E(Y) &= m p\\
%Var(Y) &= m p (1-p)
%\end{align}
-->
<p>When each person is at risk for a different covariate (i.e., explanatory variable), they each end up with a different probability of success.
<span class="math display">\[\begin{align}
Y_i \sim \mbox{Bernoulli} \bigg( p(x_i) = \frac{e^{\beta_0 + \beta_1 x_i}}{1+ e^{\beta_0 + \beta_1 x_i}}\bigg)
\end{align}\]</span></p>
<ul>
<li>independent trials<br>
</li>
<li>success / failure<br>
</li>
<li>probability of success is constant for a particular <span class="math inline">\(X\)</span>.<br>
</li>
<li>
<span class="math inline">\(E[Y|x] = p(x)\)</span> is given by the logistic function</li>
</ul>
</div>
<div id="interpreting-coefficients" class="section level4" number="5.1.1.2">
<h4>
<span class="header-section-number">5.1.1.2</span> interpreting coefficients<a class="anchor" aria-label="anchor" href="#interpreting-coefficients"><i class="fas fa-link"></i></a>
</h4>
<p>Let’s say the log odds of survival for given observed (log) burn areas <span class="math inline">\(x\)</span> and <span class="math inline">\(x+1\)</span> are:
<span class="math display">\[\begin{align}
\mbox{logit}(p(x)) &amp;= \beta_0 + \beta_1 x\\
\mbox{logit}(p(x+1)) &amp;= \beta_0 + \beta_1 (x+1)\\
\beta_1 &amp;= \mbox{logit}(p(x+1)) - \mbox{logit}(p(x))\\
&amp;= \ln \bigg(\frac{p(x+1)}{1-p(x+1)} \bigg) -  \ln \bigg(\frac{p(x)}{1-p(x)} \bigg)\\
&amp;= \ln \bigg( \frac{p(x+1) / [1-p(x+1)]}{p(x) / [1-p(x)]} \bigg)\\
e^{\beta_1} &amp;= \bigg( \frac{p(x+1) / [1-p(x+1)]}{p(x) / [1-p(x)]} \bigg)\\
\end{align}\]</span></p>
<p><span class="math inline">\(e^{\beta_1}\)</span> is the <em>odds ratio</em> for dying associated with a one unit increase in x. [<span class="math inline">\(\beta_1\)</span> is the change in log-odds associated with a one unit increase in x.] 1.50 0.405 2 31
#&gt; 3 (32.5,35.5] 2.44 0.894 9 34
#&gt; 4 (35.5,38.5] 3.50 1.253 6 37
#&gt; 5 (38.5,41.5] 2.00 0.693 2 40
#&gt; 6 (41.5,44.5] 3.57 1.273 7 43
#&gt; 7 (44.5,47.5] 6.00 1.792 2 46
#&gt; 8 (47.5,50.5] 2.00 0.693 1 49
#&gt; 9 (50.5,53.5] 9.00 2.197 1 52</p>
<p>elephantsGRP %&gt;% ggplot(aes(x=age, y=logmate)) + geom_point()</p>
<pre><code>
&lt;img src="08-PoisReg_files/figure-html/unnamed-chunk-9-1.png" width="80%" style="display: block; margin: auto;" /&gt;



## Inference in Poisson Regression {#inferPois}

Recall that in Poisson regression, $E(Y_i) = \mu_i = e^{\beta_0 + \beta_1 X_i}$.  Therefore, the probability function for the $i^{th}$ observation is:

$$f(y_i) = \frac{e^{-\mu_i} \mu_i^{y_i}}{y_i!} = \frac{e^{-e^{\beta_0 + \beta_1 X_i}} \bigg(e^{\beta_0 + \beta_1 X_i}\bigg)^{y_i}}{y_i!}.$$
Which gives the resulting likelihood of:


$$L(\beta_0, \beta_1) = \prod_{i=1}^n f(y_i) = \prod_{i=1}^n \frac{e^{-\mu_i} \mu_i^{y_i}}{y_i!} = \prod_{i=1}^n \frac{e^{-e^{\beta_0 + \beta_1 X_i}} \bigg(e^{\beta_0 + \beta_1 X_i}\bigg)^{y_i}}{y_i!}.$$

And the log likelihood becomes:

\begin{eqnarray*}
l(\beta_0, \beta_1) &amp;=&amp; \ln L(\beta_0, \beta_1) = \sum_{i=1}^n \bigg(-\mu_i + y_i \ln(\mu_i) - \ln(y_i!) \bigg) \\
&amp;=&amp; \sum_{i=1}^n \bigg(-e^{\beta_0 + \beta_1 X_i} + y_i (\beta_0 + \beta_1 X_i) - \ln(y_i!) \bigg).
\end{eqnarray*}

### Maximum Likelihood 

As with other probabilistic models we've encountered, the joint likelihood of the entire sample represents the product of the individual likelihoods for each data value.  The likelihood (or more typically, the $\ln$-likelihood) is maximized to find estimates for $\beta_0$ and $\beta_1$.

The parameter estimates maximize the $\ln$-likelihood, and the SE of the estimates are given by the Fisher Information from the likelihood (roughly the second derivative).

Given $b_0$ and $b_1$ as estimates of the parameter values, $\beta_0$ and $\beta_1$, we can estimate the average count value:

$$\hat{\mu}_i = e^{b_0 + b_1 X_i}$$

#### Residuals

Note that we *expect* the residuals of a Poisson model to have larger variability for larger values of the prediction.  That makes interpreting the residuals slightly different that previously for a linear regression model.

Pearson residual:

$$res_{pi} = \frac{y_i - \hat{\mu}_i}{\hat{\mu}_i}$$

Deviance residual:

\begin{eqnarray*}
res_{di} &amp;=&amp; [-\hat{\mu}_i + y_i \ln(\hat{\mu}_i) - \ln(y_i!) ] - [-y_i + y_i \ln(y_i) - \ln(y_i!) ] \\
&amp;=&amp; y_i-\hat{\mu}_i + y_i \ln\bigg(\frac{\hat{\mu}_i}{y_i}\bigg)
\end{eqnarray*}


Along with giving information about individual residual values, the sum of the Deviance residuals is also a way to test for goodness-of-fit of the model.  Given the null hypothesis that the Poisson is the appropriate model, the test of goodness-of-fit for the Poisson model is given by:

$$\sum_{i=1}^n res_{di} \stackrel{H_0}{\sim} \chi_{n-p}^2.$$


#### Dealing with Overdispersion {#overdis}

A probability structure that is given by a variance which is larger than the mean, may end up with:

\begin{eqnarray*}
E(Y_i) &amp;=&amp; \mu_i\\
Var(Y_i) &amp;=&amp; \phi \mu_i\\
\end{eqnarray*}

If we can estimate $\phi$, then a more appropriate SE to use is adjusted by $\phi$:  $SE_Q(\hat{\beta}) = \sqrt{\phi} SE(\hat{\beta})$.  ($Q$ stands for "quasiPoisson".)

When $Y$ comes from a setting where the sample size is large, then we can use normal (sums of standard normal random variables are distributed according to a $\chi^2$ distribution) theory to assess the residuals:

$$\sum_{i=1}^n res_{pi}^2 = \sum_{i=1}^n \frac{(Y_i - \mu_i)^2}{Var(Y_i)} = \sum_{i=1}^n \frac{(Y_i - \mu_i)^2}{\phi \mu_i} \sim \chi^2_{n-p}$$

The expected value of $\chi^2_{n-p}$ is $n-p$, which gives an estimator of $\phi$ to be:

$$\hat{\phi} =  \sum_{i=1}^n \frac{(Y_i - \mu_i)^2}{\mu_i} /(n-p).$$


Note that your text uses the Deviance residual instead of the Pearson residual to estimate $\phi$.  Both are reasonable things to do.

### Wald Tests

As before, Wald tests are given by standardizing the coefficients and finding p-values using normal theory:

$$\frac{b_i - 0}{SE(b_i)} \stackrel{H_0}{\sim} N(0,1).$$

If overdispersion is expected, then the SE is adjusted and the t-distribution is used for calculating p-values:

$$\frac{b_i - 0}{SE_Q(b_i)} =  \frac{b_i - 0}{\sqrt{\hat{\phi}} SE(b_i)} \stackrel{H_0}{\sim} t_{n-p}.$$


### Drop-in-Deviance Tests


The deviance for a Poisson is reasonably straightforward and comes directly from the likelihood, it is twice the sum of the deviance residuals:

$$D = 2 \sum_{i=1}^n [Y_i \ln(Y_i / \hat{\mu_i}) - (Y_i - \hat{\mu_i})].$$


For two nested models (that is, the smaller one is obtained by forcing some of the coefficients in the larger model to be zero), a drop-in-deviance test can be calculated using:

$$D_{reduced} - D_{full} \stackrel{H_0}{\sim} \chi^2_{d}$$

where $d$ is the difference in the number of parameters estimated in the two models.

The drop-in-deviance test can also be adjusted for overdispersion:  $F_Q =  (D_{reduced} - D_{full}) / \hat{\phi} \sim F_{d, n-p}$ where $d$ is the difference in the number of parameters estimated in the two models, and $p$ is the total number of parameters estimated in the full model.

## R Poisson Example

The R example is taken from data given in the textbook.  The scientific question relates to predicting the total number of observed `species` on the Galapagos archipelago related to island `area` (km$^2$), `elevation` (m), distance (km) to the `nearest` neighbor and to the largest island (km$^2$) in the archipelago Santa Cruz (`scruz`), and the area of the `adjacent` island (km$^2$).  We could also consider an additional response variable which is the island `endemic` species count.


```r
galap &lt;- readr::read_csv("Galapagos.csv")
head(galap)
#&gt; # A tibble: 6 × 8
#&gt;   island      species endemics  area elevation nearest scruz adjacent
#&gt;   &lt;chr&gt;         &lt;dbl&gt;    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
#&gt; 1 Baltra           58       23 25.1        346     0.6   0.6     1.84
#&gt; 2 Bartolome        31       21  1.24       109     0.6  26.3   572.  
#&gt; 3 Caldwell          3        3  0.21       114     2.8  58.7     0.78
#&gt; 4 Champion         25        9  0.1         46     1.9  47.4     0.18
#&gt; 5 Coamano           2        1  0.05        77     1.9   1.9   904.  
#&gt; 6 DaphneMajor      18       11  0.34       119     8     8       1.84</code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">galap</span>, <span class="fu">aes</span><span class="op">(</span>y<span class="op">=</span><span class="va">species</span>, x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span>, color <span class="op">=</span> <span class="va">adjacent</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="08-PoisReg_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="glm" class="section level3" number="5.1.2">
<h3>
<span class="header-section-number">5.1.2</span> glm<a class="anchor" aria-label="anchor" href="#glm"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">elevation</span><span class="op">)</span> <span class="op">+</span> <span class="va">nearest</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 5</span>
<span class="co">#&gt;   term            estimate std.error statistic  p.value</span>
<span class="co">#&gt;   &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 (Intercept)     3.02     0.303         9.96  2.28e-23</span>
<span class="co">#&gt; 2 log(area)       0.315    0.0185       17.1   2.20e-65</span>
<span class="co">#&gt; 3 log(elevation)  0.0977   0.0604        1.62  1.06e- 1</span>
<span class="co">#&gt; 4 nearest        -0.00106  0.00169      -0.626 5.32e- 1</span>
<span class="co">#&gt; 5 scruz          -0.00314  0.000597     -5.26  1.40e- 7</span>
<span class="co">#&gt; 6 adjacent       -0.000243 0.0000281    -8.65  5.31e-18</span></code></pre></div>
</div>
<div id="drop-in-deviance" class="section level3" number="5.1.3">
<h3>
<span class="header-section-number">5.1.3</span> drop in deviance<a class="anchor" aria-label="anchor" href="#drop-in-deviance"><i class="fas fa-link"></i></a>
</h3>
<p>It seems like we might not need either <code>log(elevation)</code> or <code>nearest</code>. A drop in deviance test will help:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">elevation</span><span class="op">)</span> <span class="op">+</span> <span class="va">nearest</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">glance</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 8</span>
<span class="co">#&gt;   null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs</span>
<span class="co">#&gt;           &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1         3511.      29  -294.  600.  609.     427.          24    30</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">glance</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 1 × 8</span>
<span class="co">#&gt;   null.deviance df.null logLik   AIC   BIC deviance df.residual  nobs</span>
<span class="co">#&gt;           &lt;dbl&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;       &lt;int&gt; &lt;int&gt;</span>
<span class="co">#&gt; 1         3511.      29  -296.  600.  606.     431.          26    30</span>

<span class="fl">431.11</span> <span class="op">-</span> <span class="fl">427.48</span>
<span class="co">#&gt; [1] 3.63</span>
<span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html">pchisq</a></span><span class="op">(</span><span class="fl">3.63</span>, <span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; [1] 0.163</span></code></pre></div>
<p>The relatively large p-value suggests that we do not need either of the variables <code>log(elevation)</code> or <code>nearest</code></p>
</div>
<div id="residuals" class="section level3" number="5.1.4">
<h3>
<span class="header-section-number">5.1.4</span> residuals<a class="anchor" aria-label="anchor" href="#residuals"><i class="fas fa-link"></i></a>
</h3>
<p>Keep in mind that the expectation of a Poisson model is that the residuals will be more variable for larger predicted values. The <code>broom</code> package provides <code>.resid</code>uals which are the observed value minus the fitted value. I <em>think</em> that <code>.std.resid</code> is the Pearson residual.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 10</span>
<span class="co">#&gt;   species `log(area)` scruz adjac…¹ .fitted .resid .std.…²   .hat .sigma .cooksd</span>
<span class="co">#&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1      58       3.22    0.6    1.84    4.61 -4.57   -4.83  0.105    4.04 0.581  </span>
<span class="co">#&gt; 2      31       0.215  26.3  572.      3.36  0.414   0.427 0.0605   4.15 0.00301</span>
<span class="co">#&gt; 3       3      -1.56   58.7    0.78    2.76 -3.96   -4.05  0.0417   4.07 0.118  </span>
<span class="co">#&gt; 4      25      -2.30   47.4    0.18    2.55  3.01    3.08  0.0413   4.11 0.131  </span>
<span class="co">#&gt; 5       2      -3.00    1.9  904.      2.27 -3.01   -3.10  0.0559   4.11 0.0959 </span>
<span class="co">#&gt; 6      18      -1.08    8      1.84    3.11 -0.953  -0.986 0.0661   4.15 0.0161 </span>
<span class="co">#&gt; # … with abbreviated variable names ¹​adjacent, ²​.std.resid</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">.fitted</span>, y<span class="op">=</span><span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"poisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">.fitted</span>, y<span class="op">=</span><span class="va">.std.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="08-PoisReg_files/figure-html/unnamed-chunk-14-1.png" width="80%" style="display: block; margin: auto;"><img src="08-PoisReg_files/figure-html/unnamed-chunk-14-2.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div id="quasipoisson" class="section level3" number="5.1.5">
<h3>
<span class="header-section-number">5.1.5</span> quasiPoisson<a class="anchor" aria-label="anchor" href="#quasipoisson"><i class="fas fa-link"></i></a>
</h3>
<p>Note that all of the above analyses can be done using the overdispersed quasiPoisson model.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">elevation</span><span class="op">)</span> <span class="op">+</span> <span class="va">nearest</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"quasipoisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 5</span>
<span class="co">#&gt;   term            estimate std.error statistic  p.value</span>
<span class="co">#&gt;   &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 (Intercept)     3.02      1.29         2.34  0.0278  </span>
<span class="co">#&gt; 2 log(area)       0.315     0.0786       4.02  0.000507</span>
<span class="co">#&gt; 3 log(elevation)  0.0977    0.257        0.381 0.707   </span>
<span class="co">#&gt; 4 nearest        -0.00106   0.00720     -0.147 0.884   </span>
<span class="co">#&gt; 5 scruz          -0.00314   0.00254     -1.24  0.228   </span>
<span class="co">#&gt; 6 adjacent       -0.000243  0.000120    -2.03  0.0532</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"quasipoisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 4 × 5</span>
<span class="co">#&gt;   term         estimate std.error statistic  p.value</span>
<span class="co">#&gt;   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;</span>
<span class="co">#&gt; 1 (Intercept)  3.50      0.203        17.3  8.76e-16</span>
<span class="co">#&gt; 2 log(area)    0.342     0.0304       11.3  1.63e-11</span>
<span class="co">#&gt; 3 scruz       -0.00354   0.00197      -1.80 8.36e- 2</span>
<span class="co">#&gt; 4 adjacent    -0.000221  0.000104     -2.12 4.35e- 2</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"quasipoisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 × 10</span>
<span class="co">#&gt;   species `log(area)` scruz adjac…¹ .fitted .resid .std.…²   .hat .sigma .cooksd</span>
<span class="co">#&gt;     &lt;dbl&gt;       &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1      58       3.22    0.6    1.84    4.61 -4.57   -1.18  0.105    4.04 3.47e-2</span>
<span class="co">#&gt; 2      31       0.215  26.3  572.      3.36  0.414   0.104 0.0605   4.15 1.80e-4</span>
<span class="co">#&gt; 3       3      -1.56   58.7    0.78    2.76 -3.96   -0.989 0.0417   4.07 7.05e-3</span>
<span class="co">#&gt; 4      25      -2.30   47.4    0.18    2.55  3.01    0.752 0.0413   4.11 7.81e-3</span>
<span class="co">#&gt; 5       2      -3.00    1.9  904.      2.27 -3.01   -0.758 0.0559   4.11 5.72e-3</span>
<span class="co">#&gt; 6      18      -1.08    8      1.84    3.11 -0.953  -0.241 0.0661   4.15 9.58e-4</span>
<span class="co">#&gt; # … with abbreviated variable names ¹​adjacent, ²​.std.resid</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"quasipoisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">.fitted</span>, y<span class="op">=</span><span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/stats/glm.html">glm</a></span><span class="op">(</span><span class="va">species</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">area</span><span class="op">)</span> <span class="op">+</span> <span class="va">scruz</span> <span class="op">+</span> <span class="va">adjacent</span>, 
    data<span class="op">=</span> <span class="va">galap</span>, family<span class="op">=</span><span class="st">"quasipoisson"</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span> <span class="fu">augment</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://infer.tidymodels.org/reference/pipe.html">%&gt;%</a></span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">.fitted</span>, y<span class="op">=</span><span class="va">.std.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="08-PoisReg_files/figure-html/unnamed-chunk-16-1.png" width="80%" style="display: block; margin: auto;"><img src="08-PoisReg_files/figure-html/unnamed-chunk-16-2.png" width="80%" style="display: block; margin: auto;"></p>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="analysis-of-categorical-data.html"><span class="header-section-number">4</span> Analysis of Categorical Data</a></div>
<div class="next"><a href="references.html">References</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#logistic-regression"><span class="header-section-number">5</span> Logistic Regression</a></li>
<li>
<a class="nav-link" href="#logmodel"><span class="header-section-number">5.1</span> Motivation for Logistic Regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#the-logistic-model"><span class="header-section-number">5.1.1</span> The logistic model</a></li>
<li><a class="nav-link" href="#glm"><span class="header-section-number">5.1.2</span> glm</a></li>
<li><a class="nav-link" href="#drop-in-deviance"><span class="header-section-number">5.1.3</span> drop in deviance</a></li>
<li><a class="nav-link" href="#residuals"><span class="header-section-number">5.1.4</span> residuals</a></li>
<li><a class="nav-link" href="#quasipoisson"><span class="header-section-number">5.1.5</span> quasiPoisson</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/08-PoisReg.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/08-PoisReg.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Methods in Biostatistics</strong>" was written by Jo Hardin. It was last built on 2022-07-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
