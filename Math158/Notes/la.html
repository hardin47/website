<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 8 Regression using Matrices | Linear Models</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="Everything we’ve done so far can be written in matrix form. Though it might seem no more efficient to use matrices with simple linear regression, it will become clear that with multiple linear...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 8 Regression using Matrices | Linear Models">
<meta property="og:type" content="book">
<meta property="og:description" content="Everything we’ve done so far can be written in matrix form. Though it might seem no more efficient to use matrices with simple linear regression, it will become clear that with multiple linear...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 8 Regression using Matrices | Linear Models">
<meta name="twitter:description" content="Everything we’ve done so far can be written in matrix form. Though it might seem no more efficient to use matrices with simple linear regression, it will become clear that with multiple linear...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Linear Models</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="wrang.html"><span class="header-section-number">2</span> Data Wrangling</a></li>
<li><a class="" href="viz.html"><span class="header-section-number">3</span> Visualization</a></li>
<li><a class="" href="slr.html"><span class="header-section-number">4</span> Simple Linear Regression</a></li>
<li><a class="" href="infslr.html"><span class="header-section-number">5</span> Inference on SLR Parameters</a></li>
<li><a class="" href="diag1.html"><span class="header-section-number">6</span> Diagnostic Measures I</a></li>
<li><a class="" href="simult.html"><span class="header-section-number">7</span> Simultaneous Inference</a></li>
<li><a class="active" href="la.html"><span class="header-section-number">8</span> Regression using Matrices</a></li>
<li><a class="" href="mlr.html"><span class="header-section-number">9</span> Multiple Linear Regression</a></li>
<li><a class="" href="build.html"><span class="header-section-number">10</span> Model Building</a></li>
<li><a class="" href="diag2.html"><span class="header-section-number">11</span> Diagnostics II</a></li>
<li><a class="" href="shrink.html"><span class="header-section-number">12</span> Shrinkage Methods</a></li>
<li><a class="" href="smooth.html"><span class="header-section-number">13</span> Smoothing Methods</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">14</span> ANOVA</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="la" class="section level1" number="8">
<h1>
<span class="header-section-number">8</span> Regression using Matrices<a class="anchor" aria-label="anchor" href="#la"><i class="fas fa-link"></i></a>
</h1>
<p>Everything we’ve done so far can be written in matrix form. Though it might seem no more efficient to use matrices with simple linear regression, it will become clear that with multiple linear regression, matrices can be very powerful. ALSM chapter 5 contains a lot of matrix theory; the main take away points from the chapter have to do with the matrix theory <em>applied to the regression setting</em>. Please make sure that you read the chapters / examples having to do with the regression examples.</p>
<div id="special-matrices" class="section level2" number="8.1">
<h2>
<span class="header-section-number">8.1</span> Special Matrices<a class="anchor" aria-label="anchor" href="#special-matrices"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<colgroup><col width="100%"></colgroup>
<tbody>
<tr class="odd">
<td align="center">
<strong>1</strong> = <span class="math inline">\(\begin{pmatrix} 1 \\ 1 \\ \vdots \\ 1 \end{pmatrix}\)</span>
</td>
</tr>
<tr class="even">
<td align="center">
<strong>I</strong> = <span class="math inline">\(\begin{pmatrix} 1 &amp; 0 &amp; \cdots &amp; 0\\ 0 &amp; 1 &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; 1 \end{pmatrix}\)</span>
</td>
</tr>
<tr class="odd">
<td align="center">
<strong>J</strong> = <span class="math inline">\(\begin{pmatrix} 1 &amp; 1 &amp; \cdots &amp; 1\\ 1 &amp; 1 &amp; \cdots &amp; 1 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; 1 &amp; \cdots &amp; 1 \end{pmatrix}\)</span>
</td>
</tr>
<tr class="even">
<td align="center">
<strong>0</strong> = <span class="math inline">\(\begin{pmatrix} 0 &amp; 0 &amp; \cdots &amp; 0\\ 0 &amp; 0 &amp; \cdots &amp; 0 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 0 &amp; 0 &amp; \cdots &amp; 0 \end{pmatrix}\)</span>
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="regression-model" class="section level2" number="8.2">
<h2>
<span class="header-section-number">8.2</span> Regression Model<a class="anchor" aria-label="anchor" href="#regression-model"><i class="fas fa-link"></i></a>
</h2>
<div id="matrix-addition" class="section level3" number="8.2.1">
<h3>
<span class="header-section-number">8.2.1</span> Matrix Addition<a class="anchor" aria-label="anchor" href="#matrix-addition"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[\begin{eqnarray*}
Y_i &amp;=&amp; E[Y_i] + \epsilon_i\\
&amp;&amp;\\
\begin{pmatrix} Y_1\\ Y_2 \\ \vdots \\ Y_n \end{pmatrix} &amp;=&amp;
\begin{pmatrix} E[Y_1]\\ E[Y_2] \\ \vdots \\ E[Y_n] \end{pmatrix} +
\begin{pmatrix} \epsilon_1\\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{pmatrix}\\
&amp;&amp;\\
\underline{Y} &amp;=&amp; E[\underline{Y}] + \underline{\epsilon}\\
\end{eqnarray*}\]</span>
Similarly,
<span class="math display">\[\begin{eqnarray*}
Y_i &amp;=&amp; \hat{Y}_i + e_i\\
&amp;&amp;\\
\begin{pmatrix} Y_1\\ Y_2 \\ \vdots \\ Y_n \end{pmatrix} &amp;=&amp;
\begin{pmatrix} \hat{Y}_1\\ \hat{Y}_2 \\ \vdots \\ \hat{Y}_n \end{pmatrix} +
\begin{pmatrix} e_1\\ e_2 \\ \vdots \\ e_n \end{pmatrix}\\
&amp;&amp;\\
\underline{Y} &amp;=&amp; \underline{\hat{Y}} + \underline{e}\\
\end{eqnarray*}\]</span></p>
</div>
</div>
<div id="matrix-multiplication" class="section level2" number="8.3">
<h2>
<span class="header-section-number">8.3</span> Matrix Multiplication<a class="anchor" aria-label="anchor" href="#matrix-multiplication"><i class="fas fa-link"></i></a>
</h2>
<div id="example" class="section level3" number="8.3.1">
<h3>
<span class="header-section-number">8.3.1</span> Example<a class="anchor" aria-label="anchor" href="#example"><i class="fas fa-link"></i></a>
</h3>
<p>Consider multiplying an <span class="math inline">\(r \times c\)</span> matrix with a <span class="math inline">\(c \times s\)</span> matrix. The <em>interior</em> dimensions must always be the same. The resulting matrix will always be <span class="math inline">\(r \times s\)</span>. The element in the <span class="math inline">\(i^{th}\)</span> row and <span class="math inline">\(j^{th}\)</span> column is given by:
<span class="math display">\[\begin{eqnarray*}
\sum_{k=1}^c a_{ik} b_{kj}\\
AB &amp;=&amp; \begin{pmatrix} a_{11} &amp; a_{12} &amp; a_{13} \\ a_{21} &amp; a_{22} &amp; a_{23} \end{pmatrix}
\begin{pmatrix} b_{11} &amp; b_{12} \\ b_{21} &amp; b_{22} \\ b_{31} &amp; b_{32} \end{pmatrix}\\
&amp;=&amp; \begin{pmatrix} a_{11} b_{11} + a_{12} b_{21} + a_{13}b_{31} &amp; a_{11} b_{12} + a_{12} b_{22} + a_{13}b_{32} \\ a_{21} b_{11} + a_{22} b_{21} + a_{23}b_{31} &amp; a_{21} b_{12} + a_{22} b_{22} + a_{23}b_{32}
\end{pmatrix}\\
&amp;&amp;\\
AB &amp;=&amp; \begin{pmatrix} 3 &amp; -1 &amp; 0 \\ 0 &amp; 1 &amp; 1 \\ -2 &amp; 0 &amp; 1 \end{pmatrix}
\begin{pmatrix} 1 &amp; 1\\ -1 &amp; 2 \\ 0 &amp; -1 \end{pmatrix}\\
&amp;=&amp; \begin{pmatrix} 4 &amp; 1\\ -1 &amp; 1 \\ -2 &amp; -3 \end{pmatrix}
\end{eqnarray*}\]</span></p>
<div id="and-in-the-linear-regression-context" class="section level4 unnumbered">
<h4>and in the linear regression context…<a class="anchor" aria-label="anchor" href="#and-in-the-linear-regression-context"><i class="fas fa-link"></i></a>
</h4>
<p><span class="math display">\[\begin{eqnarray*}
E[Y_i] &amp;=&amp; \beta_0 + \beta_1 X_i\\
&amp;&amp;\\
\begin{pmatrix} E[Y_1]\\ E[Y_2] \\ \vdots \\ E[Y_n] \end{pmatrix} &amp;=&amp;
\begin{pmatrix} 1 &amp; X_1\\ 1 &amp; X_2 \\ \vdots \\ 1 &amp; X_n \end{pmatrix}
\begin{pmatrix} \beta_0 \\ \beta_1 \end{pmatrix}\\
&amp;&amp;\\
E[\underline{Y}] &amp;=&amp; X \underline{\beta}\\
\end{eqnarray*}\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
\underline{Y}^t \underline{Y} &amp;=&amp; \begin{pmatrix} Y_1 &amp; Y_2 &amp; \cdots &amp; Y_n \end{pmatrix} \begin{pmatrix} Y_1 \\ Y_2 \\ \vdots \\ Y_n \end{pmatrix} = \sum_{i=1}^n Y_i^2\\
&amp;&amp;\\
X^t X &amp;=&amp; \begin{pmatrix} 1 &amp; 1 &amp; \cdots &amp; 1\\ X_1 &amp; X_2 &amp; \cdots &amp; X_n \end{pmatrix} \begin{pmatrix} 1 &amp; X_1 \\ 1 &amp; X_2 \\ \vdots &amp; \vdots \\ 1 &amp; X_n \end{pmatrix}= \begin{pmatrix} n &amp; \sum_{i=1}^n X_i \\ \sum_{i=1}^n X_i &amp; \sum_{i=1}^n X_i^2 \end{pmatrix}\\
&amp;&amp;\\
X^t \underline{Y} &amp;=&amp; \begin{pmatrix} 1 &amp; 1 &amp; \cdots &amp; 1\\ X_1 &amp; X_2 &amp; \cdots &amp; X_n \end{pmatrix} \begin{pmatrix} Y_1 \\ Y_2 \\ \vdots \\ Y_n \end{pmatrix} = \begin{pmatrix} \sum_{i=1}^n Y_i \\ \sum_{i=1}^n X_i Y_i \end{pmatrix}
\end{eqnarray*}\]</span></p>
</div>
</div>
</div>
<div id="matrix-inverses-in-the-regression-context" class="section level2" number="8.4">
<h2>
<span class="header-section-number">8.4</span> Matrix Inverses in the Regression Context<a class="anchor" aria-label="anchor" href="#matrix-inverses-in-the-regression-context"><i class="fas fa-link"></i></a>
</h2>
<div id="matrix-inverses" class="section level3" number="8.4.1">
<h3>
<span class="header-section-number">8.4.1</span> Matrix Inverses<a class="anchor" aria-label="anchor" href="#matrix-inverses"><i class="fas fa-link"></i></a>
</h3>
<p>An <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(A\)</span> is called <em>invertible</em> if there exists an <span class="math inline">\(n \times n\)</span> matrix <span class="math inline">\(B\)</span> such that
<span class="math display">\[\begin{eqnarray*}
A B = B A = I_n
\end{eqnarray*}\]</span>

<span class="math inline">\(B\)</span> is called the <em>inverse</em> of <span class="math inline">\(A\)</span> and is typically denoted by <span class="math inline">\(B = A^{-1}\)</span>. (Note, inverses only exist for square matrices with non-zero determinants.)</p>
</div>
<div id="example-5" class="section level3" number="8.4.2">
<h3>
<span class="header-section-number">8.4.2</span> Example<a class="anchor" aria-label="anchor" href="#example-5"><i class="fas fa-link"></i></a>
</h3>
<p><span class="math display">\[A = \begin{pmatrix} a  &amp;  b \\ c  &amp;  d \end{pmatrix}\]</span></p>
<p><span class="math display">\[ A^{-1} = \begin{pmatrix} d / (ad - bc)  &amp;  -b / (ad - bc) \\ -c / (ad - bc)  &amp;  a / (ad - bc) \end{pmatrix}\]</span></p>
<p>where the determinant is given by <span class="math inline">\(D = ad - bc\)</span>.
<span class="math display">\[\begin{eqnarray*}
A^{-1} A &amp;=&amp; \begin{pmatrix} d / (ad - bc) &amp; -b / (ad - bc) \\ -c / (ad - bc) &amp; a / (ad - bc) \end{pmatrix} \begin{pmatrix} a &amp; b \\ c &amp; d \end{pmatrix}\\
&amp;=&amp; \begin{pmatrix} (ad - bc) / (ad - bc) &amp; (bd - bd) / (ad - bc) \\ (-ac + ac) / (ad - bc) &amp; (ad - bc) / (ad - bc) \end{pmatrix}\\
&amp;=&amp; I_2
\end{eqnarray*}\]</span></p>
<p><span class="math display">\[A = \begin{pmatrix} 3  &amp;  2 \\ 1  &amp;  6 \end{pmatrix}\]</span></p>
<p><span class="math display">\[ A^{-1} = \begin{pmatrix} 6 / 16  &amp;  -2 / 16 \\ -1 / 16  &amp;  3 / 16 \end{pmatrix} \]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
A^{-1} A &amp;=&amp; \begin{pmatrix} 6 / 16 &amp; -2 / 16 \\ -1 / 16 &amp; 3 / 16 \end{pmatrix}  \begin{pmatrix} 3 &amp; 2 \\ 1 &amp; 6 \end{pmatrix}\\
&amp;=&amp; \begin{pmatrix} (18-2)/16 &amp; (12-12)/16 \\ (-3+3)/16 &amp; (-2+18)/16 \end{pmatrix}\\
&amp;=&amp; I_2
\end{eqnarray*}\]</span></p>
</div>
<div id="variance-of-coefficients" class="section level3" number="8.4.3">
<h3>
<span class="header-section-number">8.4.3</span> Variance of Coefficients<a class="anchor" aria-label="anchor" href="#variance-of-coefficients"><i class="fas fa-link"></i></a>
</h3>
<div id="what-is-a-variance-matrix" class="section level4 unnumbered">
<h4>What is a Variance Matrix?<a class="anchor" aria-label="anchor" href="#what-is-a-variance-matrix"><i class="fas fa-link"></i></a>
</h4>
<p>Consider two random variables, <span class="math inline">\(U\)</span> and <span class="math inline">\(W\)</span>. We’d typically have <span class="math inline">\(n\)</span> observations of each variable, resulting in data vectors <span class="math inline">\(\underline{U}\)</span> and <span class="math inline">\(\underline{W}\)</span>. The variance-covariance matrix describing the variability relationship between <span class="math inline">\(U\)</span> and <span class="math inline">\(W\)</span> is given by:
<span class="math display">\[\begin{eqnarray*}
\mbox{var}\{\underline{U},\underline{W} \} &amp;=&amp; \begin{pmatrix} \sigma_U^2  &amp; \sigma_{U,W} \\ \sigma_{W,U} &amp; \sigma_W^2 \end{pmatrix}\\
\mbox{where } \sigma_U^2 &amp;=&amp; \mbox{ variance of } U  \mbox{ (a number)}\\
\sigma_W^2 &amp;=&amp; \mbox{ variance of } V  \mbox{ (a number)}\\
\sigma_{U,W} &amp;=&amp; \sigma_{W,U} = \mbox{ covariance of } U \mbox{ and } W  \mbox{ (a number)} \\
\end{eqnarray*}\]</span>
In order to find the variance matrix for the regression coefficients, we use matrix notation.
<span class="math display">\[\begin{eqnarray*}
\mbox{Recall:    }  X^t X &amp;=&amp;  \begin{pmatrix} n &amp; \sum_{i=1}^n X_i \\ \sum_{i=1}^n X_i &amp; \sum_{i=1}^n X_i^2 \end{pmatrix}\\
&amp;&amp;\\
\mbox{So,    } D &amp;=&amp; n \sum X_i^2 - (\sum X_i)^2 = n \sum(X_i - \overline{X})^2\\
&amp;&amp;\\
(X^t X)^{-1} &amp;=&amp;  \begin{pmatrix} \frac{\sum X_i^2}{n \sum(X_i - \overline{X})^2} &amp; \frac{-\sum_{i=1}^n X_i}{n \sum(X_i - \overline{X})^2} \\ \frac{-\sum_{i=1}^n X_i}{n \sum(X_i - \overline{X})^2} &amp; \frac{n}{n \sum(X_i - \overline{X})^2} \end{pmatrix}\\
&amp;&amp;\\
&amp;=&amp;  \begin{pmatrix} \frac{1}{n} + \frac{\overline{X}^2}{\sum(X_i - \overline{X})^2} &amp; \frac{-\overline{X}}{\sum(X_i - \overline{X})^2} \\ \frac{-\overline{X}}{ \sum(X_i - \overline{X})^2} &amp; \frac{1}{ \sum(X_i - \overline{X})^2} \end{pmatrix}\\
&amp;&amp;\\
\mbox{var}\{\underline{b}\} &amp;=&amp; \sigma^2  \cdot (X^t X)^{-1}\\
&amp;=&amp; \begin{pmatrix} \sigma^2_{b_0} &amp; \sigma_{b_0, b_1} \\ \sigma_{b_1, b_0} &amp; \sigma^2_{b_1} \end{pmatrix}\\
SE^2\{\underline{b}\} &amp;=&amp; MSE  \cdot (X^t X)^{-1}\\
\end{eqnarray*}\]</span></p>
</div>
<div id="estimating-coefficients" class="section level4 unnumbered">
<h4>Estimating Coefficients<a class="anchor" aria-label="anchor" href="#estimating-coefficients"><i class="fas fa-link"></i></a>
</h4>
<p>Recall the equations that come from differentiating the sum of squared residuals with respect to both <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray*}
n b_0 + b_1 \sum X_i &amp;=&amp; \sum Y_i\\
b_0 \sum X_i + b_1 \sum X_i^2 &amp;=&amp; \sum X_i Y_i\\
&amp;&amp;\\
\begin{pmatrix} n &amp; \sum X_i \\ \sum X_i &amp; \sum X_i^2 \end{pmatrix} \begin{pmatrix} b_0 \\ b_1 \end{pmatrix} &amp;=&amp; \begin{pmatrix} \sum Y_i \\ \sum X_i Y_i \end{pmatrix}\\
&amp;&amp;\\
(X^t X) \underline{b} &amp;=&amp; X^t \underline{Y}\\
\underline{b} &amp;=&amp; (X^t X)^{-1} (X^t \underline{Y})\\
&amp;&amp;\\
\mbox{var}\{\underline{b} \} &amp;=&amp; (X^t X)^{-1} X^t \sigma^2 I X (X^t X)^{-1}\\
&amp;=&amp; \sigma^2 \cdot (X^t X)^{-1}\\
&amp;&amp;\\
\mbox{checking:}&amp;&amp;\\
(X^t X)^{-1} (X^t \underline{Y}) &amp;=&amp; \begin{pmatrix} \frac{1}{n} + \frac{\overline{X}^2}{\sum(X_i - \overline{X})^2} &amp; \frac{-\overline{X}}{\sum(X_i - \overline{X})^2} \\ \frac{-\overline{X}}{ \sum(X_i - \overline{X})^2} &amp; \frac{1}{ \sum(X_i - \overline{X})^2} \end{pmatrix} \begin{pmatrix} \sum_{i=1}^n Y_i \\ \sum_{i=1}^n X_i Y_i \end{pmatrix}\\
&amp;&amp;\\
&amp;=&amp; \begin{pmatrix} \frac{\sum Y_i}{n} + \frac{\sum Y_i \overline{X}^2}{\sum(X_i - \overline{X})^2} + \frac{-\sum X_i Y_i (\overline{X})}{\sum(X_i - \overline{X})^2} \\ \frac{-\sum Y_i (\overline{X})}{ \sum(X_i - \overline{X})^2} + \frac{\sum X_i Y_i}{ \sum(X_i - \overline{X})^2} \end{pmatrix}\\
&amp;&amp;\\
&amp;=&amp; \begin{pmatrix} \overline{Y} - b_1 \overline{X} \\ \frac{\sum Y_i (X_i - \overline{X})}{\sum(X_i - \overline{X})^2} \end{pmatrix} = \begin{pmatrix} b_0 \\ b_1 \end{pmatrix}
\end{eqnarray*}\]</span></p>
</div>
</div>
</div>
<div id="fitted-values" class="section level2" number="8.5">
<h2>
<span class="header-section-number">8.5</span> Fitted Values<a class="anchor" aria-label="anchor" href="#fitted-values"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[\begin{eqnarray*}
\hat{Y}_i &amp;=&amp; b_0 + b_1 X_i\\
&amp;&amp;\\
\begin{pmatrix} \hat{Y}_1 \\ \hat{Y}_2 \\ \vdots \\ \hat{Y}_n \end{pmatrix} &amp;=&amp; \begin{pmatrix} 1 &amp; X_1 \\ 1 &amp; X_2 \\ \vdots &amp; \vdots \\ 1 &amp; X_n \end{pmatrix} \begin{pmatrix} b_0 \\ b_1 \end{pmatrix}\\
&amp;&amp;\\
\underline{\hat{Y}} &amp;=&amp; X \underline{b}\\
 &amp;=&amp; X (X^t X)^{-1} (X^t \underline{Y})\\
&amp;=&amp; H \underline{Y}\\
\mbox{"hat" matrix: } H &amp;=&amp; X (X^t X)^{-1} X^t
\end{eqnarray*}\]</span>
We call <span class="math inline">\(H\)</span> the hat matrix because it takes <span class="math inline">\(\underline{Y}\)</span> and puts a hat on it. Note that the predicted values are simply a <em>linear combinations</em> of the response variable (<span class="math inline">\(Y\)</span>) with <em>coefficients</em> of the explanatory variables (<span class="math inline">\(X\)</span>).</p>
</div>
<div id="residuals-2" class="section level2" number="8.6">
<h2>
<span class="header-section-number">8.6</span> Residuals<a class="anchor" aria-label="anchor" href="#residuals-2"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[\begin{eqnarray*}
e_i &amp;=&amp; Y_i - \hat{Y}_i\\
\begin{pmatrix} e_1 \\ e_2 \\ \vdots \\ e_n \end{pmatrix} &amp;=&amp; \begin{pmatrix} Y_1 \\ Y_2 \\ \vdots \\Y_n \end{pmatrix} - \begin{pmatrix} \hat{Y}_1 \\ \hat{Y}_2 \\ \vdots \\ \hat{Y}_n \end{pmatrix}\\
\underline{e} &amp;=&amp; \underline{Y} - \hat{\underline{Y}}\\
&amp;=&amp; \underline{Y} - X \underline{b}\\
&amp;=&amp; \underline{Y} - H \underline{Y}\\
&amp;=&amp; (I - H) \underline{Y}\\
&amp;&amp;\\
\mbox{var}\{ \underline{e} \} &amp;=&amp; \mbox{var}\{ (I-H) \underline{Y} \}\\
&amp;=&amp; (I - H) \mbox{var}\{ \underline{Y} \}\\
&amp;=&amp; (I - H) \cdot \sigma^2 \cdot (I - H)^t\\
&amp;=&amp; \sigma^2 \cdot (I - H) (I-H^t)\\
&amp;=&amp; \sigma^2 \cdot (I - H - H^t + HH^t)\\
&amp;=&amp;  \sigma^2 \cdot (I-H)\\
SE^2(\underline{e}) &amp;=&amp; MSE \cdot (I-H)
\end{eqnarray*}\]</span></p>
</div>
<div id="analysis-of-variance" class="section level2" number="8.7">
<h2>
<span class="header-section-number">8.7</span> ANalysis Of VAriance<a class="anchor" aria-label="anchor" href="#analysis-of-variance"><i class="fas fa-link"></i></a>
</h2>
<p><span class="math display">\[\begin{eqnarray*}
SSTO &amp;=&amp; \underline{Y}^t \underline{Y} - \bigg(\frac{1}{n} \bigg) \underline{Y}^t J \underline{Y}\\
&amp;=&amp; \sum Y_i ^2 - \frac{1}{n} \begin{pmatrix} Y_1 &amp; Y_2 &amp; \cdots &amp; Y_n \end{pmatrix} \begin{pmatrix} 1 &amp; 1 &amp; \cdots &amp;  1\\ 1 &amp; 1 &amp; \cdots &amp; 1 \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ 1 &amp; 1 &amp; \cdots &amp; 1   \end{pmatrix} \begin{pmatrix} Y_1 \\ Y_2 \\ \vdots \\ Y_n \end{pmatrix} \\
&amp;=&amp; \sum Y_i ^2 - \frac{1}{n} \begin{pmatrix} Y_1 &amp; Y_2 &amp; \cdots &amp; Y_n \end{pmatrix}  \begin{pmatrix} \sum Y_i \\ \sum Y_i \\ \vdots \\ \sum Y_i \end{pmatrix} \\
&amp;=&amp; \sum Y_i ^2 - \frac{1}{n} \sum Y_i \sum Y_i\\
&amp;=&amp; \sum Y_i ^2 - n \overline{Y}^2\\
\mbox{note: } \sum(Y_i - \overline{Y})^2 &amp;=&amp; \sum (Y_i^2 - 2Y_i \overline{Y} + \overline{Y}^2)\\
&amp;=&amp; \sum Y_i^2 -2\overline{Y}\sum Y_i + n \overline{Y}^2\\
&amp;=&amp; \sum Y_i^2 - n \overline{Y}^2\\
&amp;&amp;\\
SSE &amp;=&amp; \underline{Y}^t \underline{Y} - \underline{b}^t X^t \underline{Y}\\
&amp;&amp;\\
SSR &amp;=&amp; \underline{b}^t X^t \underline{Y} - \bigg(\frac{1}{n} \bigg) \underline{Y}^t J \underline{Y}
\end{eqnarray*}\]</span></p>
</div>
<div id="prediction-of-new-observations" class="section level2" number="8.8">
<h2>
<span class="header-section-number">8.8</span> Prediction of New Observations<a class="anchor" aria-label="anchor" href="#prediction-of-new-observations"><i class="fas fa-link"></i></a>
</h2>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="48%">
<col width="51%">
</colgroup>
<thead><tr class="header">
<th align="center"><span class="math inline">\(\underline{X}_h = \begin{pmatrix} 1\\ X_h \end{pmatrix}\)</span></th>
<th align="center"><span class="math inline">\(\underline{X}_h^t = \begin{pmatrix} 1 &amp; X_h \end{pmatrix}\)</span></th>
</tr></thead>
<tbody></tbody>
</table></div>
<p><span class="math display">\[\begin{eqnarray*}
\hat{Y}_h &amp;=&amp; \underline{X}^t_h \underline{b}\\
\mbox{var}\{ \hat{Y}_h \} &amp;=&amp; \underline{X}_h^t \mbox{var}\{\underline{b} \} \underline{X}_h\\
&amp;=&amp; \sigma^2 \cdot \underline{X}_h^t (X^t X)^{-1} \underline{X}_h\\
SE^2\{\hat{Y}_h \} &amp;=&amp; MSE \cdot \underline{X}_h^t (X^t X)^{-1} \underline{X}_h\\
&amp;&amp;\\
&amp;&amp;\\
SE^2 \{\mbox{pred} \} = SE^2\{\hat{Y}_{h(new)} \} &amp;=&amp; MSE \cdot (1 + \underline{X}_h^t (X^t X)^{-1} \underline{X}_h)\\
\end{eqnarray*}\]</span></p>
</div>
<div id="reflection-questions-5" class="section level2" number="8.9">
<h2>
<span class="header-section-number">8.9</span> <i class="fas fa-lightbulb" target="_blank"></i> Reflection Questions<a class="anchor" aria-label="anchor" href="#reflection-questions-5"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>How is the normal errors linear model written in matrix form?<br>
</li>
<li>Why does the X matrix have an added column of ones?<br>
</li>
<li>Using matrix notation, how are the normal equations used to solve for the least squares estimates of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?<br>
</li>
<li>What is a covariance term? What does it mean for variables to be correlated (e.g., <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>)?<br>
</li>
<li>Why is the “hat” matrix (<span class="math inline">\(H\)</span>) so named?</li>
</ol>
</div>
<div id="ethics-considerations-4" class="section level2" number="8.10">
<h2>
<span class="header-section-number">8.10</span> <i class="fas fa-balance-scale"></i> Ethics Considerations<a class="anchor" aria-label="anchor" href="#ethics-considerations-4"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Why are the sampling distributions of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> correlated?</li>
<li>In what ways does writing the linear model in matrix notation make the extension to more explanatory variables easier?<br>
</li>
<li>Are there any fundamental differences to the SLR model written in matrix notation (as opposed to indexing the elements for each equation)?</li>
</ol>
</div>
<div id="r-matrices" class="section level2" number="8.11">
<h2>
<span class="header-section-number">8.11</span> R: Matrices<a class="anchor" aria-label="anchor" href="#r-matrices"><i class="fas fa-link"></i></a>
</h2>
<div id="addition" class="section level3" number="8.11.1">
<h3>
<span class="header-section-number">8.11.1</span> Addition<a class="anchor" aria-label="anchor" href="#addition"><i class="fas fa-link"></i></a>
</h3>
<p>Adding matrices gives you what you’d likely expect.</p>
<div class="sourceCode" id="cb312"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">matrix2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">24</span>,by<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">4</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span>

<span class="va">matrix1</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12</code></pre>
<div class="sourceCode" id="cb314"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    2    4    6    8
## [2,]   10   12   14   16
## [3,]   18   20   22   24</code></pre>
<div class="sourceCode" id="cb316"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix1</span> <span class="op">+</span> <span class="va">matrix2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    3    6    9   12
## [2,]   15   18   21   24
## [3,]   27   30   33   36</code></pre>
</div>
<div id="multiplication" class="section level3" number="8.11.2">
<h3>
<span class="header-section-number">8.11.2</span> Multiplication<a class="anchor" aria-label="anchor" href="#multiplication"><i class="fas fa-link"></i></a>
</h3>
<p>The <code>*</code> produces element by element multiplication.</p>
<div class="sourceCode" id="cb318"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix1</span> <span class="op">*</span> <span class="va">matrix2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    2    8   18   32
## [2,]   50   72   98  128
## [3,]  162  200  242  288</code></pre>
<p>The <code>%*%</code> does matrix multiplication. Note the error here because you can’t multiply a <span class="math inline">\(3 \times 4\)</span> by a <span class="math inline">\(3 \times4\)</span> matrix.</p>
<div class="sourceCode" id="cb320"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">matrix2</span></code></pre></div>
<pre><code>## Error in matrix1 %*% matrix2: non-conformable arguments</code></pre>
<p>If either of the matrices are transposed, they will be conformable, and we will be able to multiply them.</p>
<div class="sourceCode" id="cb322"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix1</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">matrix2</span><span class="op">)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   60  140  220
## [2,]  140  348  556
## [3,]  220  556  892</code></pre>
<div class="sourceCode" id="cb324"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">matrix1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="va">matrix2</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]  214  244  274  304
## [2,]  244  280  316  352
## [3,]  274  316  358  400
## [4,]  304  352  400  448</code></pre>
<p>Note that the products are only symmetric because <code>matrix1</code> = <span class="math inline">\(2 \cdot\)</span> <code>matrix2</code>.</p>
</div>
<div id="taking-inverses" class="section level3" number="8.11.3">
<h3>
<span class="header-section-number">8.11.3</span> Taking Inverses<a class="anchor" aria-label="anchor" href="#taking-inverses"><i class="fas fa-link"></i></a>
</h3>
<p>The function for inverting matrices in R is <code><a href="https://rdrr.io/r/base/solve.html">solve()</a></code>. Remember that <code><a href="https://rdrr.io/r/base/solve.html">solve()</a></code> can only works on square matrices with non-zero determinants.</p>
<div class="sourceCode" id="cb326"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">3</span>,<span class="fl">6</span>,<span class="fl">2</span>,<span class="fl">0</span>,<span class="fl">8</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">3</span>, byrow<span class="op">=</span><span class="cn">T</span><span class="op">)</span>
<span class="va">matrix3</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    5    7    1
## [2,]    4    3    6
## [3,]    2    0    8</code></pre>
<div class="sourceCode" id="cb328"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">matrix3</span><span class="op">)</span></code></pre></div>
<pre><code>##        [,1]   [,2] [,3]
## [1,] -0.923  2.154 -1.5
## [2,]  0.769 -1.462  1.0
## [3,]  0.231 -0.538  0.5</code></pre>
<p>Multiplying a matrix by its inverse results in the identity matrix.</p>
<div class="sourceCode" id="cb330"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix3</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/solve.html">solve</a></span><span class="op">(</span><span class="va">matrix3</span><span class="op">)</span></code></pre></div>
<pre><code>##          [,1]      [,2]     [,3]
## [1,] 1.00e+00 -2.22e-16 1.11e-16
## [2,] 4.44e-16  1.00e+00 0.00e+00
## [3,] 4.44e-16  0.00e+00 1.00e+00</code></pre>
</div>
<div id="concatenating-1s-for-the-intercept" class="section level3" number="8.11.4">
<h3>
<span class="header-section-number">8.11.4</span> Concatenating 1s for the intercept<a class="anchor" aria-label="anchor" href="#concatenating-1s-for-the-intercept"><i class="fas fa-link"></i></a>
</h3>
<p>Let’s say we have an explanatory variable called <code>xvar</code></p>
<div class="sourceCode" id="cb332"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">7447</span><span class="op">)</span>
<span class="va">xvar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">47</span>, <span class="fl">3</span><span class="op">)</span>
<span class="va">xvar</span></code></pre></div>
<pre><code>##  [1] 47.3 43.1 47.1 48.0 49.7 45.2 47.7 47.1 47.9 48.9 43.4 44.1</code></pre>
<div class="sourceCode" id="cb334"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span>  <span class="co"># repeats the number 1, 12 times</span></code></pre></div>
<pre><code>##  [1] 1 1 1 1 1 1 1 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb336"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Xmatrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>int <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span>, <span class="va">xvar</span><span class="op">)</span>
<span class="va">Xmatrix</span></code></pre></div>
<pre><code>##       int xvar
##  [1,]   1 47.3
##  [2,]   1 43.1
##  [3,]   1 47.1
##  [4,]   1 48.0
##  [5,]   1 49.7
##  [6,]   1 45.2
##  [7,]   1 47.7
##  [8,]   1 47.1
##  [9,]   1 47.9
## [10,]   1 48.9
## [11,]   1 43.4
## [12,]   1 44.1</code></pre>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="simult.html"><span class="header-section-number">7</span> Simultaneous Inference</a></div>
<div class="next"><a href="mlr.html"><span class="header-section-number">9</span> Multiple Linear Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#la"><span class="header-section-number">8</span> Regression using Matrices</a></li>
<li><a class="nav-link" href="#special-matrices"><span class="header-section-number">8.1</span> Special Matrices</a></li>
<li>
<a class="nav-link" href="#regression-model"><span class="header-section-number">8.2</span> Regression Model</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#matrix-addition"><span class="header-section-number">8.2.1</span> Matrix Addition</a></li></ul>
</li>
<li>
<a class="nav-link" href="#matrix-multiplication"><span class="header-section-number">8.3</span> Matrix Multiplication</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#example"><span class="header-section-number">8.3.1</span> Example</a></li></ul>
</li>
<li>
<a class="nav-link" href="#matrix-inverses-in-the-regression-context"><span class="header-section-number">8.4</span> Matrix Inverses in the Regression Context</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#matrix-inverses"><span class="header-section-number">8.4.1</span> Matrix Inverses</a></li>
<li><a class="nav-link" href="#example-5"><span class="header-section-number">8.4.2</span> Example</a></li>
<li><a class="nav-link" href="#variance-of-coefficients"><span class="header-section-number">8.4.3</span> Variance of Coefficients</a></li>
</ul>
</li>
<li><a class="nav-link" href="#fitted-values"><span class="header-section-number">8.5</span> Fitted Values</a></li>
<li><a class="nav-link" href="#residuals-2"><span class="header-section-number">8.6</span> Residuals</a></li>
<li><a class="nav-link" href="#analysis-of-variance"><span class="header-section-number">8.7</span> ANalysis Of VAriance</a></li>
<li><a class="nav-link" href="#prediction-of-new-observations"><span class="header-section-number">8.8</span> Prediction of New Observations</a></li>
<li><a class="nav-link" href="#reflection-questions-5"><span class="header-section-number">8.9</span>  Reflection Questions</a></li>
<li><a class="nav-link" href="#ethics-considerations-4"><span class="header-section-number">8.10</span>  Ethics Considerations</a></li>
<li>
<a class="nav-link" href="#r-matrices"><span class="header-section-number">8.11</span> R: Matrices</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#addition"><span class="header-section-number">8.11.1</span> Addition</a></li>
<li><a class="nav-link" href="#multiplication"><span class="header-section-number">8.11.2</span> Multiplication</a></li>
<li><a class="nav-link" href="#taking-inverses"><span class="header-section-number">8.11.3</span> Taking Inverses</a></li>
<li><a class="nav-link" href="#concatenating-1s-for-the-intercept"><span class="header-section-number">8.11.4</span> Concatenating 1s for the intercept</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/03-la.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/03-la.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Linear Models</strong>" was written by Jo Hardin. It was last built on 2022-02-09.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
