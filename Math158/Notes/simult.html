<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Simultaneous Inference | Linear Models</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="(sections 4.1, 4.2, 4.3 in ALSM) Spring 2022: We will cover joint estimation of \(\beta_0\) and \(\beta_1\), but we will not cover simultaneous estimation of a mean response or simultaneous...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 7 Simultaneous Inference | Linear Models">
<meta property="og:type" content="book">
<meta property="og:description" content="(sections 4.1, 4.2, 4.3 in ALSM) Spring 2022: We will cover joint estimation of \(\beta_0\) and \(\beta_1\), but we will not cover simultaneous estimation of a mean response or simultaneous...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 7 Simultaneous Inference | Linear Models">
<meta name="twitter:description" content="(sections 4.1, 4.2, 4.3 in ALSM) Spring 2022: We will cover joint estimation of \(\beta_0\) and \(\beta_1\), but we will not cover simultaneous estimation of a mean response or simultaneous...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Linear Models</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="wrang.html"><span class="header-section-number">2</span> Data Wrangling</a></li>
<li><a class="" href="viz.html"><span class="header-section-number">3</span> Visualization</a></li>
<li><a class="" href="slr.html"><span class="header-section-number">4</span> Simple Linear Regression</a></li>
<li><a class="" href="infslr.html"><span class="header-section-number">5</span> Inference on SLR Parameters</a></li>
<li><a class="" href="diag1.html"><span class="header-section-number">6</span> Diagnostic Measures I</a></li>
<li><a class="active" href="simult.html"><span class="header-section-number">7</span> Simultaneous Inference</a></li>
<li><a class="" href="la.html"><span class="header-section-number">8</span> Regression using Matrices</a></li>
<li><a class="" href="mlr.html"><span class="header-section-number">9</span> Multiple Linear Regression</a></li>
<li><a class="" href="process.html"><span class="header-section-number">10</span> Modeling as a Process6</a></li>
<li><a class="" href="build.html"><span class="header-section-number">11</span> Statistical Model Building</a></li>
<li><a class="" href="diag2.html"><span class="header-section-number">12</span> Diagnostic Measures II</a></li>
<li><a class="" href="standardized-multiple-regression.html"><span class="header-section-number">13</span> Standardized Multiple Regression</a></li>
<li><a class="" href="shrink.html"><span class="header-section-number">14</span> Shrinkage Methods</a></li>
<li><a class="" href="smooth.html"><span class="header-section-number">15</span> Smoothing Methods</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">16</span> ANOVA</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="simult" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Simultaneous Inference<a class="anchor" aria-label="anchor" href="#simult"><i class="fas fa-link"></i></a>
</h1>
<p>(sections 4.1, 4.2, 4.3 in ALSM)</p>
<p>Spring 2022: We <strong>will</strong> cover joint estimation of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, but we <strong>will not</strong> cover simultaneous estimation of a mean response or simultaneous prediction intervals for new observations.</p>
<div id="joint-estimation-of-beta_0-and-beta_1" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Joint Estimation of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span><a class="anchor" aria-label="anchor" href="#joint-estimation-of-beta_0-and-beta_1"><i class="fas fa-link"></i></a>
</h2>
<p>Note that all the inference on <span class="math inline">\(\beta_1\)</span> can be performed on <span class="math inline">\(\beta_0\)</span> with only slight modifications to the formula for the SE. Although <span class="math inline">\(\beta_1\)</span> is typically more related to the research question at hand, <span class="math inline">\(\beta_0\)</span> can also be informative in its own right. Indeed, if we were interested in CI for either one, we would calculate the following:</p>
<p><span class="math display">\[b_0 \pm t_{(1-\alpha/2), n-2} \cdot s\{b_0\}\]</span>
<span class="math display">\[b_1 \pm t_{(1-\alpha/2), n-2} \cdot s\{b_1\}\]</span></p>
<p>Clearly if we had many parameters and many intervals, we wouldn’t think that they would <em>all</em> cover the true parameters with probability <span class="math inline">\((1-\alpha)\)</span>. To figure out the probability that they all cover their true parameter, let’s define
<span class="math display">\[\begin{eqnarray*}
A_1 &amp;=&amp; \mbox{first CI does not cover } \beta_0\\
P(A_1) &amp;=&amp; \alpha\\
A_2 &amp;=&amp; \mbox{second CI does not cover } \beta_1\\
P(A_2) &amp;=&amp; \alpha\\
\end{eqnarray*}\]</span></p>
<p>We want to bound the probability that all the intervals cover the true parameter.
<span class="math display">\[\begin{eqnarray*}
P(\mbox{all CIs cover}) &amp;=&amp; 1- P(\mbox{at least one CI does not cover})\\
&amp;=&amp; 1 - P( A_1 \mbox{ or } A_2)\\
&amp;&amp;\\
P( A_1 \mbox{ or } A_2) &amp;=&amp; P(A_1) + P(A_2) - P(A_1 \mbox{ and } A_2)\\
&amp;=&amp; \alpha + \alpha - ???\\
&amp; \leq&amp; 2 \alpha \\
P(\mbox{at least one CI does not cover}) &amp;\leq&amp; 2 \alpha\\
P(\mbox{all CIs cover}) &amp;\geq&amp; 1- 2 \alpha\\
\end{eqnarray*}\]</span></p>
<p>Note that if we make two 95% CIs, the Bonferroni inequality tells us that both will cover their respective parameters in 90% of such repeated samples (i.e., with 90% confidence).</p>
<p>With <span class="math inline">\(g\)</span> CIs, letting the multiplier be at a level of significance given by <span class="math inline">\(\alpha/g\)</span> will create familywise confidence intervals with a level of significance of <span class="math inline">\(\alpha\)</span>.</p>
<p>For <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, let <span class="math inline">\(B = t_{(1-\alpha/4), n-2}\)</span>. Then the intervals with <span class="math inline">\(1-\alpha\)</span> familywise confidence limits are:</p>
<p><span class="math display">\[b_0 \pm B \cdot s\{b_0\}\]</span>
<span class="math display">\[b_1 \pm B \cdot s\{b_1\}\]</span></p>
<ul>
<li>Note that interpretations depend heavily on the number of intervals (which is true about most multiple comparison adjustments).<br>
</li>
<li>Bonferroni is extremely conservative, and therefore it has low power.<br>
</li>
<li>Bonferroni easily extends to any number of comparisons.<br>
</li>
<li>Bonferroni can adjust for multiple comparisons even when comparing very different types of analyses (e.g., CI for slope parameter and for a predicted response).</li>
</ul>
</div>
<div id="simultaneous-estimation-of-a-mean-response" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Simultaneous Estimation of a Mean Response<a class="anchor" aria-label="anchor" href="#simultaneous-estimation-of-a-mean-response"><i class="fas fa-link"></i></a>
</h2>
<p>As with the intervals for the parameters, creating intervals for multiple mean responses leads to problems of multiple comparisons. Again, the goal is to adjust the intervals such that the probability of getting a dataset which will lead to intervals covering <em>all</em> mean responses is <span class="math inline">\(1-\alpha\)</span>.</p>
<p>(Note that the reason for simultaneous inference is because the combination of natural sampling variability in <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> could lead to the mean responses being correct for <span class="math inline">\(E[Y_h]\)</span> over some range of <span class="math inline">\(x\)</span> values and incorrect for a different range of <span class="math inline">\(x\)</span> values.)</p>
<div id="working-hotelling-procedure" class="section level3 unnumbered">
<h3>Working-Hotelling Procedure<a class="anchor" aria-label="anchor" href="#working-hotelling-procedure"><i class="fas fa-link"></i></a>
</h3>
<p>The Working-Hotelling procedure gives a confidence band for the entire range of <span class="math inline">\(x\)</span> values. The family confidence interval for the simultaneous intervals is <span class="math inline">\(1-\alpha\)</span>. Note that the multiplier is determined to bound the entire line over the complete range of <span class="math inline">\(x\)</span> values.</p>
<p><span class="math display">\[\hat{y}_h \pm W s \{ \hat{y}_h \}\]</span>
where <span class="math inline">\(W^2 = 2 F_{(1-\alpha; 2, n-2)}\)</span>.</p>
</div>
<div id="bonferroni-procedure" class="section level3 unnumbered">
<h3>Bonferroni Procedure<a class="anchor" aria-label="anchor" href="#bonferroni-procedure"><i class="fas fa-link"></i></a>
</h3>
<p>We could have also produced Bonferroni intervals, but those would have been determined using the number <span class="math inline">\(g\)</span> of intervals of interest (as opposed to Working-Hotelling which cover the entire range of <span class="math inline">\(x\)</span> values).</p>
<p><span class="math display">\[\hat{y}_h \pm B \cdot s \{ \hat{y}_h \}\]</span>
where <span class="math inline">\(B = t_{(1-\alpha/2g; n-2)}\)</span>.</p>
</div>
</div>
<div id="simultaneous-prediction-intervals-for-new-observations" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Simultaneous Prediction Intervals for New Observations<a class="anchor" aria-label="anchor" href="#simultaneous-prediction-intervals-for-new-observations"><i class="fas fa-link"></i></a>
</h2>
<p>Just as with estimating the mean response, the interval for predicting new observations can be adjusted so that the total range of observations are contained in the appropriate intervals with probability <span class="math inline">\(1-\alpha\)</span>. For prediction intervals, it is necessary to specify the number <span class="math inline">\(g\)</span> intervals of interest.</p>
<div id="scheffé-procedure" class="section level3 unnumbered">
<h3>Scheffé Procedure<a class="anchor" aria-label="anchor" href="#scheff%C3%A9-procedure"><i class="fas fa-link"></i></a>
</h3>
<p>The Scheffé procedure gives a confidence band for a set of <span class="math inline">\(x\)</span> values, <span class="math inline">\(g\)</span> of them. Using the Scheffé procedure, the family confidence interval for the simultaneous intervals is <span class="math inline">\(1-\alpha\)</span>.</p>
<p><span class="math display">\[\hat{y}_h \pm S \cdot s \{ \mbox{pred} \}\]</span>
where <span class="math inline">\(S^2 = g F_{(1-\alpha; g, n-2)}\)</span>.</p>
</div>
<div id="bonferroni-procedure-1" class="section level3 unnumbered">
<h3>Bonferroni Procedure<a class="anchor" aria-label="anchor" href="#bonferroni-procedure-1"><i class="fas fa-link"></i></a>
</h3>
<p>We could have also produced Bonferroni intervals, but those would have been determined using the number <span class="math inline">\(g\)</span> of intervals of interest (as opposed to Working-Hotelling which cover the entire range of <span class="math inline">\(x\)</span> values).</p>
<p><span class="math display">\[\hat{y}_h \pm B s \{ \mbox{pred} \}\]</span>
where <span class="math inline">\(B = t_{(1-\alpha/2g; n-2)}\)</span>.</p>
</div>
</div>
<div id="more" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> More<a class="anchor" aria-label="anchor" href="#more"><i class="fas fa-link"></i></a>
</h2>
<p>Note that ALSM sections 4.6 (Inverse Predictions) and 4.7 (Choice of <span class="math inline">\(x\)</span> values) provide additional information into good model building. The sections are worth reading on your own.</p>
</div>
<div id="reflection-questions-4" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> <i class="fas fa-lightbulb" target="_blank"></i> Reflection Questions<a class="anchor" aria-label="anchor" href="#reflection-questions-4"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Why do simultaneous CIs worry us (from an error perspective)?<br>
</li>
<li>What is the difference between Bonferroni, Working-Hotelling, and Scheffé adjustments?<br>
</li>
<li>When are Bonferroni intervals larger than the other two? When are they smaller?<br>
</li>
<li>Why do we say the Bonferroni procedure is more general than other multiple comparisons procedures?<br>
</li>
<li>If <span class="math inline">\(g\)</span> is very large, why is the Working-Hotelling procedure preferred to the Bonferroni?</li>
</ol>
</div>
<div id="ethics-considerations-3" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> <i class="fas fa-balance-scale"></i> Ethics Considerations<a class="anchor" aria-label="anchor" href="#ethics-considerations-3"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Why are interval estimates often more valuable to report than p-values?<br>
</li>
<li>What does it mean for one of the adjustments to be “conservative?”</li>
<li>If the sample is not representative of the population, how can an interval estimate be misleading?</li>
<li>What words can be used to distinguish mean confidence intervals from individual prediction intervals in order for better communication of results?</li>
</ol>
<div id="r-simultaneous-inference" class="section level3" number="7.6.1">
<h3>
<span class="header-section-number">7.6.1</span> R: Simultaneous inference<a class="anchor" aria-label="anchor" href="#r-simultaneous-inference"><i class="fas fa-link"></i></a>
</h3>
<p>There are R packages that will do simultaneous inference automatically. However, for the purposes of what we are covering, we’ll focus only on changing the multiplier in order to control the type I error rate.</p>
<p>Consider the regression on the <code>ames</code> housing data. We regression <code>ln_price</code> on <code>area</code> of the home (in sqft). See the full analysis in section @ref{ames-inf}.</p>
<div class="sourceCode" id="cb298"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames_lm</span> <span class="op">&lt;-</span> <span class="va">ames_inf</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">price_ln</span> <span class="op">~</span> <span class="va">area</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> 

<span class="va">ames_lm</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term         estimate std.error statistic p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
## 1 (Intercept) 11.1      0.0177        628.        0
## 2 area         0.000614 0.0000114      53.9       0</code></pre>
<div class="sourceCode" id="cb300"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames_lm</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/generics/man/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.500         0.500 0.284     2901.       0     1  -461.  928.  946.
## # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb302"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames_df</span> <span class="op">&lt;-</span> <span class="va">ames_lm</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/generics/man/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">df.residual</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/pull.html">pull</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">ames_df</span></code></pre></div>
<pre><code>## [1] 2902</code></pre>
<p>Let’s say that we want CI for both the intercept and the slope parameters. In that case, two intervals are created. Bonferroni controls the type I error by dividing the alpha error by the number of intervals. So the multiplier is a t value with the adjusted alpha level and degrees of freedom from the linear model (<code>n-2</code>).</p>
<div class="sourceCode" id="cb304"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">num_int_param</span> <span class="op">&lt;-</span> <span class="fl">2</span>  <span class="co"># for beta0 and beta1</span>

<span class="co"># Bonferroni:</span>
<span class="va">crit_Bonf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/TDist.html">qt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="fl">.975</span><span class="op">)</span><span class="op">/</span><span class="va">num_int_param</span>, <span class="va">ames_df</span><span class="op">)</span>
<span class="va">crit_Bonf</span></code></pre></div>
<pre><code>## [1] -2.24</code></pre>
<p>The intervals can then be created directly from the output of the <code><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy()</a></code> function.</p>
<div class="sourceCode" id="cb306"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ames_lm</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">term</span>, <span class="va">estimate</span>, <span class="va">std.error</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>lower.ci <span class="op">=</span> <span class="va">estimate</span> <span class="op">+</span> <span class="va">crit_Bonf</span><span class="op">*</span><span class="va">std.error</span>,
         upper.ci <span class="op">=</span> <span class="va">estimate</span> <span class="op">-</span> <span class="va">crit_Bonf</span><span class="op">*</span><span class="va">std.error</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term         estimate std.error  lower.ci  upper.ci
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept) 11.1      0.0177    11.1      11.1     
## 2 area         0.000614 0.0000114  0.000588  0.000639</code></pre>
<p>Similarly, the intervals for mean response (confidence interval) and individual response (prediction interval) use the appropriate standard errors and a new multiplier. Below is the code for the Working-Hotelling multiplier and the Scheffe multiplier, both for 10 new observations.</p>
<div class="sourceCode" id="cb308"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Working-Hotelling</span>
<span class="va">crit_WH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">qf</a></span><span class="op">(</span><span class="fl">.95</span>, <span class="fl">2</span>, <span class="va">ames_df</span><span class="op">)</span><span class="op">)</span>
<span class="va">crit_WH</span></code></pre></div>
<pre><code>## [1] 2.45</code></pre>
<div class="sourceCode" id="cb310"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Scheffe</span>
<span class="va">num_int_pred</span> <span class="op">&lt;-</span> <span class="fl">10</span> <span class="co"># if 10 new observations for prediction</span>
<span class="va">crit_Sch</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">num_int_pred</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Fdist.html">qf</a></span><span class="op">(</span><span class="fl">0.95</span>, <span class="va">num_int_pred</span>, <span class="va">ames_df</span><span class="op">)</span><span class="op">)</span>
<span class="va">crit_Sch</span></code></pre></div>
<pre><code>## [1] 4.28</code></pre>

</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="diag1.html"><span class="header-section-number">6</span> Diagnostic Measures I</a></div>
<div class="next"><a href="la.html"><span class="header-section-number">8</span> Regression using Matrices</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#simult"><span class="header-section-number">7</span> Simultaneous Inference</a></li>
<li><a class="nav-link" href="#joint-estimation-of-beta_0-and-beta_1"><span class="header-section-number">7.1</span> Joint Estimation of \(\beta_0\) and \(\beta_1\)</a></li>
<li>
<a class="nav-link" href="#simultaneous-estimation-of-a-mean-response"><span class="header-section-number">7.2</span> Simultaneous Estimation of a Mean Response</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#working-hotelling-procedure">Working-Hotelling Procedure</a></li>
<li><a class="nav-link" href="#bonferroni-procedure">Bonferroni Procedure</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#simultaneous-prediction-intervals-for-new-observations"><span class="header-section-number">7.3</span> Simultaneous Prediction Intervals for New Observations</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#scheff%C3%A9-procedure">Scheffé Procedure</a></li>
<li><a class="nav-link" href="#bonferroni-procedure-1">Bonferroni Procedure</a></li>
</ul>
</li>
<li><a class="nav-link" href="#more"><span class="header-section-number">7.4</span> More</a></li>
<li><a class="nav-link" href="#reflection-questions-4"><span class="header-section-number">7.5</span>  Reflection Questions</a></li>
<li>
<a class="nav-link" href="#ethics-considerations-3"><span class="header-section-number">7.6</span>  Ethics Considerations</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#r-simultaneous-inference"><span class="header-section-number">7.6.1</span> R: Simultaneous inference</a></li></ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/02c-simul.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/02c-simul.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Linear Models</strong>" was written by Jo Hardin. It was last built on 2022-05-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
