<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Visualization | Linear Models</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="Data visualization is integral to understanding both data and models. Computational statistics and data science sometimes focus on models or resulting predictions from the models. But there is no...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Visualization | Linear Models">
<meta property="og:type" content="book">
<meta property="og:description" content="Data visualization is integral to understanding both data and models. Computational statistics and data science sometimes focus on models or resulting predictions from the models. But there is no...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Visualization | Linear Models">
<meta name="twitter:description" content="Data visualization is integral to understanding both data and models. Computational statistics and data science sometimes focus on models or resulting predictions from the models. But there is no...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Linear Models</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="wrang.html"><span class="header-section-number">2</span> Data Wrangling</a></li>
<li><a class="active" href="viz.html"><span class="header-section-number">3</span> Visualization</a></li>
<li><a class="" href="slr.html"><span class="header-section-number">4</span> Simple Linear Regression</a></li>
<li><a class="" href="infslr.html"><span class="header-section-number">5</span> Inference on SLR Parameters</a></li>
<li><a class="" href="diag1.html"><span class="header-section-number">6</span> Diagnostic Measures I</a></li>
<li><a class="" href="simult.html"><span class="header-section-number">7</span> Simultaneous Inference</a></li>
<li><a class="" href="la.html"><span class="header-section-number">8</span> Regression using Matrices</a></li>
<li><a class="" href="mlr.html"><span class="header-section-number">9</span> Multiple Linear Regression</a></li>
<li><a class="" href="process.html"><span class="header-section-number">10</span> Modeling as a Process6</a></li>
<li><a class="" href="build.html"><span class="header-section-number">11</span> Model Building</a></li>
<li><a class="" href="analysis-of-variance-anova.html"><span class="header-section-number">12</span> Analysis of variance (ANOVA)</a></li>
<li><a class="" href="diag2.html"><span class="header-section-number">13</span> Diagnostics II</a></li>
<li><a class="" href="shrink.html"><span class="header-section-number">14</span> Shrinkage Methods</a></li>
<li><a class="" href="smooth.html"><span class="header-section-number">15</span> Smoothing Methods</a></li>
<li><a class="" href="anova.html"><span class="header-section-number">16</span> ANOVA</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="viz" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Visualization<a class="anchor" aria-label="anchor" href="#viz"><i class="fas fa-link"></i></a>
</h1>
<p>Data visualization is integral to understanding both data and models. Computational statistics and data science sometimes focus on models or resulting predictions from the models. But there is no doubt that the structure and format of the data are the key to whether or not a model is appropriate or good. A good data analyst will always spend a lot of time and effort on exploratory data analysis, much of which includes making as many visualizations of the data as possible.</p>
<p>Depending on the introductory (or other) statistics classes you’ve had, your instructor may have focused more or less on visualizations in class. They (I) may have even said something like <em>making visualizations are incredibly important to the entire data analysis process.</em> But even if you buy the perspective, why is it that we don’t see more good graphics in our analyses? Andrew Gelman <span class="citation">(<a href="references.html#ref-Gelman11" role="doc-biblioref">Gelman 2011</a>)</span> responds by stating, “Good statistical graphics are hard to do, much harder than running regressions and making tables.” <strong>Our goal will be to create graphics and visualizations that convey statistical information.</strong></p>
<p>Nolan <span class="citation">(<a href="references.html#ref-Nolan16" role="doc-biblioref">Nolan and Perrett 2016</a>)</span> describes three important ways that graphics can be used to convey statistical information. The “guiding principles” will be used as a way of evaluating others’ figures as well as a metric for creating our own visualizations to help with statistical analysis.</p>
<ol style="list-style-type: decimal">
<li><em>Make the data stand out</em></li>
</ol>
<p>The important idea here is to find anything unusual in the data. Are there patterns? Outliers? What are the bounds of the variables? How should the axes be scaled? Are transformations warranted?</p>
<ol start="2" style="list-style-type: decimal">
<li><em>Facilitate comparison</em></li>
</ol>
<p>The second item allows us to consider the research questions at hand. What are the important variables? How do we emphasize them? Which variables should be plotted together? Can they be super-imposed? Does color, plotting character, size of plot character help to bring out the important relationships? Be aware of over plotting and issues of color blindness. <a href="http://colorbrewer2.org/" class="uri">http://colorbrewer2.org/</a></p>
<ol start="3" style="list-style-type: decimal">
<li><em>Add information</em></li>
</ol>
<p>Plots should also add context to the comparison. Figure legends, axes scales, and reference markers (e.g., a line at <span class="math inline">\(y=x\)</span>) go a long way toward helping the reader understand your message. Captions should be self-contained (and not assume the user has also read your text) and descriptive; they should summarize the content of the figure and the conclusion related to the message you want to convey.</p>
<p>Randy Pruim asks the following question to decide whether or not a plot is good: <em>Does my plot make the comparisons I am interested in…</em></p>
<ul>
<li>easily? and</li>
<li>accurately?</li>
</ul>
<p>Consider adding alt text to allow screen readers to parse the image. The DataViz Society/Nightingale by way of Amy Cesal has an article on writing good alt text for plots/graphs, <a href="https://medium.com/nightingale/writing-alt-text-for-data-visualization-2a218ef43f81" target="_blank">Writing Alt Text for Data Visualization</a>.</p>
<div id="thoughts" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Thoughts on Plotting<a class="anchor" aria-label="anchor" href="#thoughts"><i class="fas fa-link"></i></a>
</h2>
<div id="advice" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Advice<a class="anchor" aria-label="anchor" href="#advice"><i class="fas fa-link"></i></a>
</h3>
<ul>
<li>Basic plotting
<ul>
<li>Avoid having other graph elements interfere with data</li>
<li>Use visually prominent symbols</li>
<li>Avoid over-plotting (One way to avoid over plotting: Jitter the values)</li>
<li>Different values of data may obscure each other</li>
<li>Include all or nearly all of the data</li>
<li>Fill data region</li>
</ul>
</li>
<li>Eliminate superfluous material
<ul>
<li>Chart junk &amp; stuff that adds no meaning, e.g. butterflies on top of barplots, background images</li>
<li>Extra tick marks and grid lines</li>
<li>Unnecessary text and arrows</li>
<li>Decimal places beyond the measurement error or the level of difference</li>
</ul>
</li>
<li>Facilitate Comparisons
<ul>
<li>Put juxtaposed plots on same scale</li>
<li>Make it easy to distinguish elements of superposed plots (e.g. color)</li>
<li>Emphasizes the important difference</li>
<li>Comparison: volume, area, height (be careful, volume can seem bigger than you mean it to)</li>
</ul>
</li>
<li>Choosing the Scale (n.b., some of the principles may go counter to one another, use your judgment.)
<ul>
<li>Keep scales on x and y axes the same for both plots to facilitate the comparison</li>
<li>Zoom in to focus on the region that contains the bulk of the data</li>
<li>Keep the scale the same throughout the plot (i.e. don’t change it mid-axis)</li>
<li>Origin need not be on the scale</li>
<li>Choose a scale that improves resolution</li>
<li>Avoid jiggling the baseline</li>
</ul>
</li>
<li>How to make a plot information rich
<ul>
<li>Describe what you see in the caption</li>
<li>Add context with reference markers (lines and points) including text</li>
<li>Add legends and labels</li>
<li>Use color and plotting symbols to add more information</li>
<li>Plot the same thing more than once in different ways/scales</li>
<li>Reduce clutter</li>
</ul>
</li>
<li>Captions should
<ul>
<li>Be comprehensive</li>
<li>Self-contained</li>
<li>Describe what has been graphed</li>
<li>Draw attention to important features</li>
<li>Describe conclusions drawn from graph</li>
</ul>
</li>
<li>Good Plot Making Practice
<ul>
<li>Put major conclusions in graphical form</li>
<li>Provide reference information</li>
<li>Proof read for clarity and consistency</li>
<li>Graphing is an iterative process</li>
<li>Multiplicity is OK, i.e. two plots of the same variable may provide different messages</li>
<li>Make plots data rich</li>
</ul>
</li>
</ul>
<p>Creating a statistical graphic is an iterative process of discovery and fine tuning. We try to model the process of creating visualizations in the course by dedicating class time to an iterative creation of a plot. We begin either with a plot that screams for correction, and we transform it step-by-step, always thinking about the goal of a graph that is data rich and presents a clear vision of the important features of the data.</p>
<div id="fonts-matter" class="section level4" number="3.1.1.1">
<h4>
<span class="header-section-number">3.1.1.1</span> Fonts Matter<a class="anchor" aria-label="anchor" href="#fonts-matter"><i class="fas fa-link"></i></a>
</h4>
<p>At RStudio::conf 2020, <a href="https://rstudio.com/resources/rstudioconf-2020/the-glamour-of-graphics/">The Glamour of Graphics</a>, Will Chase makes some very important points about how and why making good graphics matters. The talk might be summarized by the plot below: fonts matter.</p>
<div class="inline-figure"><img src="figs/fontsmatter.png" width="500px" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="deconstruct" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Deconstructing a graph<a class="anchor" aria-label="anchor" href="#deconstruct"><i class="fas fa-link"></i></a>
</h2>
<div id="gg" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> The Grammar of Graphics (<code>gg</code>)<a class="anchor" aria-label="anchor" href="#gg"><i class="fas fa-link"></i></a>
</h3>
<p><span class="citation"><a href="references.html#ref-Yau" role="doc-biblioref">Yau</a> (<a href="references.html#ref-Yau" role="doc-biblioref">2013</a>)</span> and <span class="citation"><a href="references.html#ref-Wickham14" role="doc-biblioref">Wickham</a> (<a href="references.html#ref-Wickham14" role="doc-biblioref">2014</a>)</span> have come up with a <em>taxonomy</em> and a <em>grammar</em> for thinking about the parts of a figure just like we conceptualize the parts of a body or the parts of a sentence.</p>
<p>One great way of thinking of the new process: it is not longer necessary to talk about the name of the graph (e.g., boxplot). Instead we now think in glyphs (geoms), and so we can put whatever we want on the plot. Note also that the transition leads you from a passive consumer (I need to make plot XXX because everyone else does, so I just plug in the data) into an active participant (what do I want my data to say? and how can I put that information onto my graphic?)</p>
<p>The most important questions you can ask with respect to creating figures are:</p>
<ol style="list-style-type: decimal">
<li>What do we want R to do? (What is the goal?)</li>
<li>What does R need to know?</li>
</ol>
<p><span class="citation"><a href="references.html#ref-Yau" role="doc-biblioref">Yau</a> (<a href="references.html#ref-Yau" role="doc-biblioref">2013</a>)</span> gives us nine visual cues, and <span class="citation"><a href="references.html#ref-Wickham14" role="doc-biblioref">Wickham</a> (<a href="references.html#ref-Wickham14" role="doc-biblioref">2014</a>)</span> translates them into a language using <code>ggplot2</code>. (The items below are from <span class="citation"><a href="references.html#ref-MDSR" role="doc-biblioref">Baumer, Kaplan, and Horton</a> (<a href="references.html#ref-MDSR" role="doc-biblioref">2021</a>)</span>, chapter 2.)</p>
<ol style="list-style-type: decimal">
<li><p>Visual Cues: the aspects of the figure where we should focus.<br><strong>Position</strong> (numerical) where in relation to other things?<br><strong>Length</strong> (numerical) how big (in one dimension)?<br><strong>Angle</strong> (numerical) how wide? parallel to something else?<br><strong>Direction</strong> (numerical) at what slope? In a time series, going up or down?<br><strong>Shape</strong> (categorical) belonging to what group?<br><strong>Area</strong> (numerical) how big (in two dimensions)? Beware of improper scaling!<br><strong>Volume</strong> (numerical) how big (in three dimensions)? Beware of improper scaling!<br><strong>Shade</strong> (either) to what extent? how severely?<br><strong>Color</strong> (either) to what extent? how severely? Beware of red/green color blindness.</p></li>
<li><p>Coordinate System: rectangular, polar, geographic, etc.</p></li>
<li><p>Scale: numeric (linear? logarithmic?), categorical (ordered?), time</p></li>
<li><p>Context: in comparison to what (think back to ideas from Tufte)</p></li>
</ol>
<div class="inline-figure"><img src="figs/Yau_viz_cues.png" width="100%" style="display: block; margin: auto;"></div>
<div id="order-matters" class="section level4 unnumbered">
<h4>Order Matters<a class="anchor" aria-label="anchor" href="#order-matters"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-figure"><img src="figs/Yau_order.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="cues-together" class="section level4 unnumbered">
<h4>Cues Together<a class="anchor" aria-label="anchor" href="#cues-together"><i class="fas fa-link"></i></a>
</h4>
<div class="inline-figure"><img src="figs/Yau_cuestogether.png" width="100%" style="display: block; margin: auto;"></div>
<div id="what-are-the-visual-cues-on-the-plot" class="section level5 unnumbered">
<h5>What are the visual cues on the plot?<a class="anchor" aria-label="anchor" href="#what-are-the-visual-cues-on-the-plot"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>position?</li>
<li>length?</li>
<li>shape?</li>
<li>area/volume?</li>
<li>shade/color?</li>
<li>coordinate System?<br>
</li>
<li>scale?</li>
</ul>
</div>
<div id="what-are-the-visual-cues-on-the-plot-1" class="section level5 unnumbered">
<h5>What are the visual cues on the plot?<a class="anchor" aria-label="anchor" href="#what-are-the-visual-cues-on-the-plot-1"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>position?</li>
<li>length?</li>
<li>shape?</li>
<li>area/volume?</li>
<li>shade/color?</li>
<li>coordinate System?<br>
</li>
<li>scale?</li>
</ul>
</div>
<div id="what-are-the-visual-cues-on-the-plot-2" class="section level5 unnumbered">
<h5>What are the visual cues on the plot?<a class="anchor" aria-label="anchor" href="#what-are-the-visual-cues-on-the-plot-2"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>position?</li>
<li>length?</li>
<li>shape?</li>
<li>area/volume?</li>
<li>shade/color?</li>
<li>coordinate System?<br>
</li>
<li>scale?</li>
</ul>
</div>
</div>
<div id="the-grammar-of-graphics-in-ggplot2" class="section level4" number="3.2.1.1">
<h4>
<span class="header-section-number">3.2.1.1</span> The grammar of graphics in <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#the-grammar-of-graphics-in-ggplot2"><i class="fas fa-link"></i></a>
</h4>
<p><strong>geom</strong>: the geometric “shape” used to display data</p>
<ul>
<li>bar, point, line, ribbon, text, etc.</li>
</ul>
<p><strong>aesthetic</strong>: an attribute controlling how geom is displayed with respect to variables</p>
<ul>
<li>x position, y position, color, fill, shape, size, etc.</li>
</ul>
<p><strong>scale</strong>: adjust information in the aesthetic to map onto the plot</p>
<ul>
<li>
<em>particular</em> assignment of colors, shapes, sizes, etc.; making axes continuous or constrained to a particular range of values.</li>
</ul>
<p><strong>guide</strong>: helps user convert visual data back into raw data (legends, axes)</p>
<p><strong>stat</strong>: a transformation applied to data before geom gets it</p>
<ul>
<li>example: histograms work on binned data</li>
</ul>
</div>
</div>
<div id="ggplot2" class="section level3" number="3.2.2">
<h3>
<span class="header-section-number">3.2.2</span> <code>ggplot2</code><a class="anchor" aria-label="anchor" href="#ggplot2"><i class="fas fa-link"></i></a>
</h3>
<p>In <code>ggplot2</code>, an <em>aesthetic</em> refers to a mapping between a variable and the information it conveys on the plot. Further information about plotting and visualizing information is given in chapter 2 (Data visualization) of <span class="citation"><a href="references.html#ref-MDSR" role="doc-biblioref">Baumer, Kaplan, and Horton</a> (<a href="references.html#ref-MDSR" role="doc-biblioref">2021</a>)</span>. Much of the data in the presentation represents all births from 1978 in the US: the date, the day of the year, and the number of births.</p>
<!---
%Things to talk about:
%layers 
%facets 
%tidy data 
%scale: the computer maps the data to the aesthetic (computer doing the work) 
%guide: the aesthetic gets mapped back to the data (the human interpreting the graph) 
%frame: the variables that define the space (e.g., x & y coordinates and faceting) 
--->
<div id="goals" class="section level5 unnumbered">
<h5>Goals<a class="anchor" aria-label="anchor" href="#goals"><i class="fas fa-link"></i></a>
</h5>
<p>What I will try to do</p>
<ul>
<li><p>give a tour of <code>ggplot2</code></p></li>
<li><p>explain how to think about plots the <code>ggplot2</code> way</p></li>
<li><p>prepare/encourage you to learn more later</p></li>
</ul>
<p>What I can’t do in one session</p>
<ul>
<li><p>show every bell and whistle</p></li>
<li><p>make you an expert at using <code>ggplot2</code></p></li>
</ul>
</div>
<div id="getting-help" class="section level5 unnumbered">
<h5>Getting help<a class="anchor" aria-label="anchor" href="#getting-help"><i class="fas fa-link"></i></a>
</h5>
<ol style="list-style-type: decimal">
<li><p>One of the best ways to get started with ggplot is to google what you want to do with the word ggplot. Then look through the images that come up. More often than not, the associated code is there. There are also ggplot galleries of images, one of them is here: <a href="https://plot.ly/ggplot2/" class="uri">https://plot.ly/ggplot2/</a></p></li>
<li><p><code>ggplot2</code> cheat sheet: <a href="https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf</a></p></li>
<li><p>Look at the end of the presentation. More help options there.</p></li>
</ol>
<div class="inline-figure"><img src="figs/plotly.png" width="476" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb187"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ProjectMOSAIC/mosaic">mosaic</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span> <span class="co"># package for working with dates</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Births78</span><span class="op">)</span>     <span class="co"># restore fresh version of Births78</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">Births78</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##         date births wday year month day_of_year day_of_month day_of_week
## 1 1978-01-01   7701  Sun 1978     1           1            1           1
## 2 1978-01-02   7527  Mon 1978     1           2            2           2
## 3 1978-01-03   8825  Tue 1978     1           3            3           3</code></pre>
</div>
<div id="how-can-we-make-the-plot" class="section level5 unnumbered">
<h5>How can we make the plot?<a class="anchor" aria-label="anchor" href="#how-can-we-make-the-plot"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Two Questions:</p>
<ol style="list-style-type: decimal">
<li><p>What do we want R to do? (What is the goal?)</p></li>
<li>
<p>What does R need to know?</p>
<ul>
<li><p>data source: <code>Births78</code></p></li>
<li>
<p>aesthetics:</p>
<ul>
<li><code>date -&gt; x</code></li>
<li><code>births -&gt; y</code></li>
<li>points (!)</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Goal: scatterplot = a plot with points</p>
<ul>
<li><code>ggplot() + geom_point()</code></li>
</ul>
</li>
<li>
<p>What does R need to know?</p>
<ul>
<li><p>data source: <code>data = Births78</code></p></li>
<li><p>aesthetics: <code>aes(x = date, y = births)</code></p></li>
</ul>
</li>
</ol>
</div>
<div id="how-can-we-make-the-plot-1" class="section level5 unnumbered">
<h5>How can we make the plot?<a class="anchor" aria-label="anchor" href="#how-can-we-make-the-plot-1"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;"></div>
<p>What has changed?</p>
<ul>
<li>new aesthetic: mapping color to day of week</li>
</ul>
</div>
<div id="adding-day-of-week-to-the-data-set" class="section level5 unnumbered">
<h5>Adding day of week to the data set<a class="anchor" aria-label="anchor" href="#adding-day-of-week-to-the-data-set"><i class="fas fa-link"></i></a>
</h5>
<p>The <code><a href="https://rdrr.io/pkg/lubridate/man/day.html">wday()</a></code> function in the <code>lubridate</code> package computes the day of the week from a date.</p>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Births78</span> <span class="op">&lt;-</span>  
  <span class="va">Births78</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/dplyr/man/mutate.html">mutate</a></span><span class="op">(</span>wday <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/lubridate/man/day.html">wday</a></span><span class="op">(</span><span class="va">date</span>, label<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb190"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">Births78</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span>, color<span class="op">=</span><span class="va">wday</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="how-can-we-make-the-plot-2" class="section level5 unnumbered">
<h5>How can we make the plot?<a class="anchor" aria-label="anchor" href="#how-can-we-make-the-plot-2"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Now we use lines instead of dots</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">Births78</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span>, color<span class="op">=</span><span class="va">wday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
</div>
<div id="how-can-we-make-the-plot-3" class="section level5 unnumbered">
<h5>How can we make the plot?<a class="anchor" aria-label="anchor" href="#how-can-we-make-the-plot-3"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Now we have two <strong>layers</strong>, one with points and one with
lines</p>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">Births78</span>, 
       <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span>, color<span class="op">=</span><span class="va">wday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<ul>
<li><p>The layers are placed one on top of the other: the points
are <em>below</em> and the lines are <em>above</em>.</p></li>
<li><p><code>data</code> and <code>aes</code> specified in <code><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot()</a></code> affect all geoms</p></li>
</ul>
</div>
<div id="alternative-syntax" class="section level5 unnumbered">
<h5>Alternative Syntax<a class="anchor" aria-label="anchor" href="#alternative-syntax"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Births78</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span>, color<span class="op">=</span><span class="va">wday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-19-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="what-does-adding-the-color-argument-do" class="section level5 unnumbered">
<h5>What does adding the color argument do?<a class="anchor" aria-label="anchor" href="#what-does-adding-the-color-argument-do"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Births78</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span>, color<span class="op">=</span><span class="st">"navy"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-21-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Because there is no variable, we have <em>mapped</em> the color aesthetic to a new variable with only one value (“navy”). So all the dots get set to the same color, but it’s not navy.</p>
</div>
<div id="setting-vs.-mapping" class="section level5 unnumbered">
<h5>Setting vs. Mapping<a class="anchor" aria-label="anchor" href="#setting-vs.-mapping"><i class="fas fa-link"></i></a>
</h5>
<p>If we want to <em>set</em> the color to be navy for all of the dots, we do it outside the aesthetic, without a dataset variable:</p>
<div class="sourceCode" id="cb195"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Births78</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>   <span class="co"># map x &amp; y </span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"navy"</span><span class="op">)</span>   <span class="op">+</span>     <span class="co"># set color</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-22-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>Note that <code>color = "navy"</code> is now outside of the aesthetics list. That’s how <code>ggplot2</code> distinguishes between mapping and setting.</li>
</ul>
</div>
<div id="how-can-we-make-the-plot-4" class="section level5 unnumbered">
<h5>How can we make the plot?<a class="anchor" aria-label="anchor" href="#how-can-we-make-the-plot-4"><i class="fas fa-link"></i></a>
</h5>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-23-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Births78</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">wday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>       <span class="co"># map color here</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"navy"</span><span class="op">)</span> <span class="op">+</span>          <span class="co"># set color here</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<ul>
<li><p><code><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot()</a></code> establishes the default data and aesthetics for the geoms, but each geom may change the defaults.</p></li>
<li><p>good practice: put into <code><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot()</a></code> the things that affect all (or most) of the layers; rest in <code>geom_blah()</code></p></li>
</ul>
</div>
<div id="setting-vs.-mapping-again" class="section level5 unnumbered">
<h5>Setting vs. Mapping (again)<a class="anchor" aria-label="anchor" href="#setting-vs.-mapping-again"><i class="fas fa-link"></i></a>
</h5>
<p>Information gets passed to the plot via:</p>
<ol style="list-style-type: lower-alpha">
<li><p><code>map</code> the <strong>variable</strong> information inside the aes (aesthetic) command</p></li>
<li><p><code>set</code> the <strong>non-variable</strong> information outside the aes (aesthetic) command</p></li>
</ol>
</div>
<div id="other-geoms" class="section level5 unnumbered">
<h5>Other geoms<a class="anchor" aria-label="anchor" href="#other-geoms"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/apropos.html">apropos</a></span><span class="op">(</span><span class="st">"^geom_"</span><span class="op">)</span></code></pre></div>
<pre><code> [1] "geom_abline"                  "geom_area"                   
 [3] "geom_ash"                     "geom_bar"                    
 [5] "geom_barh"                    "geom_bin_2d"                 
 [7] "geom_bin2d"                   "geom_blank"                  
 [9] "geom_boxplot"                 "geom_boxploth"               
[11] "geom_col"                     "geom_colh"                   
[13] "geom_contour"                 "geom_contour_filled"         
[15] "geom_count"                   "geom_crossbar"               
[17] "geom_crossbarh"               "geom_curve"                  
[19] "geom_density"                 "geom_density_2d"             
[21] "geom_density_2d_filled"       "geom_density_line"           
[23] "geom_density_ridges"          "geom_density_ridges_gradient"
[25] "geom_density_ridges2"         "geom_density2d"              
[27] "geom_density2d_filled"        "geom_dotplot"                
[29] "geom_errorbar"                "geom_errorbarh"              
[31] "geom_errorbarh"               "geom_freqpoly"               
[33] "geom_function"                "geom_hex"                    
[35] "geom_histogram"               "geom_histogramh"             
[37] "geom_hline"                   "geom_jitter"                 
[39] "geom_label"                   "geom_line"                   
[41] "geom_linerange"               "geom_linerangeh"             
[43] "geom_lm"                      "geom_map"                    
[45] "geom_path"                    "geom_point"                  
[47] "geom_pointrange"              "geom_pointrangeh"            
[49] "geom_polygon"                 "geom_qq"                     
[51] "geom_qq_line"                 "geom_quantile"               
[53] "geom_raster"                  "geom_rect"                   
[55] "geom_ribbon"                  "geom_ridgeline"              
[57] "geom_ridgeline_gradient"      "geom_rug"                    
[59] "geom_segment"                 "geom_sf"                     
[61] "geom_sf_label"                "geom_sf_text"                
[63] "geom_sina"                    "geom_smooth"                 
[65] "geom_spline"                  "geom_spoke"                  
[67] "geom_step"                    "geom_text"                   
[69] "geom_tile"                    "geom_violin"                 
[71] "geom_violinh"                 "geom_vline"                  
[73] "geom_vridgeline"             </code></pre>
<p>help pages will tell you their aesthetics, default stats, etc.</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">?</span><span class="va">geom_area</span>             <span class="co"># for example</span></code></pre></div>
</div>
<div id="lets-try-geom_area" class="section level5 unnumbered">
<h5>Let’s try <code>geom_area</code><a class="anchor" aria-label="anchor" href="#lets-try-geom_area"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Births78</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span>, fill<span class="op">=</span><span class="va">wday</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_ribbon.html">geom_area</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"US Births in 1978"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-27-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Using area does not produce a good plot</p>
<ul>
<li>over plotting is hiding much of the data</li>
<li>extending y-axis to 0 may or may not be desirable.</li>
</ul>
</div>
<div id="side-note-what-makes-a-plot-good" class="section level5 unnumbered">
<h5>Side note: what makes a plot good?<a class="anchor" aria-label="anchor" href="#side-note-what-makes-a-plot-good"><i class="fas fa-link"></i></a>
</h5>
<p>Most (all?) graphics are intended to help us make comparisons</p>
<ul>
<li>How does something change over time?</li>
<li>Do my treatments matter? How much?</li>
<li>Do men and women respond the same way?</li>
</ul>
<p><strong>Key plot metric:</strong> Does my plot make the comparisons I am interested in</p>
<ul>
<li>easily, and</li>
<li>accurately?</li>
</ul>
</div>
<div id="time-for-some-different-data" class="section level5 unnumbered">
<h5>Time for some different data<a class="anchor" aria-label="anchor" href="#time-for-some-different-data"><i class="fas fa-link"></i></a>
</h5>
<p><code>HELPrct</code>: Health Evaluation and Linkage to Primary care randomized clinical trial</p>
<div class="sourceCode" id="cb201"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">HELPrct</span><span class="op">)</span></code></pre></div>
<pre><code>##   age anysubstatus anysub cesd d1 daysanysub dayslink drugrisk e2b female
## 1  37            1    yes   49  3        177      225        0  NA      0
## 2  37            1    yes   30 22          2       NA        0  NA      0
## 3  26            1    yes   39  0          3      365       20  NA      0
## 4  39            1    yes   15  2        189      343        0   1      1
## 5  32            1    yes   39 12          2       57        0   1      0
## 6  47            1    yes    6  1         31      365        0  NA      1
##      sex g1b homeless i1 i2 id indtot linkstatus link       mcs      pcs pss_fr
## 1   male yes   housed 13 26  1     39          1  yes 25.111990 58.41369      0
## 2   male yes homeless 56 62  2     43         NA &lt;NA&gt; 26.670307 36.03694      1
## 3   male  no   housed  0  0  3     41          0   no  6.762923 74.80633     13
## 4 female  no   housed  5  5  4     28          0   no 43.967880 61.93168     11
## 5   male  no homeless 10 13  5     38          1  yes 21.675755 37.34558     10
## 6 female  no   housed  4  4  6     29          0   no 55.508991 46.47521      5
##   racegrp satreat sexrisk substance treat avg_drinks max_drinks
## 1   black      no       4   cocaine   yes         13         26
## 2   white      no       7   alcohol   yes         56         62
## 3   black      no       2    heroin    no          0          0
## 4   white     yes       4    heroin    no          5          5
## 5   black      no       6   cocaine    no         10         13
## 6   black      no       5   cocaine   yes          4          4
##   hospitalizations
## 1                3
## 2               22
## 3                0
## 4                2
## 5               12
## 6                1</code></pre>
<p>Subjects admitted for treatment for addiction to one of three substances.</p>
</div>
<div id="who-are-the-people-in-the-study" class="section level5 unnumbered">
<h5>Who are the people in the study?<a class="anchor" aria-label="anchor" href="#who-are-the-people-in-the-study"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb203"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-29-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>
<p>Hmm. What’s up with <code>y</code>?</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">stat_bin()</a></code> is being applied to the data before the
<code><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_bar()</a></code> gets to do its thing. Binning creates the
<code>y</code> values.</li>
</ul>
</li>
</ul>
</div>
<div id="who-are-the-people-in-the-study-1" class="section level5 unnumbered">
<h5>Who are the people in the study?<a class="anchor" aria-label="anchor" href="#who-are-the-people-in-the-study-1"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb204"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-30-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="who-are-the-people-in-the-study-2" class="section level5 unnumbered">
<h5>Who are the people in the study?<a class="anchor" aria-label="anchor" href="#who-are-the-people-in-the-study-2"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb205"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span>
<span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>labels <span class="op">=</span> <span class="va">percent</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-31-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="who-are-the-people-in-the-study-3" class="section level5 unnumbered">
<h5>Who are the people in the study?<a class="anchor" aria-label="anchor" href="#who-are-the-people-in-the-study-3"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb206"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_bar.html">geom_bar</a></span><span class="op">(</span>position<span class="op">=</span><span class="st">"fill"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span><span class="st">"actually, percent"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-32-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="how-old-are-people-in-the-help-study" class="section level5 unnumbered">
<h5>How old are people in the HELP study?<a class="anchor" aria-label="anchor" href="#how-old-are-people-in-the-help-study"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb207"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-33-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Notice the messages</p>
<ul>
<li><p><code>stat_bin</code>: Histograms are not mapping the raw data but binned data.<br><code><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">stat_bin()</a></code> performs the data transformation.</p></li>
<li><p><code>binwidth</code>: a default <code>binwidth</code> has been selected, but we should really choose our own.</p></li>
</ul>
</div>
<div id="setting-the-binwidth-manually" class="section level5 unnumbered">
<h5>Setting the binwidth manually<a class="anchor" aria-label="anchor" href="#setting-the-binwidth-manually"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb209"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-34-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="how-old-are-people-in-the-help-study-other-geoms" class="section level5 unnumbered">
<h5>How old are people in the HELP study? – Other geoms<a class="anchor" aria-label="anchor" href="#how-old-are-people-in-the-help-study-other-geoms"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb210"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_freqpoly</a></span><span class="op">(</span>binwidth<span class="op">=</span><span class="fl">2</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-35-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb211"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-36-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="selecting-stat-and-geom-manually" class="section level5 unnumbered">
<h5>Selecting stat and geom manually<a class="anchor" aria-label="anchor" href="#selecting-stat-and-geom-manually"><i class="fas fa-link"></i></a>
</h5>
<p>Every geom comes with a default stat</p>
<ul>
<li>for simple cases, the stat is <code><a href="https://rdrr.io/pkg/ggplot2/man/stat_identity.html">stat_identity()</a></code> which does nothing</li>
<li>we can mix and match geoms and stats however we like</li>
</ul>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-37-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="selecting-stat-and-geom-manually-1" class="section level5 unnumbered">
<h5>Selecting stat and geom manually<a class="anchor" aria-label="anchor" href="#selecting-stat-and-geom-manually-1"><i class="fas fa-link"></i></a>
</h5>
<p>Every stat comes with a default <code>geom</code>, every geom with a default stat</p>
<ul>
<li>we can specify stats instead of <code>geom</code>, if we prefer</li>
<li>we can mix and match geoms and stats however we like</li>
</ul>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_density.html">stat_density</a></span><span class="op">(</span> geom<span class="op">=</span><span class="st">"line"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-38-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="more-combinations" class="section level5 unnumbered">
<h5>More combinations<a class="anchor" aria-label="anchor" href="#more-combinations"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"bin"</span>, binwidth<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"bin"</span>, binwidth<span class="op">=</span><span class="fl">3</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-39-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_ribbon.html">geom_area</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"bin"</span>, binwidth<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span> </code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-40-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"bin"</span>, binwidth<span class="op">=</span><span class="fl">3</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>size<span class="op">=</span><span class="va">..count..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"bin"</span>, binwidth<span class="op">=</span><span class="fl">3</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-41-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="how-much-do-they-drink-i1" class="section level5 unnumbered">
<h5>How much do they drink? (i1)<a class="anchor" aria-label="anchor" href="#how-much-do-they-drink-i1"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb217"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-42-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_density.html">geom_density</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-43-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_ribbon.html">geom_area</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-44-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="covariates-adding-in-more-variables" class="section level5 unnumbered">
<h5>Covariates: Adding in more variables<a class="anchor" aria-label="anchor" href="#covariates-adding-in-more-variables"><i class="fas fa-link"></i></a>
</h5>
<p>Using <code>color</code> and <code>linetype</code>:</p>
<div class="sourceCode" id="cb220"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i1</span>, color<span class="op">=</span><span class="va">substance</span>, linetype<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"density"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-45-1.png" width="480" style="display: block; margin: auto;"></div>
<p>Using <code>color</code> and <code>facet</code>s</p>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i1</span>, color<span class="op">=</span><span class="va">substance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"density"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span> <span class="va">.</span> <span class="op">~</span> <span class="va">sex</span> <span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-46-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb222"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">i1</span>, color<span class="op">=</span><span class="va">substance</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_path.html">geom_line</a></span><span class="op">(</span>stat<span class="op">=</span><span class="st">"density"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span> <span class="va">sex</span> <span class="op">~</span> <span class="va">.</span> <span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-47-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="boxplots" class="section level5 unnumbered">
<h5>Boxplots<a class="anchor" aria-label="anchor" href="#boxplots"><i class="fas fa-link"></i></a>
</h5>
<p>Boxplots use <code><a href="https://rdrr.io/pkg/ggplot2/man/geom_quantile.html">stat_quantile()</a></code> which computes a five-number summary (roughly the five quartiles of the data) and uses them to define a “box” and “whiskers.”</p>
<p>The quantitative variable must be <code>y</code>, and there must be an additional <code>x</code> variable.</p>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, y<span class="op">=</span><span class="va">age</span>, color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-48-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="horizontal-boxplots" class="section level5 unnumbered">
<h5>Horizontal boxplots<a class="anchor" aria-label="anchor" href="#horizontal-boxplots"><i class="fas fa-link"></i></a>
</h5>
<p>Horizontal boxplots are obtained by flipping the coordinate system:</p>
<div class="sourceCode" id="cb224"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, y<span class="op">=</span><span class="va">age</span>, color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-49-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/ggplot2/man/coord_flip.html">coord_flip()</a></code> may be used with other plots as well to reverse the roles
of <code>x</code> and <code>y</code> on the plot.</li>
</ul>
</div>
<div id="axes-scaling-with-boxplots" class="section level5 unnumbered">
<h5>Axes scaling with boxplots<a class="anchor" aria-label="anchor" href="#axes-scaling-with-boxplots"><i class="fas fa-link"></i></a>
</h5>
<p>We can scale the continuous axis</p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, y<span class="op">=</span><span class="va">age</span>, color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_trans.html">coord_trans</a></span><span class="op">(</span>y<span class="op">=</span><span class="st">"log"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-50-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="give-me-some-space" class="section level5 unnumbered">
<h5>Give me some space<a class="anchor" aria-label="anchor" href="#give-me-some-space"><i class="fas fa-link"></i></a>
</h5>
<p>We’ve triggered a new feature: <code>dodge</code> (for dodging things left/right). We can control how much if we set the dodge manually.</p>
<div class="sourceCode" id="cb226"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">HELPrct</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, y<span class="op">=</span><span class="va">age</span>, color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/position_dodge.html">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-51-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="issues-with-bigger-data" class="section level5 unnumbered">
<h5>Issues with bigger data<a class="anchor" aria-label="anchor" href="#issues-with-bigger-data"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va">NHANES</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">NHANES</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 10000    76</code></pre>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NHANES</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span>  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Height</span>, y<span class="op">=</span><span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span> <span class="va">Gender</span> <span class="op">~</span> <span class="va">PregnantNow</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"National Health and Nutrition Examination Survey"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-52-1.png" width="480" style="display: block; margin: auto;"></div>
<ul>
<li>Although we can see a generally positive association (as we would expect), the over plotting may be hiding information.</li>
</ul>
</div>
<div id="using-alpha-opacity" class="section level5 unnumbered">
<h5>Using alpha (opacity)<a class="anchor" aria-label="anchor" href="#using-alpha-opacity"><i class="fas fa-link"></i></a>
</h5>
<p>One way to deal with over plotting is to set the opacity low.</p>
<div class="sourceCode" id="cb230"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NHANES</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Height</span>, y<span class="op">=</span><span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span> <span class="va">Gender</span> <span class="op">~</span> <span class="va">PregnantNow</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"National Health and Nutrition Examination Survey"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-53-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="geom_density2d" class="section level5 unnumbered">
<h5>geom_density2d<a class="anchor" aria-label="anchor" href="#geom_density2d"><i class="fas fa-link"></i></a>
</h5>
<p>Alternatively (or simultaneously) we might prefer a different <code>geom</code> altogether.</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NHANES</span> <span class="op"><a href="https://rdrr.io/pkg/magrittr/man/pipe.html">%&gt;%</a></span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Height</span>, y<span class="op">=</span><span class="va">Weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_density_2d.html">geom_density2d</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_grid.html">facet_grid</a></span><span class="op">(</span> <span class="va">Gender</span> <span class="op">~</span> <span class="va">PregnantNow</span> <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"National Health and Nutrition Examination Survey"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-54-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="multiple-layers" class="section level5 unnumbered">
<h5>Multiple layers<a class="anchor" aria-label="anchor" href="#multiple-layers"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb232"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span> data<span class="op">=</span><span class="va">HELPrct</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sex</span>, y<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>outlier.size<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.6</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-55-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="multiple-layers-1" class="section level5 unnumbered">
<h5>Multiple layers<a class="anchor" aria-label="anchor" href="#multiple-layers-1"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span> data<span class="op">=</span><span class="va">HELPrct</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">sex</span>, y<span class="op">=</span><span class="va">age</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>outlier.size<span class="op">=</span><span class="fl">0</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span>alpha<span class="op">=</span><span class="fl">.6</span>, position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/position_jitter.html">position_jitter</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">.1</span>, height<span class="op">=</span><span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-56-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="things-i-havent-mentioned-much" class="section level5 unnumbered">
<h5>Things I haven’t mentioned (much)<a class="anchor" aria-label="anchor" href="#things-i-havent-mentioned-much"><i class="fas fa-link"></i></a>
</h5>
<ul>
<li><p>coords (<code><a href="https://rdrr.io/pkg/ggplot2/man/coord_flip.html">coord_flip()</a></code> is good to know about)</p></li>
<li><p>themes (for customizing appearance)</p></li>
<li><p>position (<code><a href="https://rdrr.io/pkg/ggplot2/man/position_dodge.html">position_dodge()</a></code>, <code><a href="https://rdrr.io/pkg/ggplot2/man/position_jitterdodge.html">position_jitterdodge()</a></code>, <code><a href="https://rdrr.io/pkg/ggplot2/man/position_stack.html">position_stack()</a></code>, etc.)</p></li>
<li><p>transforming axes</p></li>
</ul>
<div class="sourceCode" id="cb234"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">Births78</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">date</span>, y<span class="op">=</span><span class="va">births</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
          <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_wsj.html">theme_wsj</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-57-1.png" width="1344" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">HELPrct</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, y<span class="op">=</span><span class="va">age</span>, color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>coef <span class="op">=</span> <span class="fl">10</span>, position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/position_dodge.html">position_dodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>color<span class="op">=</span><span class="va">sex</span>, fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span>, position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-58-1.png" width="1344" style="display: block; margin: auto;"></div>
</div>
<div id="a-little-bit-of-everything" class="section level5 unnumbered">
<h5>A little bit of everything<a class="anchor" aria-label="anchor" href="#a-little-bit-of-everything"><i class="fas fa-link"></i></a>
</h5>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span> data<span class="op">=</span><span class="va">HELPrct</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">substance</span>, y<span class="op">=</span><span class="va">age</span>, color<span class="op">=</span><span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>coef <span class="op">=</span> <span class="fl">10</span>, position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/position_dodge.html">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>fill<span class="op">=</span><span class="va">sex</span><span class="op">)</span>, alpha<span class="op">=</span><span class="fl">.5</span>, 
             position<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span>dodge.width<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">homeless</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/labs.html">ggtitle</a></span><span class="op">(</span><span class="st">"HELP clinical trial at detoxification unit"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="01c-viz_files/figure-html/unnamed-chunk-59-1.png" width="1344" style="display: block; margin: auto;"></div>
</div>
<div id="want-to-learn-more" class="section level4 unnumbered">
<h4>Want to learn more?<a class="anchor" aria-label="anchor" href="#want-to-learn-more"><i class="fas fa-link"></i></a>
</h4>
<ul>
<li><p><a href="http://docs.ggplot2.org/">docs.ggplot2.org/</a></p></li>
<li><p>Winston Chang’s: <em>R Graphics Cookbook</em></p></li>
</ul>
<div class="inline-figure"><img src="figs/cookbook.png" width="800px" style="display: block; margin: auto;"></div>
</div>
<div id="what-else-can-we-do" class="section level4 unnumbered">
<h4>What else can we do?<a class="anchor" aria-label="anchor" href="#what-else-can-we-do"><i class="fas fa-link"></i></a>
</h4>
<p><code>shiny</code></p>
<ul>
<li><p>interactive graphics / modeling</p></li>
<li><p><a href="https://shiny.rstudio.com/" class="uri">https://shiny.rstudio.com/</a></p></li>
</ul>
<p><code>plotly</code></p>
<blockquote>
<p><code>Plotly</code> is an R package for creating interactive web-based graphs via plotly’s JavaScript graphing library, <code>plotly.js</code>. The <code>plotly</code> R library contains the <code>ggplotly</code> function , which will convert <code>ggplot2</code> figures into a Plotly object. Furthermore, you have the option of manipulating the Plotly object with the <code>style</code> function.</p>
</blockquote>
<ul>
<li><a href="https://plot.ly/ggplot2/getting-started/" class="uri">https://plot.ly/ggplot2/getting-started/</a></li>
</ul>
<p>Dynamic documents</p>
<ul>
<li>combination of <code>RMarkdown</code>, <code>ggvis</code>, and <code>shiny</code>
</li>
</ul>
</div>
</div>
</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="wrang.html"><span class="header-section-number">2</span> Data Wrangling</a></div>
<div class="next"><a href="slr.html"><span class="header-section-number">4</span> Simple Linear Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#viz"><span class="header-section-number">3</span> Visualization</a></li>
<li>
<a class="nav-link" href="#thoughts"><span class="header-section-number">3.1</span> Thoughts on Plotting</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#advice"><span class="header-section-number">3.1.1</span> Advice</a></li></ul>
</li>
<li>
<a class="nav-link" href="#deconstruct"><span class="header-section-number">3.2</span> Deconstructing a graph</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#gg"><span class="header-section-number">3.2.1</span> The Grammar of Graphics (gg)</a></li>
<li><a class="nav-link" href="#ggplot2"><span class="header-section-number">3.2.2</span> ggplot2</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/01c-viz.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/01c-viz.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Linear Models</strong>" was written by Jo Hardin. It was last built on 2022-03-04.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
