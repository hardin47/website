<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Correlation &amp; Regression as Models | Introduction to (Bio)Statistics</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="The next topic will focus on modeling using two quantitative variables. That is, both the explanatory and the response variables are measured on a numeric scale. To get started, consider a handful...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 3 Correlation &amp; Regression as Models | Introduction to (Bio)Statistics">
<meta property="og:type" content="book">
<meta property="og:description" content="The next topic will focus on modeling using two quantitative variables. That is, both the explanatory and the response variables are measured on a numeric scale. To get started, consider a handful...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Correlation &amp; Regression as Models | Introduction to (Bio)Statistics">
<meta name="twitter:description" content="The next topic will focus on modeling using two quantitative variables. That is, both the explanatory and the response variables are measured on a numeric scale. To get started, consider a handful...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to (Bio)Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="rfunc.html"><span class="header-section-number">1</span> R functions</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="active" href="regdesc.html"><span class="header-section-number">3</span> Correlation &amp; Regression as Models</a></li>
<li><a class="" href="foundations-for-inference.html"><span class="header-section-number">4</span> Foundations for Inference</a></li>
<li><a class="" href="inference-for-categorical-data.html"><span class="header-section-number">5</span> Inference for categorical data</a></li>
<li><a class="" href="inference-for-numerical-data.html"><span class="header-section-number">6</span> Inference for numerical data</a></li>
<li><a class="" href="reginf.html"><span class="header-section-number">7</span> Inference on Correlation &amp; Regression</a></li>
<li><a class="" href="interlude-in-spring-2020.html"><span class="header-section-number">8</span> Interlude in Spring 2020</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="regdesc" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Correlation &amp; Regression as Models<a class="anchor" aria-label="anchor" href="#regdesc"><i class="fas fa-link"></i></a>
</h1>
<!--
## 4/16/20 Agenda {#Apr16}
1. Definition of correlation (r)
2. Interpretation of correlation (r)  
3. (Probably not: Inference on $\rho$)
-->
<p>The next topic will focus on modeling using two quantitative variables. That is, both the explanatory and the response variables are measured on a numeric scale.</p>
<p>To get started, consider a handful of crop types taken from <a href="https://ourworldindata.org/crop-yields">Our World in Data</a> as part of <a href="https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-09-01">Tidy Tuesday</a>. Each point in each plot represents a different country. The x and y variables represent the proportion of total yield in the last 50 years which is due to that crop type.</p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plots6"></span>
<img src="05-CorRegDesc_files/figure-html/plots6-1.png" alt="The % of total yield for different crops (across the last 50 years).  Each point represents a country." width="672"><p class="caption">
Figure 3.1: The % of total yield for different crops (across the last 50 years). Each point represents a country.
</p>
</div>
<p>Order the six scatterplots from strongest negative to strongest positive linear relationship. Some questions to ask yourself:</p>
<ul>
<li>What would the correlation be if there was a perfect positive relationship?</li>
<li>What would the correlation be if there was a perfect negative relationship?</li>
<li>What would the correlation be if there was no relationship?</li>
</ul>
<div id="cor" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Correlation<a class="anchor" aria-label="anchor" href="#cor"><i class="fas fa-link"></i></a>
</h2>
<p>Correlation measures the <strong>linear</strong> association between two numerical variables. [Note, that when describing how two categorical (or one numerical &amp; one categorical) variables vary together, they are said to be <em>associated</em> instead of <em>correlated</em>.]</p>
<blockquote>
<p>The <em>correlation coefficient</em> measures the strength and direction of the linear association between two numerical variables.</p>
</blockquote>
<div id="estimating-correlation" class="section level3" number="3.1.1">
<h3>
<span class="header-section-number">3.1.1</span> Estimating Correlation<a class="anchor" aria-label="anchor" href="#estimating-correlation"><i class="fas fa-link"></i></a>
</h3>
<p>The value of the correlation is defined as:</p>
<p><span class="math display">\[\begin{eqnarray*}
r &amp;=&amp; \frac{ \sum_i (x_i  - \overline{x})(Y_i - \overline{Y})}{\sqrt{\sum_i(x_i - \overline{x})^2} \sqrt{ \sum_i(Y_i - \overline{Y})^2}}\\
r &amp;=&amp; \frac{1}{n-1} \sum_{i=1}^n \bigg(\frac{x_i - \overline{x}}{s_x} \bigg) \bigg(\frac{Y_i - \overline{Y}}{s_Y} \bigg)
\end{eqnarray*}\]</span></p>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:plots6ave"></span>
<img src="05-CorRegDesc_files/figure-html/plots6ave-1.png" alt="The % of total yield for different crops (across the last 50 years).  Each point represents a country.  Now lines at the average x and average y values have been superimposed onto the plots." width="672"><p class="caption">
Figure 3.2: The % of total yield for different crops (across the last 50 years). Each point represents a country. Now lines at the average x and average y values have been superimposed onto the plots.
</p>
</div>
<p>For each red dot (on each plot), consider the distance the observation is from the <span class="math inline">\(\overline{X}\)</span> line and the <span class="math inline">\(\overline{Y}\)</span> line. Is the observation (red dot) above both? below both? above one and below the other?</p>
<p>How does the particular red dot (observation) contribute to the correlation? In a positive way (to make <span class="math inline">\(r\)</span> bigger)? In a negative way (to make <span class="math inline">\(r\)</span> smaller)?</p>
<p>Some ideas worth thinking about:</p>
<ul>
<li>quadratic plots can have zero correlation yet a perfect functional relationship</li>
<li><span class="math inline">\(-1 \leq r \leq 1\)</span></li>
<li>correlation does not imply causation (ice cream &amp; boating accidents!)</li>
<li>for inference with <span class="math inline">\(\rho\)</span> as well as <span class="math inline">\(\beta_1\)</span>, the data should come from a bivariate normal distribution. That is, histograms of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> should both be normal, and the scatterplot should be a cloud.</li>
<li>correlation will go down when only a narrow range of X values is represented (see denominator of r).</li>
<li>measurement error biases the estimate of a correlation coefficient toward zero.</li>
</ul>
<p>We can calculate the correlation value for each of the crop plots and order them from strongest negative to strongest positive linear relationship: <span class="math inline">\(A \rightarrow D \rightarrow B \rightarrow C \rightarrow E \rightarrow F\)</span></p>
<div class="inline-table"><table class="table" style="margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-2">Table 3.1: </span>Correlation of percentage of total yield across different crops.
</caption>
<thead><tr>
<th style="text-align:left;">
Graph
</th>
<th style="text-align:left;">
x-variable
</th>
<th style="text-align:left;">
y-variable
</th>
<th style="text-align:right;">
correlation
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
A
</td>
<td style="text-align:left;">
potatoes
</td>
<td style="text-align:left;">
bananas
</td>
<td style="text-align:right;">
-0.54
</td>
</tr>
<tr>
<td style="text-align:left;">
B
</td>
<td style="text-align:left;">
soybeans
</td>
<td style="text-align:left;">
cassava
</td>
<td style="text-align:right;">
0.16
</td>
</tr>
<tr>
<td style="text-align:left;">
C
</td>
<td style="text-align:left;">
maize
</td>
<td style="text-align:left;">
cassava
</td>
<td style="text-align:right;">
0.46
</td>
</tr>
<tr>
<td style="text-align:left;">
D
</td>
<td style="text-align:left;">
cocoa
</td>
<td style="text-align:left;">
bananas
</td>
<td style="text-align:right;">
-0.44
</td>
</tr>
<tr>
<td style="text-align:left;">
E
</td>
<td style="text-align:left;">
peas
</td>
<td style="text-align:left;">
barley
</td>
<td style="text-align:right;">
0.69
</td>
</tr>
<tr>
<td style="text-align:left;">
F
</td>
<td style="text-align:left;">
wheat
</td>
<td style="text-align:left;">
barley
</td>
<td style="text-align:right;">
0.85
</td>
</tr>
</tbody>
</table></div>
</div>
<div id="coefficient-of-determination-r2" class="section level3" number="3.1.2">
<h3>
<span class="header-section-number">3.1.2</span> Coefficient of Determination: <span class="math inline">\(R^2\)</span><a class="anchor" aria-label="anchor" href="#coefficient-of-determination-r2"><i class="fas fa-link"></i></a>
</h3>
<p>The coefficient of determination (<span class="math inline">\(R^2\)</span>) is the square of the correlation (given above). However, it also has an additional interpretation that will be useful for us. It can measure how much of the original variability in Y is given by the regression line. Both SSE and least-squares will be defined below when we fit a line to the scatter plot of observations.</p>
<p><span class="math inline">\(s^2\)</span> is the amount the response variable varies on its own. <span class="math inline">\(SSE(\mbox{least-squares})\)</span> is the amount the response variable varies around the regression line (see Section <a href="regdesc.html#slr">3.2</a>).</p>
<p><span class="math display">\[s^2 = \frac{1}{n-1}\sum_{i=1}^n(Y_i - \overline{Y})^2 \ \ \ \ \ \ \ \ \ SSE = \sum_{i=1}^n(Y_i - \hat{Y}_i)^2\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
R^2 &amp;=&amp; \frac{\sum_{i=1}^n(Y_i - \overline{Y})^2 - SSE(\mbox{least-squares})}{\sum_{i=1}^n(Y_i - \overline{Y})^2} \\
 &amp;=&amp; \frac{Var(Y_i) - Var(e_i)}{Var(Y_i)} \\
 &amp;=&amp; 1 - \frac{Var(e_i)}{Var(Y_i)}\\
\end{eqnarray*}\]</span></p>
<p>The value <span class="math inline">\(e_i\)</span> is discussed in detail below, but it is the distance from the observed response variable to the prediction on the line: <span class="math display">\[\begin{align}e_i=Y_i-\hat{Y}_i\end{align}\]</span></p>
<p><span class="math inline">\(R^2\)</span> can be used even in models with many explanatory variables. As such, the way to think about <span class="math inline">\(R^2\)</span> is in terms of how much of the variability in the response variable was removed (when we learned the values of the explanatory variables). <span class="math inline">\(R^2\)</span> <strong>is the proportion reduction in the variability of the response variable which is explained by the explanatory variable.</strong></p>
<!--
## 4/21/20 Agenda {#Apr21}
1. Least Squares estimation of the line
2. Distribution of the least squares line from sample to sample

## 4/23/20 Agenda {#Apr23}
1. Inferential technical conditions
2. Residual Plots
3. Transformations
4. Prediction Intervals
-->
</div>
</div>
<div id="slr" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Simple Linear Regression<a class="anchor" aria-label="anchor" href="#slr"><i class="fas fa-link"></i></a>
</h2>
<p><em>Regression</em> is a method that predicts the value of one numerical variable from that of another. That is, as an extension to describing the degree of linearity of the relationship (correlation), the goal is now to create the best linear model – often for prediction. Note that many of the characteristics explored with correlation are applicable for regression. However, correlation treats <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> as interchangeable, whereas regression treats <span class="math inline">\(X\)</span> as fixed and known and <span class="math inline">\(Y\)</span> as random and unknown. As we have previously, we call <span class="math inline">\(X\)</span> the explanatory variable, and <span class="math inline">\(Y\)</span> the response variable. Again, we do not assume that there is any causal mechanism between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> even if they have a strong linear (or otherwise) relationship.</p>
<div id="predicted-values" class="section level4 unnumbered">
<h4>Predicted Values<a class="anchor" aria-label="anchor" href="#predicted-values"><i class="fas fa-link"></i></a>
</h4>
<p>The predicted values of Y from a regression line estimate the <em>mean value</em> of <span class="math inline">\(Y\)</span> for all individuals that have a given value of <span class="math inline">\(X\)</span>. Notice the Roman letters (English letters) representing statistics:</p>
<p><span class="math display">\[\begin{eqnarray*}
\hat{Y} &amp;=&amp; b_0 + b_1 x\\
\hat{Y}_i &amp;=&amp; b_0 + b_1 x_i\\
Y_i &amp;=&amp; b_0 + b_1 x_i + e_i\\
e_i &amp;=&amp; Y_i - \hat{Y}_i = Y_i -  (b_0 + b_1 x_i)\\
\end{eqnarray*}\]</span></p>
<p>Notice, that we are predicting the <strong>mean</strong> value of the response variable at a given value of the explanatory variable!</p>
</div>
<div id="ls" class="section level3" number="3.2.1">
<h3>
<span class="header-section-number">3.2.1</span> Least Squares estimation of the regression line<a class="anchor" aria-label="anchor" href="#ls"><i class="fas fa-link"></i></a>
</h3>
<p>To find the values of the regression statistics, the sum of squared errors is minimized.</p>
<p><strong>SSE:</strong> Sum of squared errors (or residuals) is a measure of how closely the line fits to the points. SSE is the value of the squared deviations calculated at the “best” possible values of <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> for a given dataset.</p>
<p><span class="math display">\[\begin{eqnarray*}
SSE = \sum_i (Y_i - \hat{Y}_i)^2 = \sum_i (Y_i - (b_0 + b_1 x_i) )^2
\end{eqnarray*}\]</span>
is minimized by the values:
<span class="math display">\[\begin{eqnarray*}
b_0 = \overline{Y} - b_1 \overline{x} &amp; \ \ \ \ \ \ \ &amp; b_1 = r \frac{s_Y}{s_x}
\end{eqnarray*}\]</span></p>
<p>To find the “best” fitting line, we searched for the line that has the smallest residuals (SSE) in some sense. In particular, the goal is to try to find the line that minimizes the following quantity: <span class="math display">\[Q=\sum e_i^2 = \sum (Y_i-(b_0+b_1x_i))^2.\]</span></p>
<p>Finding <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that minimize Q is a calculus problem.
<span class="math display">\[\frac{dQ}{db_0}=-2\sum (Y_i-(b_0+b_1x_i)),\qquad \frac{dQ}{db_1}=-2\sum
x_i(Y_i-(b_0+b_1x_i))\]</span>
Setting both derivatives equal to 0 and solving for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> yields the optimal values, denoted as <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span></p>
<p>One aspect of the optimization problem that is worth pointing out has to do with the role of the two variables of interest <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>. If we switch the roles of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>, the best fitting line will be different. If the relationship was invariant to which variable we choose as a response, then switching the roles of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> should give a slope of <span class="math inline">\(1/b_1\)</span>, which is not the case. [Note that the role of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> <strong>is</strong> invariant when calculating the correlation but not when calculating the least squares regression line.]</p>
<div id="residuals" class="section level4 unnumbered">
<h4>Residuals<a class="anchor" aria-label="anchor" href="#residuals"><i class="fas fa-link"></i></a>
</h4>
<p>Residuals measure the scatter of points above and below the least squares regression line. We use the residuals in many of the calculations and interpretations of the model. Indeed, the goal of the linear regression is to find a model that has small residuals. That is, ideally, the known variable <span class="math inline">\(X\)</span> will tell us all there is to know about the unknown variable <span class="math inline">\(Y\)</span>.</p>
<p><span class="math display">\[\begin{eqnarray*}
e_i &amp;=&amp; (Y_i - \hat{Y}_i)\\
SSE &amp;=&amp; \sum_i (Y_i - \hat{Y}_i)^2 = \sum_i (e_i)^2 \ \ \mbox{(sum)}\\
MSE&amp;=&amp; \frac{\sum_i (Y_i - \hat{Y}_i)^2}{n-2} = \frac{\sum_i (e_i)^2}{n-2} = s^2 \ \ \mbox{(mean)}\\
s_Y^2 &amp;=&amp; \frac{\sum_i(Y_i - \overline{Y})^2}{n-1}\\
R^2 &amp;=&amp; 1 - \frac{Var(e_i)}{Var(Y_i)} = 1 - \frac{\sum_i (Y_i - \hat{Y}_i)^2}{\sum_i(Y_i - \overline{Y})^2}
\end{eqnarray*}\]</span></p>
<p><span class="math inline">\(R^2\)</span> is the proportion of variability in <span class="math inline">\(Y\)</span> which can be explained (i.e., removed) by knowing <span class="math inline">\(x\)</span>.</p>
</div>
</div>
</div>
<div id="r-code-for-regression" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> R code for regression<a class="anchor" aria-label="anchor" href="#r-code-for-regression"><i class="fas fa-link"></i></a>
</h2>
<div id="ex:cat" class="section level3" number="3.3.1">
<h3>
<span class="header-section-number">3.3.1</span> Example: Cat Jumping<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="citation"&gt;&lt;a href="references.html#ref-iscam" role="doc-biblioref"&gt;Chance and Rossman&lt;/a&gt; (&lt;a href="references.html#ref-iscam" role="doc-biblioref"&gt;2018&lt;/a&gt;)&lt;/span&gt;, Inv 5.6 &amp;amp; 5.13&lt;/p&gt;'><sup>3</sup></a> (Correlation &amp; SLR)<a class="anchor" aria-label="anchor" href="#ex:cat"><i class="fas fa-link"></i></a>
</h3>
<p>Consider the cat data given in Investigations 5.6 and 5.13. The idea is to understand cat jumping velocity as a function of body characteristics. Note that the correlation <span class="math inline">\(r=-0.496\)</span> between bodymass and velocity. Also, <span class="math inline">\(R^2 = (-0.496)^2 = 0.246.\)</span> 24.6% of the variability in velocity can be explained by the bodymass.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/readr/man/read_table2.html">read_table2</a></span><span class="op">(</span><span class="st">"http://www.rossmanchance.com/iscam2/data/CatJumping.txt"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">cats</span>, <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">bodymass</span>, y <span class="op">=</span> <span class="va">velocity</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_smooth.html">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"lm"</span>, se<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="05-CorRegDesc_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></div>
<div id="correlation" class="section level4 unnumbered">
<h4>Correlation<a class="anchor" aria-label="anchor" href="#correlation"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cats</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/MASS/man/lm.ridge.html">select</a></span><span class="op">(</span><span class="va">bodymass</span>, <span class="va">velocity</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cor</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>##            bodymass   velocity
## bodymass  1.0000000 -0.4964022
## velocity -0.4964022  1.0000000</code></pre>
</div>
<div id="simple-linear-regression" class="section level4 unnumbered">
<h4>Simple Linear Regression<a class="anchor" aria-label="anchor" href="#simple-linear-regression"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://broom.tidymodels.org/">broom</a></span><span class="op">)</span>

<span class="va">cats</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">velocity</span> <span class="op">~</span> <span class="va">bodymass</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/generics/man/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept) 394.      23.4         16.8  1.35e-11
## 2 bodymass     -0.0122   0.00533     -2.29 3.61e- 2</code></pre>
</div>
<div id="residual-plot" class="section level4 unnumbered">
<h4>Residual Plot<a class="anchor" aria-label="anchor" href="#residual-plot"><i class="fas fa-link"></i></a>
</h4>
<p>And to work with the residuals, use <code><a href="https://rdrr.io/pkg/generics/man/augment.html">augment()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cats</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">velocity</span> <span class="op">~</span> <span class="va">bodymass</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/generics/man/augment.html">augment</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 18 × 8
##    velocity bodymass .fitted .resid   .hat .sigma   .cooksd .std.resid
##       &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt;
##  1     334.     3640    350. -15.6  0.0656   30.3 0.0104       -0.545 
##  2     387.     2670    362.  25.4  0.131    29.7 0.0640        0.920 
##  3     411.     5600    326.  84.6  0.119    19.8 0.629         3.05  
##  4     319.     4130    344. -25.5  0.0557   29.8 0.0232       -0.887 
##  5     369.     3020    358.  11.1  0.101    30.4 0.00867       0.394 
##  6     359.     2660    362.  -3.23 0.132    30.6 0.00105      -0.117 
##  7     345.     3240    355. -10.4  0.0853   30.4 0.00624      -0.366 
##  8     325.     5140    332.  -7.19 0.0844   30.5 0.00297      -0.254 
##  9     301.     3690    349. -48.1  0.0639   27.7 0.0962       -1.68  
## 10     332.     3620    350. -18.5  0.0664   30.2 0.0149       -0.648 
## 11     313.     5310    330. -17.1  0.0957   30.2 0.0196       -0.608 
## 12     317.     5560    327.  -9.86 0.116    30.4 0.00823      -0.354 
## 13     376.     3970    346.  29.5  0.0572   29.5 0.0321        1.03  
## 14     372.     3770    348.  23.9  0.0615   29.9 0.0228        0.834 
## 15     314.     5100    332. -18.0  0.0820   30.2 0.0179       -0.634 
## 16     368.     2950    358.   9.01 0.106    30.5 0.00614       0.322 
## 17     286.     7930    298. -11.5  0.508    30.3 0.157        -0.552 
## 18     352.     3550    351.   1.32 0.0692   30.6 0.0000797     0.0463</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">cats</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
<span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">velocity</span> <span class="op">~</span> <span class="va">bodymass</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/generics/man/augment.html">augment</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/pkg/infer/man/pipe.html">%&gt;%</a></span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">.fitted</span>, y <span class="op">=</span> <span class="va">.resid</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_point.html">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggplot2/man/geom_abline.html">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="05-CorRegDesc_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="ex:houses" class="section level3" number="3.3.2">
<h3>
<span class="header-section-number">3.3.2</span> Example: Housing Prices<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;span class="citation"&gt;&lt;a href="references.html#ref-iscam" role="doc-biblioref"&gt;Chance and Rossman&lt;/a&gt; (&lt;a href="references.html#ref-iscam" role="doc-biblioref"&gt;2018&lt;/a&gt;)&lt;/span&gt;, Inv 5.14&lt;/p&gt;'><sup>4</sup></a> (SLR &amp; MLR &amp; Prediction)<a class="anchor" aria-label="anchor" href="#ex:houses"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggobi.github.io/ggally/">GGally</a></span><span class="op">)</span>
<span class="va">house</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="st">"http://www.rossmanchance.com/iscam2/data/housing.txt"</span>, 
                   header<span class="op">=</span><span class="cn">TRUE</span>, sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">house</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] "sqft"     "price"    "City"     "bedrooms" "baths"</code></pre>
<div id="descriptive-statistics" class="section level4 unnumbered">
<h4>Descriptive Statistics<a class="anchor" aria-label="anchor" href="#descriptive-statistics"><i class="fas fa-link"></i></a>
</h4>
<p>A good first step is to investigate how all the variables relate to one another. The <code>ggpairs</code> function come from the R package <code>GGally</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html">ggpairs</a></span><span class="op">(</span><span class="va">house</span>, columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="05-CorRegDesc_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="reflection-questions-1" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> <i class="fas fa-lightbulb" target="_blank"></i> Reflection Questions<a class="anchor" aria-label="anchor" href="#reflection-questions-1"><i class="fas fa-link"></i></a>
</h2>
<div id="correlation-simple-linear-regression-ims-chapter-7" class="section level3" number="3.4.1">
<h3>
<span class="header-section-number">3.4.1</span> Correlation &amp; Simple Linear Regression: IMS Chapter 7<a class="anchor" aria-label="anchor" href="#correlation-simple-linear-regression-ims-chapter-7"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>What does correlation measure?</li>
<li>What values of correlation (<span class="math inline">\(r\)</span>) would indicate large positive correlation? What about a large negative correlation?</li>
<li>Sketch a scatterplot that has a strong relationship between the two variables but a correlation of virtually zero (hint: your plot will not be linear).</li>
<li>How is <span class="math inline">\(R^2\)</span> interpreted? Why is that? Make the argument which uses the ideas of “percent of variability in the response variable?”</li>
<li>In a linear model what is an error / residual term and how it is calculated?</li>
<li>How do we find the values of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> for estimating the least squares line?</li>
<li>Is least squares the only possible way to fit a line to a cloud of points? How else might we do it? Why do we tend to use least squares?</li>
</ol>
</div>
</div>
<div id="ethics-considerations-1" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> <i class="fas fa-balance-scale"></i> Ethics Considerations<a class="anchor" aria-label="anchor" href="#ethics-considerations-1"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>What does the phrase “correlation is not causation” mean? and why is it important to remember?</li>
<li>Why is it dangerous to extrapolate?</li>
<li>Is linear regression always appropriate when comparing two continuous variables? When wouldn’t it be?</li>
</ol>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="intro.html"><span class="header-section-number">2</span> Introduction</a></div>
<div class="next"><a href="foundations-for-inference.html"><span class="header-section-number">4</span> Foundations for Inference</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#regdesc"><span class="header-section-number">3</span> Correlation &amp; Regression as Models</a></li>
<li>
<a class="nav-link" href="#cor"><span class="header-section-number">3.1</span> Correlation</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#estimating-correlation"><span class="header-section-number">3.1.1</span> Estimating Correlation</a></li>
<li><a class="nav-link" href="#coefficient-of-determination-r2"><span class="header-section-number">3.1.2</span> Coefficient of Determination: \(R^2\)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#slr"><span class="header-section-number">3.2</span> Simple Linear Regression</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#ls"><span class="header-section-number">3.2.1</span> Least Squares estimation of the regression line</a></li></ul>
</li>
<li>
<a class="nav-link" href="#r-code-for-regression"><span class="header-section-number">3.3</span> R code for regression</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ex:cat"><span class="header-section-number">3.3.1</span> Example: Cat Jumping3 (Correlation &amp; SLR)</a></li>
<li><a class="nav-link" href="#ex:houses"><span class="header-section-number">3.3.2</span> Example: Housing Prices4 (SLR &amp; MLR &amp; Prediction)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reflection-questions-1"><span class="header-section-number">3.4</span>  Reflection Questions</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#correlation-simple-linear-regression-ims-chapter-7"><span class="header-section-number">3.4.1</span> Correlation &amp; Simple Linear Regression: IMS Chapter 7</a></li></ul>
</li>
<li><a class="nav-link" href="#ethics-considerations-1"><span class="header-section-number">3.5</span>  Ethics Considerations</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/05-CorRegDesc.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/05-CorRegDesc.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to (Bio)Statistics</strong>" was written by Jo Hardin. It was last built on 2022-03-03.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
