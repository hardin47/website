<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 7 Inference for numerical data | Introduction to (Bio)Statistics</title>
<meta name="author" content="Jo Hardin">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.6.6/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4.9000/tabs.js"></script><script src="libs/bs3compat-0.2.4.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to (Bio)Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="rfunc.html"><span class="header-section-number">1</span> R functions</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="regdesc.html"><span class="header-section-number">3</span> Correlation &amp; Regression as Models</a></li>
<li><a class="" href="foundations-for-inference.html"><span class="header-section-number">4</span> Foundations for Inference</a></li>
<li><a class="" href="inference-for-categorical-data.html"><span class="header-section-number">5</span> Inference for categorical data</a></li>
<li><a class="" href="interlude-in-spring-2020.html"><span class="header-section-number">6</span> Interlude in Spring 2020</a></li>
<li><a class="active" href="inference-for-numerical-data.html"><span class="header-section-number">7</span> Inference for numerical data</a></li>
<li><a class="" href="reginf.html"><span class="header-section-number">8</span> Inference on Correlation &amp; Regression</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="inference-for-numerical-data" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Inference for numerical data<a class="anchor" aria-label="anchor" href="#inference-for-numerical-data"><i class="fas fa-link"></i></a>
</h1>
<!--
## 3/31/20 Agenda {#Mar31}
1. New statistics: mean, standard deviation, standard error of the mean
2. Sampling distribution of the sample mean
-->
<div id="important-measures-related-to-quantitative-numeric-variables" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Important measures related to quantitative (numeric) variables<a class="anchor" aria-label="anchor" href="#important-measures-related-to-quantitative-numeric-variables"><i class="fas fa-link"></i></a>
</h2>
<div id="quantitative-descriptives" class="section level3" number="7.1.1">
<h3>
<span class="header-section-number">7.1.1</span> Quantitative Descriptives<a class="anchor" aria-label="anchor" href="#quantitative-descriptives"><i class="fas fa-link"></i></a>
</h3>
<p>What measures can we look at to get a first sense of whether two groups are different (let alone substantially different enough for us to conclude a difference in a related population). We might look at what is called the <strong>Five Number Summary</strong>.</p>
<ul>
<li>
<strong>Five Number Summary</strong>: Min, Q1, Median, Q3, Max
<ul>
<li>Q1 = median of the values <em>below</em> the median</li>
<li>Q3 = median of the values <em>above</em> the median</li>
<li>IQR = Interquartile range (measure of spread/variability) = Q3 - Q1</li>
<li>1.5 x IQR rule for possible outliers: If an observation falls more than 1.5IQR outside of Q1 or Q3, flag the observation as a possible outlier.</li>
</ul>
</li>
<li>Boxplot
<ul>
<li>Box spans Q1 to Q3</li>
<li>Line in box marks median (M)</li>
<li>Perpendicular line extends from box to smallest and largest observations <em>within</em> 1.5IQR of Q1 and Q3.</li>
<li>Dots for observations outside of 1.5IQR</li>
</ul>
</li>
<li>Summaries often used when variable has a bell-shaped distribution</li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
\mbox{sample mean} &amp;=&amp; \overline{X} = \frac{1}{n} \sum_{i=1}^n X_i\\
\mbox{sample standard deviation} &amp;=&amp; s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2}\\
\mbox{sample variance} &amp;=&amp; s^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2
\end{eqnarray*}\]</span></p>
<p>Loosely, the standard deviation is the size of the typical deviation from the mean of the data set. Note that we divide by <span class="math inline">\(n-1\)</span> instead of by <span class="math inline">\(n\)</span> because the true deviation is defined as the average of the observations from the true mean <span class="math inline">\(\mu\)</span>, and, in fact, they will always be closer to <span class="math inline">\(\overline{X}\)</span> than to <span class="math inline">\(\mu\)</span>.</p>
</div>
<div id="mean1dist" class="section level3" number="7.1.2">
<h3>
<span class="header-section-number">7.1.2</span> Sampling distribution of a sample mean<a class="anchor" aria-label="anchor" href="#mean1dist"><i class="fas fa-link"></i></a>
</h3>
<p>As before, the <strong>Central Limit Theorem</strong> tells us that averages are normally distributed if the sample size is large enough. Here, that means:
<span class="math display">\[\overline{X} \sim N(\mu, \sigma/\sqrt{n})\]</span>
where <span class="math inline">\(SD(\overline{X}) = \sigma/\sqrt{n}\)</span> and <span class="math inline">\(SE(\overline{X}) = s/\sqrt{n}\)</span>. <span class="math inline">\(\mu\)</span> is the center of the <em>population</em> of observations from which the sample data were taken. <span class="math inline">\(\sigma\)</span> is the variability of the <em>population</em> of observations from which the sample data were taken.</p>
<p>As before, we won’t spend much time worried about the difference between <span class="math inline">\(SD(\overline{X})\)</span> and <span class="math inline">\(SE(\overline{X})\)</span>. Generally, we’ll only know / use <span class="math inline">\(SE(\overline{X}) = s/\sqrt{n}\)</span>. Typically, with quantitative variables, “large enough” is at least 30 or so observations.</p>
<p>Spend some time clicking through different datasets in the ICAM applet: <a href="http://www.rossmanchance.com/applets/OneSample.html?showBoth=1" class="uri">http://www.rossmanchance.com/applets/OneSample.html?showBoth=1</a></p>
<p>You should notice:</p>
<ul>
<li>If the population (or sample of data) is skewed, the sampling distribution of the sample mean is normal (bell-shaped) when the sample size is large.</li>
<li>The larger the sample size, the less variable the sampling distribution.</li>
<li>The sample size does <em>not</em> change the distribution of the dataset (the middle graph). The middle graph will always be a representation of the population graph (left side); although with small sample sizes, the middle graph is somewhat sparse.</li>
<li>In an actual data analysis, we <strong>only</strong> see the middle graph. We do not see the population graph (left side) or the sampling distribution (right side).</li>
</ul>
<!--
## 4/2/20 Agenda {#Apr2}
1. The t-distribution
2. Standardized t-score 
3. Hypothesis Testing & Confidence Intervals for one mean


## 4/7/20 Agenda {#Apr7}
1. Review of confidence interval for one mean
2. Prediction Interval for a future observation
-->
</div>
</div>
<div id="mean1inf" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> Inference for a single mean, <span class="math inline">\(\mu\)</span><a class="anchor" aria-label="anchor" href="#mean1inf"><i class="fas fa-link"></i></a>
</h2>
<div id="mathematical-model-for-distribution-of-the-sample-mean" class="section level3" number="7.2.1">
<h3>
<span class="header-section-number">7.2.1</span> Mathematical model for distribution of the sample mean<a class="anchor" aria-label="anchor" href="#mathematical-model-for-distribution-of-the-sample-mean"><i class="fas fa-link"></i></a>
</h3>
<p>Before coming up with the mathematical model appropriate for this section, it is important to notice that we almost never know the true variability of the data (i.e., <span class="math inline">\(\sigma\)</span>). Instead, we almost always have to estimate <span class="math inline">\(\sigma\)</span> using <span class="math inline">\(s\)</span>, the sample standard deviation. It turns out that when the estimate of the variability is used in the denominator, the sampling distribution becomes more variability (longer tails). Recall that it is the tails of the distribution in which we are the most interested, so we don’t want to get those wrong!!</p>
<p>If <span class="math inline">\(\sigma\)</span> is somehow known: <span class="math display">\[\frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \sim N(0,1)\]</span></p>
<p>But in the more typical situation where <span class="math inline">\(\sigma\)</span> is estimated using <span class="math inline">\(s\)</span>: <span class="math display">\[\frac{\overline{X} - \mu}{s/\sqrt{n}} \sim t_{df = n-1}\]</span></p>
<div id="hypothesis-testing-isrs-4.1" class="section level4" number="7.2.1.1">
<h4>
<span class="header-section-number">7.2.1.1</span> Hypothesis Testing (ISRS 4.1)<a class="anchor" aria-label="anchor" href="#hypothesis-testing-isrs-4.1"><i class="fas fa-link"></i></a>
</h4>
<p>If <span class="math inline">\(H_0: \mu = \mu_0\)</span> is true, then we know that: <span class="math display">\[\frac{\overline{X} - \mu}{s/\sqrt{n}} \sim t_{df = n-1}\]</span></p>
<p>That is, we can use the <span class="math inline">\(t_{df = n-1}\)</span> distribution to find the p-value for the test. Note, in R we we use the function <code>xpt</code> in the <code>mosaic</code> package.</p>
</div>
<div id="confidence-intervals-isrs-4.1.4" class="section level4" number="7.2.1.2">
<h4>
<span class="header-section-number">7.2.1.2</span> Confidence Intervals (ISRS 4.1.4)<a class="anchor" aria-label="anchor" href="#confidence-intervals-isrs-4.1.4"><i class="fas fa-link"></i></a>
</h4>
<p>In the setting where there is no null hypothesis statement and an interval estimate is needed, the interval is created in the exact same way as was done with proportions using: <span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot SE(\overline{X})\]</span></p>
<p>Which is the same thing as: <span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s/ \sqrt{n}\]</span></p>
</div>
<div id="predint" class="section level4" number="7.2.1.3">
<h4>
<span class="header-section-number">7.2.1.3</span> Prediction Intervals (ISCAM 2.6, not in ISRS)<a class="anchor" aria-label="anchor" href="#predint"><i class="fas fa-link"></i></a>
</h4>
<p>A prediction interval is <strong>different</strong> from a confidence interval!!! Remember that a confidence interval is a range of values that try to capture a <strong>parameter</strong>. A prediction interval is meant to capture 95% of future observations (see below for the example on healthy body temperatures). Note that in order to capture the variability in the observations, we combine the variability of the center of the interval (<span class="math inline">\(s/\sqrt{n}\)</span>) with the variability of the observations themselves (<span class="math inline">\(s\)</span>).</p>
<p>A <span class="math inline">\((1-\alpha)100%\)</span> prediction interval has a <span class="math inline">\((1-\alpha)\)</span> probability of capturing a new observation from the population.</p>
<p><span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s \sqrt{1 + \frac{1}{n}}\]</span></p>
</div>
</div>
<div id="example-healthy-body-temperature" class="section level3" number="7.2.2">
<h3>
<span class="header-section-number">7.2.2</span> Example: healthy body temperature<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Inv 2.5, Chance &amp;amp; Rossman, ISCAM&lt;/p&gt;"><sup>21</sup></a><a class="anchor" aria-label="anchor" href="#example-healthy-body-temperature"><i class="fas fa-link"></i></a>
</h3>
<p>The study at hand is meant to determine whether the average healthy body temperature is actually 98.6 F.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Conventional wisdom says that the reason 98.6 has hung around is because it translates to 35 C. Indeed, it it agreed that, to the nearest integer, the average healthy human body temperature is 37 C. But there is also some consensus that it is slightly lower than 37 C (if we are willing to use more significant digits). The idea is that we have hung on to 98.6 because the decimal &lt;em&gt;feels&lt;/em&gt; like a precise measurement. In reality, it is just the conversion from 37 C to F.&lt;/p&gt;"><sup>22</sup></a></p>
<blockquote>
<p>Body temperatures (oral temperatures using a digital thermometer) were recorded for healthy men and women, aged 18-40 years, who were volunteers in Shigella vaccine trials at the University of Maryland Center for Vaccine Development, Baltimore. For these adults, the mean body temperature was found to be 98.249 F with a standard deviation of 0.733 F.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Mackowiak, Wasserman, &amp;amp; Levine, &lt;em&gt;Journal of the American Medical Association&lt;/em&gt;, 1992&lt;/p&gt;"><sup>23</sup></a></p>
</blockquote>
<p>In order to work through the analysis it is imperative that we understand the data that was collected as part of the research.</p>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="28%">
<col width="33%">
<col width="33%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">center</th>
<th align="left">variability of data</th>
<th align="left">variability of sample means</th>
<th align="left">sample size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<span class="math inline">\(\overline{X} = 98.249\)</span> F</td>
<td align="left">
<span class="math inline">\(s = 0.733\)</span> F</td>
<td align="left"><span class="math inline">\(SE(\overline{X}) = \frac{s}{\sqrt{n}} = \frac{0.733}{\sqrt{130}} = 0.0643\)</span></td>
<td align="left"><span class="math inline">\(n=130\)</span></td>
</tr>
<tr class="even">
<td align="left">
<span class="math inline">\(\mu\)</span> = true ave healthy body temp (unknown!)</td>
<td align="left">
<span class="math inline">\(\sigma\)</span> = true sd of healthy body temps (unknown!)</td>
<td align="left">
<span class="math inline">\(SD(\overline{X}) = \frac{\sigma}{\sqrt{n}}\)</span> = unknown!</td>
<td align="left"></td>
</tr>
</tbody>
</table></div>
<div id="hypothesis-test-on-true-average-healthy-body-temperature" class="section level4" number="7.2.2.1">
<h4>
<span class="header-section-number">7.2.2.1</span> Hypothesis test on true average healthy body temperature<a class="anchor" aria-label="anchor" href="#hypothesis-test-on-true-average-healthy-body-temperature"><i class="fas fa-link"></i></a>
</h4>
<p>The first research question we want to ask is: how surprising would it be to select a group of 13 participants who have an average healthy body temperature of 98.249 F ?</p>
<p>The questions is set up perfectly for a hypothesis test!</p>
<p><span class="math inline">\(H_0: \mu = 98.6\)</span></p>
<p><span class="math inline">\(H_A: \mu \ne 98.6\)</span></p>
<p>We use the t-distribution to investigate the claim.</p>
<p><span class="math display">\[t-score = \frac{98.249 - 98.6}{0.733/\sqrt{130}} = -5.46\]</span></p>
<p>How likely is the standardized version of our test statistic to happen if the null hypothesis is true? Well, if <span class="math inline">\(H_0\)</span> is true, then the t-statistics should have a t-distribution. So we can use the t-distribution to find the p-value (recall that the p-value is the probability of the data or more extreme if <span class="math inline">\(H_0\)</span> is true.)</p>
<p>The test statistic is -5.46, and even a two-sided p-value (the area doubled) is way less than 0.001.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">2</span> <span class="op">*</span> <span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/pdist.html">xpt</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.46</span>, df <span class="op">=</span> <span class="fl">129</span>, ncp <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-1-1.png" width="480" style="display: block; margin: auto;"></div>
<pre><code>## [1] 2.354246e-07</code></pre>
</div>
<div id="confidence-interval-for-true-average-healthy-body-temperature" class="section level4" number="7.2.2.2">
<h4>
<span class="header-section-number">7.2.2.2</span> Confidence interval for true average healthy body temperature<a class="anchor" aria-label="anchor" href="#confidence-interval-for-true-average-healthy-body-temperature"><i class="fas fa-link"></i></a>
</h4>
<p>Possibly more interesting is the confidence interval which would tell us a range of plausible values for healthy body temperatures.</p>
<p>The confidence interval is given by the following formula: <span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s/ \sqrt{n}\]</span></p>
<p>and is calculated to be (98.121, 98.376). That is, we are 95% confident that the true average healthy body temperature is somewhere between 98.121 F and 98.376 F. Note that 98.6 F is not in the interval!!! Wow.</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/qdist.html">xqt</a></span><span class="op">(</span><span class="fl">.975</span>, df <span class="op">=</span> <span class="fl">129</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></div>
<pre><code>## [1] 1.978524</code></pre>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">98.249</span> <span class="op">-</span> <span class="fl">1.9785</span> <span class="op">*</span> <span class="fl">0.733</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 98.12181</code></pre>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">98.249</span> <span class="op">+</span> <span class="fl">1.9785</span> <span class="op">*</span> <span class="fl">0.733</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 98.37619</code></pre>
</div>
<div id="prediction-interval-for-individual-healthy-body-temperatures" class="section level4" number="7.2.2.3">
<h4>
<span class="header-section-number">7.2.2.3</span> Prediction interval for individual healthy body temperatures<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Inv 2.6, Chance &amp;amp; Rossman, ISCAM&lt;/p&gt;"><sup>24</sup></a><a class="anchor" aria-label="anchor" href="#prediction-interval-for-individual-healthy-body-temperatures"><i class="fas fa-link"></i></a>
</h4>
<p>Note the fundamental difference between the <strong>goal</strong> of the confidence interval above and the <strong>goal</strong> of the prediction interval calculated in this section. A confidence interval is an interval of plausible values for a population parameter. A prediction interval is for a future <em>individual</em> observations.</p>
<p>A <span class="math inline">\((1-\alpha)100%\)</span> prediction interval has a <span class="math inline">\((1-\alpha)\)</span> probability of capturing a new observation from the population.</p>
<p>Here, a 95% prediction interval for healthy body temperatures can be calculated using:</p>
<p><span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s \cdot \sqrt{1 + \frac{1}{n}}\]</span></p>
<p><span class="math display">\[98.249 \pm t_{129}^* \cdot 0.733 \cdot \sqrt{1 + \frac{1}{130}}\]</span></p>
<p>Which gives a 95% prediction interval of (96.79 F, 99.70 F). There is a 0.95 probability that if I reach into the population, the person selected will have a healthy body temperature between 96.79 F and 99.70 F. Said differently, 95% of the individuals in the population will have a healthy body temperature between 96.79 F and 99.70 F (a <strong>much</strong> wider range of values than the confidence interval!)</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/qdist.html">xqt</a></span><span class="op">(</span><span class="fl">.975</span>, df <span class="op">=</span> <span class="fl">129</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></div>
<pre><code>## [1] 1.978524</code></pre>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">98.249</span> <span class="op">-</span> <span class="fl">1.9785</span><span class="op">*</span><span class="fl">0.733</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">130</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 96.79319</code></pre>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fl">98.249</span> <span class="op">+</span> <span class="fl">1.9785</span><span class="op">*</span><span class="fl">0.733</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">130</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 99.70481</code></pre>
<!--
## 4/9/20 Agenda {#Apr9}
under the random sample model:

1. Sampling distribution of $\overline{X}_1 - \overline{X}_2$
2. Hypothesis testing (and CI) of $\mu_1 - \mu_2$

## 4/14/20 Agenda {#Apr14}
under the random allocation model:

1. Sampling distribution of $\overline{X}_1 - \overline{X}_2$
2. Confidence interval (and HT) for $\mu_1 - \mu_2$
-->
</div>
</div>
</div>
<div id="mean2inf" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> Comparing two independent means<a class="anchor" aria-label="anchor" href="#mean2inf"><i class="fas fa-link"></i></a>
</h2>
<p>It turns out that in <em>both</em> the setting where random samples are taken (e.g., NBA salaries) and the setting where random allocation is done (e.g., sleep deprivation), the t-distribution describes the distribution of the test statistic quite well. Note that the variability associated with the difference in means uses the variability of both the samples (and their individual sample sizes!).</p>
<p><span class="math display">\[\begin{eqnarray*}
\mbox{parameter} &amp;=&amp; \mu_1 - \mu_2\\
\mbox{statistic} &amp;=&amp; \overline{X}_1 - \overline{X}_2\\
SE_{\overline{X}_1 - \overline{X}_2} &amp;=&amp; ?????
\end{eqnarray*}\]</span></p>
<p>In general, the math is done on the variance (which is just the squared standard deviations).
<span class="math display">\[\begin{eqnarray*}
var(A - B) &amp;=&amp; var(A) + var(B)\\
var(\overline{X}_1 - \overline{X}_2) &amp;=&amp; var(\overline{X}_1) + var(\overline{X}_2)\\
&amp;=&amp; \sigma^2_1 / n_1 + \sigma^2_2 / n_2\\
SE(\overline{X}_1 - \overline{X}_2) &amp;=&amp; \sqrt{s^2_1 / n_1 + s^2_2 / n_2}\\
\end{eqnarray*}\]</span></p>
<p>The above methods can be used when the samples are of different sizes and when the variability in the two samples is quite different (<span class="math inline">\(s_1 \ne s_2\)</span>). If we use the above procedures, the exact degrees of freedom are not straightforward to calculate:</p>
<p><span class="math display">\[\begin{eqnarray*}
df &amp;=&amp; \frac{ \bigg(\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2} \bigg)^2}{ \bigg[ \frac{(s^2_1/n_1)^2}{n_1 - 1} + \frac{(s^2_2/n_2)^2}{n_2 - 1} \bigg] }\ \ \ \ \ \ \ \mbox{Yikes!!!!}\\
df &amp;\approx&amp; \min \{ n_1 - 1, n_2 -1 \} \\
\end{eqnarray*}\]</span></p>
<p>With the SE appropriately defined, the hypothesis test and confidence interval follow the methods from earlier in the semester.</p>
<p><span class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span><br><span class="math inline">\(H_A: \mu_1 - \mu_2 \ne 0\)</span></p>
<p><strong>When <span class="math inline">\(H_0\)</span> is true</strong>:</p>
<p><span class="math display">\[\begin{eqnarray*}
t &amp;=&amp; \frac{(\overline{X}_1 - \overline{X}_2) - (\mu_1 - \mu_2)_0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}}\\
&amp;=&amp; \frac{(\overline{X}_1 - \overline{X}_2) - 0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}}\\
&amp;\sim&amp; t_{\min \{ n_1 - 1, n_2 -1 \} }
\end{eqnarray*}\]</span></p>
<p>Which means that the <span class="math inline">\(t_{\min \{ n_1 - 1, n_2 -1 \} }\)</span>-distribution can be used to find a p-value associated with the t-score:
<span class="math display">\[\mbox{t-score} = \frac{(\overline{X}_1 - \overline{X}_2) - 0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}}.\]</span></p>
<p>Additionally, a <span class="math inline">\((1-\alpha)100\)</span>% confidence interval for <span class="math inline">\((\mu_1 - \mu_2)\)</span> can be found by computing:</p>
<p><span class="math display">\[(\overline{X}_1 - \overline{X}_2) \pm t_{\min \{ n_1 - 1, n_2 -1 \} }^* \cdot \sqrt{s_1^2 / n_1 + s_2^2 / n_2}.\]</span></p>
<!--
$$(\overline{X}_1 - \overline{X}_2) ~ \sim N\bigg( (\mu_1 - \mu_2), \sqrt{\sigma_1^2 / n_1 + \sigma_2^2 / n_2} \bigg)$$

$$\mbox{t-score} = \frac{(\overline{X}_1 - \overline{X}_2) - 0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}} \sim t_{\min \{ n_1 - 1, n_2 -1 \} }$$


Unfortunately, however Welch's t-test is not used as often as other t-tests (though there is research to show that Welch's t-test should be the default).  \\

\medskip
\noindent
In particular, if the standard errors are reasonably similar ($\sigma_1 \approx \sigma_2$), a more powerful test is given by:
\begin{eqnarray*}
SE(\overline{X}_1 - \overline{X}_2) &=& \sqrt{s^2_p (1/ n_1 + 1 / n_2)}\\
s^2_p &=& \frac{(n_1-1) s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 -2}\\4
df &=& n_1 + n_2 - 2
\end{eqnarray*}
-->
</div>
<div id="r-code-for-inference-on-1-or-2-means." class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> R code for inference on 1 or 2 means.<a class="anchor" aria-label="anchor" href="#r-code-for-inference-on-1-or-2-means."><i class="fas fa-link"></i></a>
</h2>
<p>Above, R is used primarily as a calculator and a way to find the appropriate values from the t-distribution (using <code><a href="https://projectmosaic.github.io/mosaic/reference/pdist.html">mosaic::xpt</a></code> and <code><a href="https://projectmosaic.github.io/mosaic/reference/qdist.html">mosaic::xqt</a></code> <span class="math inline">\(\rightarrow\)</span> note that along with the first argument (either a probability or a place on the x-axis) it is important to add the degrees of freedom <code>df</code> and possibly the argument <code>ncp=0</code> which centers the graph at zero).</p>
<p>Consider the teacher salary data available in the OpenIntro textbook.</p>
<blockquote>
<p>This data set contains teacher salaries from 2009-2010 for 71 teachers employed by the St. Louis Public School in Michigan, as well as several covariates.
Posted on opendata.socrata.com by Jeff Kowalski. Original source: <a href="http://stlouis.edzone.net" class="uri">http://stlouis.edzone.net</a></p>
</blockquote>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">teachers</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"https://www.openintro.org/data/tab-delimited/teacher.txt"</span>, 
                       delim<span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></code></pre></div>
<div id="t.test" class="section level3" number="7.4.1">
<h3>
<span class="header-section-number">7.4.1</span> <code>t.test()</code><a class="anchor" aria-label="anchor" href="#t.test"><i class="fas fa-link"></i></a>
</h3>
<p>The function which is typically used to do t-tests is the function <code><a href="https://projectmosaic.github.io/mosaic/reference/ttest.html">t.test()</a></code>. Note that the <code><a href="https://projectmosaic.github.io/mosaic/reference/ttest.html">t.test()</a></code> function requires a complete dataset, not just the summary statistics. However, the <code><a href="https://projectmosaic.github.io/mosaic/reference/ttest.html">t.test()</a></code> can be used to do any of the variety of tests we’ve seen (and the ones we haven’t seen!): one sample t-test, two independent samples t-test (with or without equal variances), paired t-test.</p>
<div id="one-sample-t-test" class="section level4" number="7.4.1.1">
<h4>
<span class="header-section-number">7.4.1.1</span> One sample t-test<a class="anchor" aria-label="anchor" href="#one-sample-t-test"><i class="fas fa-link"></i></a>
</h4>
<p>For example, we might be interested in testing whether the average salary (of all teachers in St Louis) is above $47,000 a year. The p-value is extremely small. We reject <span class="math inline">\(H_0\)</span>. That is, we can claim that the true average base salary is above $47,000. (Note, to calculate a CI, use <code>alternative = "two.sided"</code>.)</p>
<p><span class="math inline">\(H_0: \mu = 47,000\)</span></p>
<p><span class="math inline">\(H_A: \mu &gt; 47,000\)</span></p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/ttest.html">t.test</a></span><span class="op">(</span><span class="va">teachers</span><span class="op">$</span><span class="va">base</span>, mu <span class="op">=</span> <span class="fl">47000</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  teachers$base
## t = 7.9466, df = 70, p-value = 1.146e-11
## alternative hypothesis: true mean is greater than 47000
## 95 percent confidence interval:
##  54440.82      Inf
## sample estimates:
## mean of x 
##  56415.96</code></pre>
</div>
<div id="two-independent-samples-t-test" class="section level4" number="7.4.1.2">
<h4>
<span class="header-section-number">7.4.1.2</span> Two independent samples t-test<a class="anchor" aria-label="anchor" href="#two-independent-samples-t-test"><i class="fas fa-link"></i></a>
</h4>
<p>Or, maybe interest is in knowing whether the base salary for teachers with a BA degree is less than those with an MA degree, on average. Note, <span class="math inline">\(\mu\)</span> denotes the average salary in the population group denoted by the subscript. The p-value is 0.442, so we would not reject the null hypothesis. (Note, to calculate a CI, use <code>alternative = "two.sided"</code>.)</p>
<p><span class="math inline">\(H_0: \mu_{BA} = \mu_{MA}\)</span></p>
<p><span class="math inline">\(H_A: \mu_{BA} &lt; \mu_{MA}\)</span></p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/ttest.html">t.test</a></span><span class="op">(</span><span class="va">base</span> <span class="op">~</span> <span class="va">degree</span>, alternative <span class="op">=</span> <span class="st">"less"</span>, data <span class="op">=</span> <span class="va">teachers</span><span class="op">)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  base by degree
## t = -0.14639, df = 65.238, p-value = 0.442
## alternative hypothesis: true difference in means is less than 0
## 95 percent confidence interval:
##      -Inf 3664.912
## sample estimates:
## mean in group BA mean in group MA 
##         56257.10         56609.56</code></pre>
</div>
</div>
<div id="bootstrapping-in-r" class="section level3" number="7.4.2">
<h3>
<span class="header-section-number">7.4.2</span> Bootstrapping in R<a class="anchor" aria-label="anchor" href="#bootstrapping-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>Notice that the simulation syntax is almost identical to that which we covered when we were working with proportions. Also, notice that the computational approach gives almost identical answers to the mathematical model (t-distribution) from above.</p>
<div id="one-sample-bootstrapping-on-mean" class="section level4" number="7.4.2.1">
<h4>
<span class="header-section-number">7.4.2.1</span> One sample bootstrapping on mean<a class="anchor" aria-label="anchor" href="#one-sample-bootstrapping-on-mean"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span>
<span class="co"># calculate the observed test statistic</span>
<span class="co"># note that we could use `stat = "median"` or `stat = "t"`</span>
<span class="op">(</span> <span class="va">x_bar_base</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">base</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##     stat
##    &lt;dbl&gt;
## 1 56416.</code></pre>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create the null sampling distribution</span>
<span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">base</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"point"</span>, mu <span class="op">=</span> <span class="fl">47000</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span>

<span class="co"># visualize the null sampling distribution</span>
<span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_dist</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-7-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate the p-value</span>
<span class="va">null_dist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1       0</code></pre>
</div>
<div id="two-independent-samples-comparing-two-means" class="section level4" number="7.4.2.2">
<h4>
<span class="header-section-number">7.4.2.2</span> Two independent samples comparing two means<a class="anchor" aria-label="anchor" href="#two-independent-samples-comparing-two-means"><i class="fas fa-link"></i></a>
</h4>
<p>p-value is now 0.464 (very close to 0.442 given by the smooth t-distribution curve).</p>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span>
<span class="co"># calculate the observed test statistic</span>
<span class="op">(</span> <span class="va">diff_x_bar_base</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">base</span> <span class="op">~</span> <span class="va">degree</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MA"</span>, <span class="st">"BA"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##    stat
##   &lt;dbl&gt;
## 1  352.</code></pre>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create the null sampling distribution</span>
<span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">base</span> <span class="op">~</span> <span class="va">degree</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span><span class="st">"permute"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MA"</span>, <span class="st">"BA"</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># visualize the null sampling distribution</span>
<span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_dist</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">diff_x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate the p-value</span>
<span class="va">null_dist</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">diff_x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 1 x 1
##   p_value
##     &lt;dbl&gt;
## 1   0.454</code></pre>
</div>
</div>
<div id="nba-salaries-example-from-iscam-inv-4.2" class="section level3" number="7.4.3">
<h3>
<span class="header-section-number">7.4.3</span> NBA Salaries example from ISCAM Inv 4.2<a class="anchor" aria-label="anchor" href="#nba-salaries-example-from-iscam-inv-4.2"><i class="fas fa-link"></i></a>
</h3>
<p>There is R code in the ISCAM book. I’ve written the series of steps in a slightly different way with the same results.</p>
<div id="eda" class="section level4" number="7.4.3.1">
<h4>
<span class="header-section-number">7.4.3.1</span> EDA<a class="anchor" aria-label="anchor" href="#eda"><i class="fas fa-link"></i></a>
</h4>
<p>Before thinking about inference, let’s look at the population (for 2017-18). The information for today is the population because it includes the salaries of all NBA players in 2017. We can see that in this particular year, the average salary in the Western conference is slightly higher.</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NBAsalary</span> <span class="op">&lt;-</span> <span class="fu">read_delim</span><span class="op">(</span><span class="st">"http://www.rossmanchance.com/iscam3/data/NBASalaries2017.txt"</span>, delim <span class="op">=</span> <span class="st">"\t"</span>, escape_double <span class="op">=</span> <span class="cn">FALSE</span>, trim_ws <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>


<span class="fu">ggplot</span><span class="op">(</span><span class="va">NBAsalary</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_boxplot</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">conference</span>, y <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-9-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">NBAsalary</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>fill <span class="op">=</span> <span class="va">conference</span>, x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-9-2.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">ggplot</span><span class="op">(</span><span class="va">NBAsalary</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span> <span class="va">conference</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-9-3.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NBAsalary</span> <span class="op">%&gt;%</span>
  <span class="fu">group_by</span><span class="op">(</span><span class="va">conference</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarize</span><span class="op">(</span>mu <span class="op">=</span> <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">sd</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, N <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">min</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">max</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">median</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 2 x 7
##   conference    mu sigma     N `min(salary)` `max(salary)` `median(salary)`
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
## 1 eastern     6.61  7.01   227        0.0577          33.3             3.81
## 2 western     7.42  7.76   221        0.0320          34.4             4</code></pre>
</div>
<div id="sampling-distribution-for-one-mean" class="section level4" number="7.4.3.2">
<h4>
<span class="header-section-number">7.4.3.2</span> Sampling distribution for one mean<a class="anchor" aria-label="anchor" href="#sampling-distribution-for-one-mean"><i class="fas fa-link"></i></a>
</h4>
<p>Before considering how the sample means vary, let’s visualize samples from each conference.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NBAsalary</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"eastern"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"eastern salary"</span><span class="op">)</span>

<span class="va">NBAsalary</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"western"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> 
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">xlab</span><span class="op">(</span><span class="st">"western salary"</span><span class="op">)</span></code></pre></div>
<p><img src="04-InfNum_files/figure-html/unnamed-chunk-10-1.png" width="768" style="display: block; margin: auto;"><img src="04-InfNum_files/figure-html/unnamed-chunk-10-2.png" width="768" style="display: block; margin: auto;"></p>
<p>One way to think about how the difference in means varies is to first visualize the variability in the distribution for a single mean (i.e., from one conference). Let’s look at the variability in the Eastern conference as well as the variability in the Western conference.</p>
<p>Note that from the population analysis above (full set of observations), we see that <span class="math inline">\(\sigma \approx 7\)</span>. So the histograms below should have a standard deviation of close to <span class="math inline">\(\sigma / \sqrt{20} = 1.5\)</span>. Do they?</p>
<p>Are the two histograms centered at the same place? Should they be?</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NBAsalary</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"eastern"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>, reps <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarize</span><span class="op">(</span>mean_sal <span class="op">=</span> <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">mean_sal</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-11-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">NBAsalary</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"western"</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>, reps <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">summarize</span><span class="op">(</span>mean_sal <span class="op">=</span> <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">mean_sal</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-11-2.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="sampling-distribution-for-two-means" class="section level4" number="7.4.3.3">
<h4>
<span class="header-section-number">7.4.3.3</span> Sampling distribution for two means<a class="anchor" aria-label="anchor" href="#sampling-distribution-for-two-means"><i class="fas fa-link"></i></a>
</h4>
<p>Note: the code selects 20 random salaries from the Eastern NBA conference and 20 random salaries from the Western NBA conference. Using those two different samples, a t-statistic is selected. The whole process is repeated 1000 times.</p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4747</span><span class="op">)</span>

<span class="va">t_salaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>meandiff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>, tstat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span>
  
  <span class="va">one_t</span><span class="op">&lt;-</span> <span class="va">NBAsalary</span> <span class="op">%&gt;%</span>
    <span class="fu">group_by</span><span class="op">(</span><span class="va">conference</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">sample_n</span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">summarize</span><span class="op">(</span>mn <span class="op">=</span> <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">mean</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://projectmosaic.github.io/mosaic/reference/aggregating.html">sd</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu">n</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">pivot_wider</span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">conference</span>, values_from <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">summarize</span><span class="op">(</span>meandiff <span class="op">=</span> <span class="op">(</span><span class="va">mn_eastern</span> <span class="op">-</span> <span class="va">mn_western</span><span class="op">)</span>, 
              tstat <span class="op">=</span> <span class="op">(</span><span class="va">mn_eastern</span> <span class="op">-</span> <span class="va">mn_western</span><span class="op">)</span> <span class="op">/</span> 
                <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sd_eastern</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_eastern</span> <span class="op">+</span> <span class="va">sd_western</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_western</span><span class="op">)</span><span class="op">)</span> 

  <span class="va">t_salaries</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">one_t</span>
<span class="op">}</span>


<span class="va">t_salaries</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">meandiff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb180"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">t_salaries</span> <span class="op">%&gt;%</span>
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_histogram</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x<span class="op">=</span><span class="va">tstat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_vline</span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-12-2.png" width="480" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="reflection-questions-4" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Reflection Questions<a class="anchor" aria-label="anchor" href="#reflection-questions-4"><i class="fas fa-link"></i></a>
</h2>
<p>The reflection questions below that we will not cover are marked with an asterisk *.</p>
<div id="quantitative-variable-ims-section-7.1" class="section level3" number="7.5.1">
<h3>
<span class="header-section-number">7.5.1</span> 1 quantitative variable: IMS Section 7.1<a class="anchor" aria-label="anchor" href="#quantitative-variable-ims-section-7.1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>What changed about the studies (data structure) from Chapters 2 &amp; 3?</li>
<li>What is the statistic of interest now? What is the parameter of interest?</li>
<li>What is the difference between the distribution of the data and the distribution of the statistic? There is a theoretical difference as well as a computational difference.</li>
<li>What is the limiting sampling distribution of the statistic? (Note, the answer here is for big samples, that is the Central <strong>Limit</strong> Theorem works only where there is a limit… i.e., the sample size is big.)</li>
<li>If interest is in a statistics other than the sample mean, what is a tool we can use for finding the alternative statistic’s sampling distribution?</li>
<li><ul>
<li>Explain the intuition behind bootstrapping.</li>
</ul></li>
<li><ul>
<li>Explain how the SE for the statistic is calculated using bootstrapping.</li>
</ul></li>
<li>What is the difference between a normal distribution and a t distribution?</li>
<li>When do we use a z and when do we use a t?</li>
<li>When would you use a confidence interval and when would you use a hypothesis test?</li>
<li>What different information does a boxplot give versus a histogram?</li>
</ol>
</div>
<div id="means-1-quantitative-variable-1-binary-variable-ims-section-7.2" class="section level3" number="7.5.2">
<h3>
<span class="header-section-number">7.5.2</span> 2 means (1 quantitative variable, 1 binary variable): IMS Section 7.2<a class="anchor" aria-label="anchor" href="#means-1-quantitative-variable-1-binary-variable-ims-section-7.2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>What changed about the studies (data structure) from section 4.1?</li>
<li>What is the statistic of interest now? What is the parameter of interest?</li>
<li>What is the sampling distribution for the statistic of interest?</li>
<li>How is the t-distribution become relevant?</li>
<li>What are degrees of freedom in general? What are the actual degrees of freedom for the test in section 4.3?</li>
<li><ul>
<li>How is the null mechanism different across the three analysis methods in section 3.2: randomization test, two-sample t-test, random sampling test (n.b. this is also called the parametric bootstrap)?</li>
</ul></li>
<li>How do you create a CI? How do you interpret the CI?</li>
<li>What if your data are NOT normal? What strategies can you try out?</li>
</ol>
<div id="paired-sample-difference-in-means-ims-section-7.3" class="section level4" number="7.5.2.1">
<h4>
<span class="header-section-number">7.5.2.1</span> Paired sample, difference in means: IMS Section 7.3<a class="anchor" aria-label="anchor" href="#paired-sample-difference-in-means-ims-section-7.3"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>What changed about the studies (data structure) in section 4.2 as compared with 4.1 or 4.3?</li>
<li>What is the statistic of interest now? What is the parameter of interest?</li>
<li>What is the sampling distribution for the statistic of interest?</li>
<li>What benefit does pairing have on the analysis?</li>
<li>What happens if a paired study is analyzed as if it were an independent two sample study? (What happens to the p-value? What happens to the CI?)</li>
<li>What is the easiest way to think of / analyze paired data?</li>
</ol>
</div>
<div id="not-covering-in-spring-2021-anova-ims-section-7.5" class="section level4" number="7.5.2.2">
<h4>
<span class="header-section-number">7.5.2.2</span> * (not covering in Spring 2021) ANOVA: IMS Section 7.5<a class="anchor" aria-label="anchor" href="#not-covering-in-spring-2021-anova-ims-section-7.5"><i class="fas fa-link"></i></a>
</h4>
<ol style="list-style-type: decimal">
<li>Why are these tests called ANalysis Of VAriance (ANOVA)?</li>
<li>Describe the variability in the numerator and the variability in the denominator. What does each measure?</li>
<li>What are the null and alternative hypotheses for ANOVA?</li>
<li>What features of the data affect the power of the test? What does power mean here?</li>
<li>What are the technical conditions? Why do we need equal variances here?</li>
</ol>
</div>
</div>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="interlude-in-spring-2020.html"><span class="header-section-number">6</span> Interlude in Spring 2020</a></div>
<div class="next"><a href="reginf.html"><span class="header-section-number">8</span> Inference on Correlation &amp; Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#inference-for-numerical-data"><span class="header-section-number">7</span> Inference for numerical data</a></li>
<li>
<a class="nav-link" href="#important-measures-related-to-quantitative-numeric-variables"><span class="header-section-number">7.1</span> Important measures related to quantitative (numeric) variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#quantitative-descriptives"><span class="header-section-number">7.1.1</span> Quantitative Descriptives</a></li>
<li><a class="nav-link" href="#mean1dist"><span class="header-section-number">7.1.2</span> Sampling distribution of a sample mean</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#mean1inf"><span class="header-section-number">7.2</span> Inference for a single mean, \(\mu\)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#mathematical-model-for-distribution-of-the-sample-mean"><span class="header-section-number">7.2.1</span> Mathematical model for distribution of the sample mean</a></li>
<li><a class="nav-link" href="#example-healthy-body-temperature"><span class="header-section-number">7.2.2</span> Example: healthy body temperature21</a></li>
</ul>
</li>
<li><a class="nav-link" href="#mean2inf"><span class="header-section-number">7.3</span> Comparing two independent means</a></li>
<li>
<a class="nav-link" href="#r-code-for-inference-on-1-or-2-means."><span class="header-section-number">7.4</span> R code for inference on 1 or 2 means.</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#t.test"><span class="header-section-number">7.4.1</span> t.test()</a></li>
<li><a class="nav-link" href="#bootstrapping-in-r"><span class="header-section-number">7.4.2</span> Bootstrapping in R</a></li>
<li><a class="nav-link" href="#nba-salaries-example-from-iscam-inv-4.2"><span class="header-section-number">7.4.3</span> NBA Salaries example from ISCAM Inv 4.2</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reflection-questions-4"><span class="header-section-number">7.5</span> Reflection Questions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#quantitative-variable-ims-section-7.1"><span class="header-section-number">7.5.1</span> 1 quantitative variable: IMS Section 7.1</a></li>
<li><a class="nav-link" href="#means-1-quantitative-variable-1-binary-variable-ims-section-7.2"><span class="header-section-number">7.5.2</span> 2 means (1 quantitative variable, 1 binary variable): IMS Section 7.2</a></li>
</ul>
</li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/04-InfNum.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/04-InfNum.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to (Bio)Statistics</strong>" was written by Jo Hardin. It was last built on 2021-03-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
