<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 6 Inference for numerical data | Introduction to (Bio)Statistics</title>
<meta name="author" content="Jo Hardin">
<meta name="description" content="6.1 Important measures related to quantitative (numeric) variables  6.1.1 Quantitative Descriptives What measures can we look at to get a first sense of whether two groups are different (let alone...">
<meta name="generator" content="bookdown 0.31 with bs4_book()">
<meta property="og:title" content="Chapter 6 Inference for numerical data | Introduction to (Bio)Statistics">
<meta property="og:type" content="book">
<meta property="og:description" content="6.1 Important measures related to quantitative (numeric) variables  6.1.1 Quantitative Descriptives What measures can we look at to get a first sense of whether two groups are different (let alone...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 6 Inference for numerical data | Introduction to (Bio)Statistics">
<meta name="twitter:description" content="6.1 Important measures related to quantitative (numeric) variables  6.1.1 Quantitative Descriptives What measures can we look at to get a first sense of whether two groups are different (let alone...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.2/transition.js"></script><script src="libs/bs3compat-0.4.2/tabs.js"></script><script src="libs/bs3compat-0.4.2/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script type="text/x-mathjax-config">
    const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
    for (let popover of popovers){
      const div = document.createElement('div');
      div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
      div.innerHTML = popover.getAttribute('data-content');
      
      // Will this work with TeX on its own line?
      var has_math = div.querySelector("span.math");
      if (has_math) {
        document.body.appendChild(div);
      	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
      	MathJax.Hub.Queue(function(){
          popover.setAttribute('data-content', div.innerHTML);
      	})
      }
    }
    </script><link rel="shortcut icon" href="figs/favicon.ico">
<script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to (Bio)Statistics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Class Information</a></li>
<li><a class="" href="rfunc.html"><span class="header-section-number">1</span> R functions</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="regdesc.html"><span class="header-section-number">3</span> Correlation &amp; Regression as Models</a></li>
<li><a class="" href="foundations-for-inference.html"><span class="header-section-number">4</span> Foundations for Inference</a></li>
<li><a class="" href="inference-for-categorical-data.html"><span class="header-section-number">5</span> Inference for categorical data</a></li>
<li><a class="active" href="inference-for-numerical-data.html"><span class="header-section-number">6</span> Inference for numerical data</a></li>
<li><a class="" href="reginf.html"><span class="header-section-number">7</span> Inference on Correlation &amp; Regression</a></li>
<li><a class="" href="interlude-in-spring-2020.html"><span class="header-section-number">8</span> Interlude in Spring 2020</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/hardin47/website">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="inference-for-numerical-data" class="section level1" number="6">
<h1>
<span class="header-section-number">6</span> Inference for numerical data<a class="anchor" aria-label="anchor" href="#inference-for-numerical-data"><i class="fas fa-link"></i></a>
</h1>
<!--
## 3/31/20 Agenda {#Mar31}
1. New statistics: mean, standard deviation, standard error of the mean
2. Sampling distribution of the sample mean
-->
<div id="important-measures-related-to-quantitative-numeric-variables" class="section level2" number="6.1">
<h2>
<span class="header-section-number">6.1</span> Important measures related to quantitative (numeric) variables<a class="anchor" aria-label="anchor" href="#important-measures-related-to-quantitative-numeric-variables"><i class="fas fa-link"></i></a>
</h2>
<div id="quantitative-descriptives" class="section level3" number="6.1.1">
<h3>
<span class="header-section-number">6.1.1</span> Quantitative Descriptives<a class="anchor" aria-label="anchor" href="#quantitative-descriptives"><i class="fas fa-link"></i></a>
</h3>
<p>What measures can we look at to get a first sense of whether two groups are different (let alone substantially different enough for us to conclude a difference in a related population). We might look at what is called the <strong>Five Number Summary</strong>.</p>
<ul>
<li>
<strong>Five Number Summary</strong>: Min, Q1, Median, Q3, Max
<ul>
<li>Q1 = median of the values <em>below</em> the median</li>
<li>Q3 = median of the values <em>above</em> the median</li>
<li>IQR = Interquartile range (measure of spread/variability) = Q3 - Q1</li>
<li>1.5 x IQR rule for possible outliers: If an observation falls more than 1.5IQR outside of Q1 or Q3, flag the observation as a possible outlier.</li>
</ul>
</li>
<li>Boxplot
<ul>
<li>Box spans Q1 to Q3</li>
<li>Line in box marks median (M)</li>
<li>Perpendicular line extends from box to smallest and largest observations <em>within</em> 1.5IQR of Q1 and Q3.</li>
<li>Dots for observations outside of 1.5IQR</li>
</ul>
</li>
<li>Summaries often used when variable has a bell-shaped distribution</li>
</ul>
<p><span class="math display">\[
\begin{align*}
\mbox{sample mean} &amp;= \overline{X} = \frac{1}{n} \sum_{i=1}^n X_i\\
\mbox{sample standard deviation} &amp;= s = \sqrt{\frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2}\\
\mbox{sample variance} &amp;= s^2 = \frac{1}{n-1} \sum_{i=1}^n (X_i - \overline{X})^2
\end{align*}
\]</span></p>
<p>Loosely, the standard deviation is the size of the typical deviation from the mean of the data set. Note that we divide by <span class="math inline">\(n-1\)</span> instead of by <span class="math inline">\(n\)</span> because the true deviation is defined as the average of the observations from the true mean <span class="math inline">\(\mu\)</span>, and, in fact, they will always be closer to <span class="math inline">\(\overline{X}\)</span> than to <span class="math inline">\(\mu\)</span>.</p>
</div>
<div id="mean1dist" class="section level3" number="6.1.2">
<h3>
<span class="header-section-number">6.1.2</span> Sampling distribution of a sample mean<a class="anchor" aria-label="anchor" href="#mean1dist"><i class="fas fa-link"></i></a>
</h3>
<p>As before, the <strong>Central Limit Theorem</strong> tells us that averages are normally distributed if the sample size is large enough. Here, that means:
<span class="math display">\[\overline{X} \sim N(\mu, \sigma/\sqrt{n})\]</span>
where <span class="math inline">\(SD(\overline{X}) = \sigma/\sqrt{n}\)</span> and <span class="math inline">\(SE(\overline{X}) = s/\sqrt{n}\)</span>. <span class="math inline">\(\mu\)</span> is the center of the <em>population</em> of observations from which the sample data were taken. <span class="math inline">\(\sigma\)</span> is the variability of the <em>population</em> of observations from which the sample data were taken.</p>
<p>As before, we won’t spend much time worried about the difference between <span class="math inline">\(SD(\overline{X})\)</span> and <span class="math inline">\(SE(\overline{X})\)</span>. Generally, we’ll only know / use <span class="math inline">\(SE(\overline{X}) = s/\sqrt{n}\)</span>. Typically, with quantitative variables, “large enough” is at least 30 or so observations.</p>
<p>Spend some time clicking through different datasets in the ICAM applet: <a href="http://www.rossmanchance.com/applets/OneSample.html?showBoth=1" class="uri">http://www.rossmanchance.com/applets/OneSample.html?showBoth=1</a></p>
<p>You should notice:</p>
<ul>
<li>If the population (or sample of data) is skewed, the sampling distribution of the sample mean is normal (bell-shaped) when the sample size is large.</li>
<li>The larger the sample size, the less variable the sampling distribution.</li>
<li>The sample size does <em>not</em> change the distribution of the dataset (the middle graph). The middle graph will always be a representation of the population graph (left side); although with small sample sizes, the middle graph is somewhat sparse.</li>
<li>In an actual data analysis, we <strong>only</strong> see the middle graph. We do not see the population graph (left side) or the sampling distribution (right side).</li>
</ul>
<!--
## 4/2/20 Agenda {#Apr2}
1. The t-distribution
2. Standardized T score 
3. Hypothesis Testing & Confidence Intervals for one mean


## 4/7/20 Agenda {#Apr7}
1. Review of confidence interval for one mean
2. Prediction Interval for a future observation
-->
</div>
</div>
<div id="mean1inf" class="section level2" number="6.2">
<h2>
<span class="header-section-number">6.2</span> Inference for a single mean, <span class="math inline">\(\mu\)</span><a class="anchor" aria-label="anchor" href="#mean1inf"><i class="fas fa-link"></i></a>
</h2>
<div id="mathematical-model-for-distribution-of-the-sample-mean" class="section level3" number="6.2.1">
<h3>
<span class="header-section-number">6.2.1</span> Mathematical model for distribution of the sample mean<a class="anchor" aria-label="anchor" href="#mathematical-model-for-distribution-of-the-sample-mean"><i class="fas fa-link"></i></a>
</h3>
<p>Before coming up with the mathematical model appropriate for this section, it is important to notice that we almost never know the true variability of the data (i.e., <span class="math inline">\(\sigma\)</span>). Instead, we almost always have to estimate <span class="math inline">\(\sigma\)</span> using <span class="math inline">\(s\)</span>, the sample standard deviation. It turns out that when the estimate of the variability is used in the denominator, the sampling distribution becomes more variability (longer tails). Recall that it is the tails of the distribution in which we are the most interested, so we don’t want to get those wrong!!</p>
<p>If <span class="math inline">\(\sigma\)</span> is somehow known: <span class="math display">\[\frac{\overline{X} - \mu}{\sigma/\sqrt{n}} \sim N(0,1)\]</span></p>
<p>But in the more typical situation where <span class="math inline">\(\sigma\)</span> is estimated using <span class="math inline">\(s\)</span>: <span class="math display">\[\frac{\overline{X} - \mu}{s/\sqrt{n}} \sim t_{df = n-1}\]</span></p>
<div id="hypothesis-testing-isrs-4.1" class="section level4 unnumbered">
<h4>Hypothesis Testing (ISRS 4.1)<a class="anchor" aria-label="anchor" href="#hypothesis-testing-isrs-4.1"><i class="fas fa-link"></i></a>
</h4>
<p>If <span class="math inline">\(H_0: \mu = \mu_0\)</span> is true, then we know that: <span class="math display">\[\frac{\overline{X} - \mu_0}{s/\sqrt{n}} \sim t_{df = n-1}\]</span></p>
<p>That is, we can use the <span class="math inline">\(t_{df = n-1}\)</span> distribution to find the p-value for the test. Note, in R we we use the function <code>xpt</code> in the <code>mosaic</code> package.</p>
</div>
<div id="confidence-intervals-isrs-4.1.4" class="section level4 unnumbered">
<h4>Confidence Intervals (ISRS 4.1.4)<a class="anchor" aria-label="anchor" href="#confidence-intervals-isrs-4.1.4"><i class="fas fa-link"></i></a>
</h4>
<p>In the setting where there is no null hypothesis statement and an interval estimate is needed, the interval is created in the exact same way as was done with proportions using: <span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot SE(\overline{X})\]</span></p>
<p>Which is the same thing as: <span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s/ \sqrt{n}\]</span></p>
</div>
<div id="predint" class="section level4" number="6.2.1.1">
<h4>
<span class="header-section-number">6.2.1.1</span> Prediction Intervals (ISCAM 2.6, not in ISRS)<a class="anchor" aria-label="anchor" href="#predint"><i class="fas fa-link"></i></a>
</h4>
<p>A prediction interval is <strong>different</strong> from a confidence interval!!! Remember that a confidence interval is a range of values that try to capture a <strong>parameter</strong>. A prediction interval is meant to capture 95% of future observations (see below for the example on healthy body temperatures). Note that in order to capture the variability in the observations, we combine the variability of the center of the interval (<span class="math inline">\(s/\sqrt{n}\)</span>) with the variability of the observations themselves (<span class="math inline">\(s\)</span>).</p>
<p>A <span class="math inline">\((1-\alpha)100%\)</span> prediction interval has a <span class="math inline">\((1-\alpha)\)</span> probability of capturing a new observation from the population.</p>
<p><span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s \sqrt{1 + \frac{1}{n}}\]</span></p>
</div>
</div>
<div id="example-healthy-body-temperature" class="section level3" number="6.2.2">
<h3>
<span class="header-section-number">6.2.2</span> Example: healthy body temperature<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Inv 2.5, Chance &amp;amp; Rossman, ISCAM&lt;/p&gt;"><sup>21</sup></a><a class="anchor" aria-label="anchor" href="#example-healthy-body-temperature"><i class="fas fa-link"></i></a>
</h3>
<p>The study at hand is meant to determine whether the average healthy body temperature is actually 98.6 F.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Conventional wisdom says that the reason 98.6 has hung around is because it translates to 35 C. Indeed, it it agreed that, to the nearest integer, the average healthy human body temperature is 37 C. But there is also some consensus that it is slightly lower than 37 C (if we are willing to use more significant digits). The idea is that we have hung on to 98.6 because the decimal &lt;em&gt;feels&lt;/em&gt; like a precise measurement. In reality, it is just the conversion from 37 C to F.&lt;/p&gt;"><sup>22</sup></a></p>
<blockquote>
<p>Body temperatures (oral temperatures using a digital thermometer) were recorded for healthy men and women, aged 18-40 years, who were volunteers in Shigella vaccine trials at the University of Maryland Center for Vaccine Development, Baltimore. For these adults, the mean body temperature was found to be 98.249 F with a standard deviation of 0.733 F.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Mackowiak, Wasserman, &amp;amp; Levine, &lt;em&gt;Journal of the American Medical Association&lt;/em&gt;, 1992&lt;/p&gt;"><sup>23</sup></a></p>
</blockquote>
<p>In order to work through the analysis it is imperative that we understand the data that was collected as part of the research.</p>
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="28%">
<col width="33%">
<col width="33%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">center</th>
<th align="left">variability of data</th>
<th align="left">variability of sample means</th>
<th align="left">sample size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">
<span class="math inline">\(\overline{X} = 98.249\)</span> F</td>
<td align="left">
<span class="math inline">\(s = 0.733\)</span> F</td>
<td align="left"><span class="math inline">\(SE(\overline{X}) = \frac{s}{\sqrt{n}} = \frac{0.733}{\sqrt{130}} = 0.0643\)</span></td>
<td align="left"><span class="math inline">\(n=130\)</span></td>
</tr>
<tr class="even">
<td align="left">
<span class="math inline">\(\mu\)</span> = true ave healthy body temp (unknown!)</td>
<td align="left">
<span class="math inline">\(\sigma\)</span> = true sd of healthy body temps (unknown!)</td>
<td align="left">
<span class="math inline">\(SD(\overline{X}) = \frac{\sigma}{\sqrt{n}}\)</span> = unknown!</td>
<td align="left"></td>
</tr>
</tbody>
</table></div>
<div id="hypothesis-test-on-true-average-healthy-body-temperature" class="section level4 unnumbered">
<h4>Hypothesis test on true average healthy body temperature<a class="anchor" aria-label="anchor" href="#hypothesis-test-on-true-average-healthy-body-temperature"><i class="fas fa-link"></i></a>
</h4>
<p>The first research question we want to ask is: how surprising would it be to select a group of 130 participants who have an average healthy body temperature of 98.249 F ?</p>
<p>The questions is set up perfectly for a hypothesis test!</p>
<p><span class="math inline">\(H_0: \mu = 98.6\)</span></p>
<p><span class="math inline">\(H_A: \mu \ne 98.6\)</span></p>
<p>We use the t-distribution to investigate the claim.</p>
<p><span class="math display">\[T score = \frac{98.249 - 98.6}{0.733/\sqrt{130}} = -5.46\]</span></p>
<p>How likely is the standardized version of our test statistic to happen if the null hypothesis is true? Well, if <span class="math inline">\(H_0\)</span> is true, then the t-statistics should have a t-distribution. So we can use the t-distribution to find the p-value (recall that the p-value is the probability of the data or more extreme if <span class="math inline">\(H_0\)</span> is true.)</p>
<p>The test statistic is -5.46, and even a two-sided p-value (the area doubled) is way less than 0.001.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2</span><span class="op">*</span><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/pdist.html">xpt</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5.46</span>, df <span class="op">=</span> <span class="fl">129</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-1-1.png" width="480" style="display: block; margin: auto;"></div>
<pre><code>## [1] 2.354246e-07</code></pre>
<p>Conclusion: We definitely reject <span class="math inline">\(H_0\)</span>. There is no way this sample of 130 people came from a population with a true average healthy body temperature of 98.6.</p>
</div>
<div id="confidence-interval-for-true-average-healthy-body-temperature" class="section level4 unnumbered">
<h4>Confidence interval for true average healthy body temperature<a class="anchor" aria-label="anchor" href="#confidence-interval-for-true-average-healthy-body-temperature"><i class="fas fa-link"></i></a>
</h4>
<p>Possibly more interesting is the confidence interval which would tell us a range of plausible values for healthy body temperatures.</p>
<p>The confidence interval is given by the following formula: <span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s/ \sqrt{n}\]</span></p>
<p>and is calculated to be (98.121, 98.376). That is, we are 95% confident that the true average healthy body temperature is somewhere between 98.121 F and 98.376 F. Note that 98.6 F is not in the interval!!! Wow.</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/qdist.html">xqt</a></span><span class="op">(</span><span class="fl">.975</span>, df <span class="op">=</span> <span class="fl">129</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-2-1.png" width="480" style="display: block; margin: auto;"></div>
<pre><code>## [1] 1.978524</code></pre>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">98.249</span> <span class="op">-</span> <span class="fl">1.9785</span> <span class="op">*</span> <span class="fl">0.733</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 98.12181</code></pre>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">98.249</span> <span class="op">+</span> <span class="fl">1.9785</span> <span class="op">*</span> <span class="fl">0.733</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">130</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 98.37619</code></pre>
</div>
<div id="prediction-interval-for-individual-healthy-body-temperatures" class="section level4 unnumbered">
<h4>Prediction interval for individual healthy body temperatures<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Inv 2.6, Chance &amp;amp; Rossman, ISCAM&lt;/p&gt;"><sup>24</sup></a><a class="anchor" aria-label="anchor" href="#prediction-interval-for-individual-healthy-body-temperatures"><i class="fas fa-link"></i></a>
</h4>
<p>Note the fundamental difference between the <strong>goal</strong> of the confidence interval above and the <strong>goal</strong> of the prediction interval calculated in this section. A confidence interval is an interval of plausible values for a population parameter. A prediction interval is for a future <em>individual</em> observations.</p>
<p>A <span class="math inline">\((1-\alpha)100%\)</span> prediction interval has a <span class="math inline">\((1-\alpha)\)</span> probability of capturing a new observation from the population.</p>
<p>Here, a 95% prediction interval for healthy body temperatures can be calculated using:</p>
<p><span class="math display">\[\overline{X} \pm t_{n-1}^* \cdot s \cdot \sqrt{1 + \frac{1}{n}}\]</span></p>
<p><span class="math display">\[98.249 \pm t_{129}^* \cdot 0.733 \cdot \sqrt{1 + \frac{1}{130}}\]</span></p>
<p>Which gives a 95% prediction interval of (96.79 F, 99.70 F). There is a 0.95 probability that if I reach into the population, the person selected will have a healthy body temperature between 96.79 F and 99.70 F. Said differently, 95% of the individuals in the population will have a healthy body temperature between 96.79 F and 99.70 F (a <strong>much</strong> wider range of values than the confidence interval!)</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mosaic</span><span class="fu">::</span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/qdist.html">xqt</a></span><span class="op">(</span><span class="fl">.975</span>, df <span class="op">=</span> <span class="fl">129</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-3-1.png" width="480" style="display: block; margin: auto;"></div>
<pre><code>## [1] 1.978524</code></pre>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">98.249</span> <span class="op">-</span> <span class="fl">1.9785</span><span class="op">*</span><span class="fl">0.733</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">130</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 96.79319</code></pre>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">98.249</span> <span class="op">+</span> <span class="fl">1.9785</span><span class="op">*</span><span class="fl">0.733</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">130</span><span class="op">)</span></span></code></pre></div>
<pre><code>## [1] 99.70481</code></pre>
<!--
## 4/9/20 Agenda {#Apr9}
under the random sample model:

1. Sampling distribution of $\overline{X}_1 - \overline{X}_2$
2. Hypothesis testing (and CI) of $\mu_1 - \mu_2$

## 4/14/20 Agenda {#Apr14}
under the random allocation model:

1. Sampling distribution of $\overline{X}_1 - \overline{X}_2$
2. Confidence interval (and HT) for $\mu_1 - \mu_2$
-->
</div>
</div>
</div>
<div id="mean2inf" class="section level2" number="6.3">
<h2>
<span class="header-section-number">6.3</span> Comparing two independent means<a class="anchor" aria-label="anchor" href="#mean2inf"><i class="fas fa-link"></i></a>
</h2>
<p>It turns out that in <em>both</em> the setting where random samples are taken (e.g., NBA salaries) and the setting where random allocation is done (e.g., sleep deprivation), the t-distribution describes the distribution of the test statistic quite well. Note that the variability associated with the difference in means uses the variability of both the samples (and their individual sample sizes!).</p>
<p><span class="math display">\[\begin{eqnarray*}
\mbox{parameter} &amp;=&amp; \mu_1 - \mu_2\\
\mbox{statistic} &amp;=&amp; \overline{X}_1 - \overline{X}_2\\
SE_{\overline{X}_1 - \overline{X}_2} &amp;=&amp; ?????
\end{eqnarray*}\]</span></p>
<div id="using-the-mathematical-derivations" class="section level3" number="6.3.1">
<h3>
<span class="header-section-number">6.3.1</span> Using the mathematical derivations<a class="anchor" aria-label="anchor" href="#using-the-mathematical-derivations"><i class="fas fa-link"></i></a>
</h3>
<p>In general, the math is done on the variance (which is just the squared standard deviations).
<span class="math display">\[\begin{eqnarray*}
var(A - B) &amp;=&amp; var(A) + var(B)\\
var(\overline{X}_1 - \overline{X}_2) &amp;=&amp; var(\overline{X}_1) + var(\overline{X}_2)\\
&amp;=&amp; \sigma^2_1 / n_1 + \sigma^2_2 / n_2\\
SE(\overline{X}_1 - \overline{X}_2) &amp;=&amp; \sqrt{s^2_1 / n_1 + s^2_2 / n_2}\\
\end{eqnarray*}\]</span></p>
<p>The above methods can be used when the samples are of different sizes and when the variability in the two samples is quite different (<span class="math inline">\(s_1 \ne s_2\)</span>). If we use the above procedures, the exact degrees of freedom are not straightforward to calculate:</p>
<p><span class="math display">\[\begin{eqnarray*}
df &amp;=&amp; \frac{ \bigg(\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2} \bigg)^2}{ \bigg[ \frac{(s^2_1/n_1)^2}{n_1 - 1} + \frac{(s^2_2/n_2)^2}{n_2 - 1} \bigg] }\ \ \ \ \ \ \ \mbox{Yikes!!!!}\\
df &amp;\approx&amp; \min \{ n_1 - 1, n_2 -1 \} \\
\end{eqnarray*}\]</span></p>
<p>With the SE appropriately defined, the hypothesis test and confidence interval follow the methods from earlier in the semester.</p>
<p><span class="math inline">\(H_0: \mu_1 - \mu_2 = 0\)</span><br><span class="math inline">\(H_A: \mu_1 - \mu_2 \ne 0\)</span></p>
<p><strong>When <span class="math inline">\(H_0\)</span> is true</strong>:</p>
<p><span class="math display">\[\begin{eqnarray*}
t &amp;=&amp; \frac{(\overline{X}_1 - \overline{X}_2) - (\mu_1 - \mu_2)_0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}}\\
&amp;=&amp; \frac{(\overline{X}_1 - \overline{X}_2) - 0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}}\\
&amp;\sim&amp; t_{\min \{ n_1 - 1, n_2 -1 \} }
\end{eqnarray*}\]</span></p>
<p>Which means that the <span class="math inline">\(t_{\min \{ n_1 - 1, n_2 -1 \} }\)</span>-distribution can be used to find a p-value associated with the T score:
<span class="math display">\[\mbox{T score} = \frac{(\overline{X}_1 - \overline{X}_2) - 0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}}.\]</span></p>
<p>Additionally, a <span class="math inline">\((1-\alpha)100\)</span>% confidence interval for <span class="math inline">\((\mu_1 - \mu_2)\)</span> can be found by computing:</p>
<p><span class="math display">\[(\overline{X}_1 - \overline{X}_2) \pm t_{\min \{ n_1 - 1, n_2 -1 \} }^* \cdot \sqrt{s_1^2 / n_1 + s_2^2 / n_2}.\]</span></p>
<!--
$$(\overline{X}_1 - \overline{X}_2) ~ \sim N\bigg( (\mu_1 - \mu_2), \sqrt{\sigma_1^2 / n_1 + \sigma_2^2 / n_2} \bigg)$$

$$\mbox{T score} = \frac{(\overline{X}_1 - \overline{X}_2) - 0}{\sqrt{s_1^2 / n_1 + s_2^2 / n_2}} \sim t_{\min \{ n_1 - 1, n_2 -1 \} }$$


Unfortunately, however Welch's t-test is not used as often as other t-tests (though there is research to show that Welch's t-test should be the default).  \\

\medskip
\noindent
In particular, if the standard errors are reasonably similar ($\sigma_1 \approx \sigma_2$), a more powerful test is given by:
\begin{eqnarray*}
SE(\overline{X}_1 - \overline{X}_2) &=& \sqrt{s^2_p (1/ n_1 + 1 / n_2)}\\
s^2_p &=& \frac{(n_1-1) s_1^2 + (n_2-1)s_2^2}{n_1 + n_2 -2}\\4
df &=& n_1 + n_2 - 2
\end{eqnarray*}
-->
</div>
<div id="randomization-test" class="section level3" number="6.3.2">
<h3>
<span class="header-section-number">6.3.2</span> Randomization test<a class="anchor" aria-label="anchor" href="#randomization-test"><i class="fas fa-link"></i></a>
</h3>
<p>Recall that if the observations are randomized we force the null hypothesis to be true and can generate a sampling distribution of the test statistic under <span class="math inline">\(H_0\)</span>.</p>
<div id="example-stem-cell-therapy-in-sheep" class="section level4 unnumbered">
<h4>Example: stem cell therapy in sheep<a class="anchor" aria-label="anchor" href="#example-stem-cell-therapy-in-sheep"><i class="fas fa-link"></i></a>
</h4>
<p>Consider the research done in <em>The Lancet</em> <a href="https://www.thelancet.com/journals/lancet/article/PIIS0140-6736(05)67380-1/fulltext">“Transplantation of cardiac-committed mouse embryonic stem cells to infarcted sheep myocardium: a preclinical study”</a>. Does treatment using embryonic stem cells (ESCs) help improve heart function following a heart attack? Each of these sheep was randomly assigned to the ESC or control group, and the change in their hearts’ pumping capacity was measured in the study.</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://openintrostat.github.io/openintro/">openintro</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">stem_cell</span><span class="op">)</span></span>
<span><span class="va">stem_cell</span> <span class="op">&lt;-</span> <span class="va">stem_cell</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>change <span class="op">=</span> <span class="va">after</span> <span class="op">-</span> <span class="va">before</span><span class="op">)</span></span></code></pre></div>
<p>We can use the tools from the <strong>infer</strong> package to do a <em>randomization test</em>. Note that the null hypothesis here will be that the variables are independent (i.e., knowledge of the treatment group will not change the information on the change in heart pumping capacity).</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the observed statistic</span></span>
<span><span class="va">heart_obs</span> <span class="op">&lt;-</span> <span class="va">stem_cell</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">change</span> <span class="op">~</span> <span class="va">trmt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"esc"</span>, <span class="st">"ctrl"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">heart_obs</span></span></code></pre></div>
<pre><code>## Response: change (numeric)
## Explanatory: trmt (factor)
## # A tibble: 1 × 1
##    stat
##   &lt;dbl&gt;
## 1  7.83</code></pre>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the null sampling distribution</span></span>
<span><span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">stem_cell</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">change</span> <span class="op">~</span> <span class="va">trmt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"permute"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"esc"</span>, <span class="st">"ctrl"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize the observed statistic and null distribution</span></span>
<span><span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_dist</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span><span class="va">heart_obs</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-5-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb160"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">null_dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span><span class="va">heart_obs</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   p_value
##     &lt;dbl&gt;
## 1   0.002</code></pre>
<p>The p-value is virtually zero. Which is to say that if the null hypothesis is true, we would not have seen data like that which was observed. The result leads to rejecting the null hypothesis and claiming that there is a difference in average heart pumping capacity in the stem cell group versus the control.</p>
</div>
</div>
<div id="bootstrap-confidence-interval" class="section level3" number="6.3.3">
<h3>
<span class="header-section-number">6.3.3</span> Bootstrap Confidence Interval<a class="anchor" aria-label="anchor" href="#bootstrap-confidence-interval"><i class="fas fa-link"></i></a>
</h3>
<p>Bootstrapping mimics sampling from the original population, so the null hypothesis is not forced to be true. Now, for each bootstrap sample (each of the same size as each of the original groups), sample with replacement from each of the original groups. The resulting distribution gives the shape and spread of the sampling distribution of the statistic (difference in means).</p>
<div id="example-stem-cell-therapy-in-sheep-cont" class="section level4 unnumbered">
<h4>Example: stem cell therapy in sheep (cont)<a class="anchor" aria-label="anchor" href="#example-stem-cell-therapy-in-sheep-cont"><i class="fas fa-link"></i></a>
</h4>
<p>Consider the same stem cell study in sheet. We can use the tools from the <strong>infer</strong> package to do a <em>bootstrap confidence interval</em>. Note that there is no longer a null hypothesis specified.</p>
<div class="sourceCode" id="cb162"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># calculate the observed statistic</span></span>
<span><span class="va">heart_obs</span> <span class="op">&lt;-</span> <span class="va">stem_cell</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">change</span> <span class="op">~</span> <span class="va">trmt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"esc"</span>, <span class="st">"ctrl"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">heart_obs</span></span></code></pre></div>
<pre><code>## Response: change (numeric)
## Explanatory: trmt (factor)
## # A tibble: 1 × 1
##    stat
##   &lt;dbl&gt;
## 1  7.83</code></pre>
<div class="sourceCode" id="cb164"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate the bootstarp sampling distribution</span></span>
<span><span class="va">boot_dist</span> <span class="op">&lt;-</span> <span class="va">stem_cell</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">change</span> <span class="op">~</span> <span class="va">trmt</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"esc"</span>, <span class="st">"ctrl"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">heart_ci</span> <span class="op">&lt;-</span> <span class="va">boot_dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_confidence_interval.html">get_confidence_interval</a></span><span class="op">(</span>point_estimate <span class="op">=</span> <span class="va">heart_obs</span>,</span>
<span>                          level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>                          type <span class="op">=</span> <span class="st">"percentile"</span><span class="op">)</span></span>
<span><span class="va">heart_ci</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 2
##   lower_ci upper_ci
##      &lt;dbl&gt;    &lt;dbl&gt;
## 1     4.29     11.4</code></pre>
<div class="sourceCode" id="cb166"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># visualize the observed statistic and bootstrap distribution</span></span>
<span><span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">boot_dist</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_confidence_interval.html">shade_ci</a></span><span class="op">(</span><span class="va">heart_ci</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-6-1.png" width="480" style="display: block; margin: auto;"></div>
<p>We are 95% confident that the change in heart pumping capacity is between 4.3 and 11.9 larger for the stem cell group than the control. (I think the variable measured is “eft-ventricular ejection fraction deteriorated”.)</p>
</div>
</div>
</div>
<div id="mean2infpair" class="section level2" number="6.4">
<h2>
<span class="header-section-number">6.4</span> Comparing two paired means<a class="anchor" aria-label="anchor" href="#mean2infpair"><i class="fas fa-link"></i></a>
</h2>
<p>Paired observations (e.g., a “before” and an “after”) will be treated as a <strong>single</strong> measurement (i.e., the difference between the two measurements). As the difference is a single measurement, the analysis tools will be identical to those in Section <a href="#sec:mean1inf"><strong>??</strong></a>, Inference for a Single Mean, <span class="math inline">\(\mu\)</span></p>
</div>
<div id="ANOVA" class="section level2" number="6.5">
<h2>
<span class="header-section-number">6.5</span> ANOVA<a class="anchor" aria-label="anchor" href="#ANOVA"><i class="fas fa-link"></i></a>
</h2>
<p>It might seem like a misnomer at first, an <strong>AN</strong>alysis <strong>O</strong>f <strong>VA</strong>riance (ANOVA) test is actually a test of equality of means. That is, we extend the two sample t-test to more than two samples. The ANOVA hypotheses will always be of the form:</p>
<p><span class="math display">\[\begin{eqnarray*}
H_0:&amp;&amp; \mu_1 = \mu_2 = \cdots = \mu_I\\
H_A:&amp;&amp; \mbox{not } H_0
\end{eqnarray*}\]</span></p>
<p>If we reject the null hypothesis, we are claiming that at least one of the population means is different from the others. We do <strong>not</strong> know that all the means are simultaneously different. Be very careful with your conclusions!! Additionally, if we do not reject the null hypothesis, we are not guaranteed that the population means are all identical (which is the same idea that we’ve had before when we were unable to reject <span class="math inline">\(H_0\)</span>).</p>
<p>The ANOVA assumptions are he same as the assumptions we made for the two sample t-test with equal variance:</p>
<ul>
<li>Response variable is distributed normally within each population.</li>
<li>The variances for each population are the same.</li>
<li>The samples are independent within populations and across groups.</li>
</ul>
<div class="example">
<p><span id="exm:unlabeled-div-3" class="example"><strong>Example 6.1  </strong></span>Cuckoo Egg Lengths: L.H.C. Tippett (1902-1985) was one of the pioneers in the field of statistical quality control, This data on the lengths of cuckoo eggs found in the nests of other birds (drawn from the work of O.M. Latter in 1902) is used by Tippett in his fundamental text. Cuckoos are knows to lay their eggs in the nests of other (host) birds. The eggs are then adopted and hatched by the host birds.</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/statmanrobin/Stat2Data">Stat2Data</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Cuckoo</span><span class="op">)</span></span>
<span><span class="va">Cuckoo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Bird</span>, y <span class="op">=</span> <span class="va">Length</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-7-1.png" width="768" style="display: block; margin: auto;"></div>
</div>
<p>The key to understanding ANOVA is to breaking down the variability into two different pieces. The first is the variability within each separate group. Sometimes it is referred to as the variability of the residuals (left over after the groups are formed). The second is the variability across the different groups.</p>
<p><strong>mean square between groups</strong>
The mean square between groups (sometimes called mean square treatment, MST) of ANOVA represents variation between the means of the treatment groups as compared to the overall mean. It should be similar to error mean square if the population means are equal.</p>
<p><span class="math display">\[
\begin{align*}
MSG &amp;= \frac{\sum_{i=1}^I n_i (\overline{x}_i - \overline{x})^2}{I-1}\\
\overline{x} &amp;= \frac{\sum_{i=1}^I n_i \overline{x}_i}{N}\\
\end{align*}
\]</span></p>
<p><strong>mean square error</strong>
The mean square error (MSE) of ANOVA is the pooled sample variance, a measure of the variability within groups.</p>
<p><span class="math display">\[
\begin{align*}
MSE&amp;= \frac{\sum_{i=1}^I s_i^2(n_i -1)}{N-I}\\
\overline{x} &amp;= \frac{\sum_{i=1}^I n_i \overline{x}_i}{N}\\
\end{align*}
\]</span></p>
<div id="anova-f-test" class="section level3" number="6.5.1">
<h3>
<span class="header-section-number">6.5.1</span> ANOVA F-test<a class="anchor" aria-label="anchor" href="#anova-f-test"><i class="fas fa-link"></i></a>
</h3>
<p>Under the null hypothesis that the population means of all the groups are the same, the value for <span class="math inline">\(MSG\)</span> should be similar to the value for <span class="math inline">\(MSE\)</span>. Regardless of the null hypothesis, <span class="math inline">\(MSE\)</span> will always be a good measure of the within group variability. If the groups are really different, <span class="math inline">\(MSG\)</span> will overestimate the within group variability. Under <span class="math inline">\(H_0\)</span>:</p>
<p><span class="math display">\[F = \frac{MSG}{MSE} \sim F_{I-1, N-I}\]</span></p>
<p>If, in fact, the population means are different, <span class="math inline">\(F\)</span> will be much larger than expected from the null sampling distribution.</p>
<p><span class="math display">\[\mbox{p-value} = P(F_{I-1, N-I} \geq F)\]</span></p>
<p>Rejecting the null hypothesis says that at least one of the population means is different from the others. Not rejecting the null hypothesis says that the data are consistent with the null hypothesis (not that we are sure the null hypothesis is true).</p>
</div>
<div id="anova-table" class="section level3" number="6.5.2">
<h3>
<span class="header-section-number">6.5.2</span> ANOVA table<a class="anchor" aria-label="anchor" href="#anova-table"><i class="fas fa-link"></i></a>
</h3>
<p>An ANOVA table summarizes the F-test above (and more: see Math 158, a whole class on linear models!)</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="8%">
<col width="42%">
<col width="5%">
<col width="5%">
<col width="15%">
<col width="22%">
</colgroup>
<thead><tr class="header">
<th>Source</th>
<th>SS</th>
<th>df</th>
<th>MS</th>
<th>F</th>
<th>p</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>groups</td>
<td><span class="math inline">\(\sum_{i=1}^I n_i (\overline{x}_i - \overline{x})^2\)</span></td>
<td><span class="math inline">\(I-1\)</span></td>
<td><span class="math inline">\(MSG\)</span></td>
<td><span class="math inline">\(\frac{MSG}{MSE}\)</span></td>
<td><span class="math inline">\(P(F_{I-1, N-I} \geq F)\)</span></td>
</tr>
<tr class="even">
<td>error</td>
<td><span class="math inline">\(\sum_{i=1}^I s_i^2(n_i -1)\)</span></td>
<td><span class="math inline">\(n-I\)</span></td>
<td><span class="math inline">\(MSE\)</span></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td>Total</td>
<td><span class="math inline">\(\sum_{i=1}^I \sum_{j=1}^{n_i} (x_{ij} - \overline{x})^2\)</span></td>
<td><span class="math inline">\(n-1\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table></div>
</div>
<div id="technical-conditions" class="section level3" number="6.5.3">
<h3>
<span class="header-section-number">6.5.3</span> Technical Conditions<a class="anchor" aria-label="anchor" href="#technical-conditions"><i class="fas fa-link"></i></a>
</h3>
<p>There are several technical conditions required for this randomization distribution to be well modeled by
the F distribution. Research into the ANOVA test has been done to identify which of the technical conditions are most important and when. Independence is always important to an ANOVA analysis. The normality condition is most important when the sample sizes for each group are relatively small. The constant variance condition is especially important when the sample sizes differ between groups. If the technical conditions are not met, then the resulting p-value will be meaningless. (See the section on ``Graphical diagnostics for an ANOVA analysis” in the OpenIntro textbook for a more complete discussion.)</p>
<ul>
<li>The distribution for each group comes from a normal population.</li>
<li>The population standard deviation is the same for all the groups.</li>
<li>The observations are independent.</li>
</ul>
<p>When using this ANOVA F-test to compare several population means, we will check each condition as
follows:</p>
<ul>
<li>The normal probability plot (or dotplot or histogram) for each sample’s responses is reasonably
well-behaved.</li>
<li>The ratio of the largest standard deviation to the smallest standard deviation is at most 2.</li>
<li>The samples are independent random samples from each population.</li>
</ul>
<p>For simplicity, we will apply the same checks for a randomized experiment as well (with the last
condition being met if the treatments are randomly assigned). If the first two conditions are not met,
then suitable transformations may be useful.</p>
</div>
<div id="anova-r-code" class="section level3" number="6.5.4">
<h3>
<span class="header-section-number">6.5.4</span> ANOVA R code<a class="anchor" aria-label="anchor" href="#anova-r-code"><i class="fas fa-link"></i></a>
</h3>
<p>Notice that the variable which describes the host bird is called <code>Bird</code>. But in the output, there are FIVE rows describing different birds. The <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> function (linear model) creates five new 0/1 (binary) variables as a way to write down one linear model describing six different birds.</p>
<p><strong>Converting the <code>Bird</code> variable:</strong></p>
<p><span class="math display">\[
\begin{align}
X_{mdw\_pippit} = \begin{cases}
  1 &amp; \text{if mdw_pippit} \\
  0 &amp; \text{otherwise} \\
\end{cases}
X_{robin} = \begin{cases}
  1 &amp; \text{if robin} \\
  0 &amp; \text{otherwise} \\
\end{cases}
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
X_{tree\_pippit} = \begin{cases}
  1 &amp; \text{if tree_pippit} \\
  0 &amp; \text{otherwise} \\
\end{cases}
X_{wagtail} = \begin{cases}
  1 &amp; \text{if wagtail} \\
  0 &amp; \text{otherwise} \\
\end{cases}
\end{align}
\]</span></p>
<p><span class="math display">\[
\begin{align}
X_{wren} = \begin{cases}
  1 &amp; \text{if wren} \\
  0 &amp; \text{otherwise} \\
\end{cases}
\end{align}
\]</span></p>
<p>So the model which describes the average egg length (denoted with the <span class="math inline">\(\hat{Y}\)</span> notation) can be written as the following:</p>
<p><span class="math display">\[
\begin{align*}
\hat{Y} = &amp;  \ \ 23.12 - 0.82 \cdot X_{mdw\_pippit} - 0.54\cdot X_{robin} - 0.03\cdot X_{tree\_pippit} +\\
&amp; - 0.2 1\cdot X_{wagtail} - 1.99 \cdot X_{wren}
\end{align*}
\]</span>
You might have noticed that there is no variable or coefficient for the <code>hedge_sparrow</code>. That’s because the <code>hedge_sparrow</code> lives in the intercept! The model has to choose a baseline (that’s just how it works) which means all the other averages are compared to the <code>hedge_sparrow</code> baseline.</p>
<p>We will talk about this model in more detail in Chapter <a href="reginf.html#reginf">7</a> on Multiple Regression and inference, but for now notice that the <code>mdw_pippit</code> and <code>wren</code> are significantly different from the <code>hedge_sparrow</code> (p-values are small), but the <code>robin</code>, <code>tree_pippit</code> and <code>wagtail</code> are not significantly different from the <code>hedge_sparrow</code> (p-values are big).</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cuckoo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">Bird</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_length <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">Length</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   Bird          mean_length
##   &lt;fct&gt;               &lt;dbl&gt;
## 1 hedge_sparrow        23.1
## 2 mdw_pippit           22.3
## 3 robin                22.6
## 4 tree_pippit          23.1
## 5 wagtail              22.9
## 6 wren                 21.1</code></pre>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cuckoo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Length</span> <span class="op">~</span> <span class="va">Bird</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   term            estimate std.error statistic   p.value
##   &lt;chr&gt;              &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)      23.1        0.243   95.1    1.87e-110
## 2 Birdmdw_pippit   -0.823      0.278   -2.96   3.79e-  3
## 3 Birdrobin        -0.546      0.333   -1.64   1.03e-  1
## 4 Birdtree_pippit  -0.0314     0.338   -0.0930 9.26e-  1
## 5 Birdwagtail      -0.218      0.338   -0.645  5.20e-  1
## 6 Birdwren         -1.99       0.338   -5.89   3.91e-  8</code></pre>
<p>The ANOVA output is also given by running the <code><a href="https://rdrr.io/r/stats/lm.html">lm()</a></code> command. Notice that the F statistic is 10.388 with a very small p-value. The small p-value associated with the ANOVA F-test means that we can reject the null hypothesis (of equal population means across bird hosts). Our conclusion is that at least one of the bird hosts has a different average Cuckoo egg length than the other hosts.</p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cuckoo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Length</span> <span class="op">~</span> <span class="va">Bird</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://generics.r-lib.org/reference/glance.html">glance</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 12
##   r.squared adj.r.squared sigma statistic      p.value    df logLik   AIC   BIC
##       &lt;dbl&gt;         &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;        &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1     0.313         0.283 0.909      10.4 0.0000000315     5  -156.  326.  345.
## # … with 3 more variables: deviance &lt;dbl&gt;, df.residual &lt;int&gt;, nobs &lt;int&gt;</code></pre>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Cuckoo</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">Length</span> <span class="op">~</span> <span class="va">Bird</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/anova.html">anova</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Length
##            Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Bird        5 42.940  8.5879  10.388 3.152e-08 ***
## Residuals 114 94.248  0.8267                      
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div id="thought-experiment" class="section level3" number="6.5.5">
<h3>
<span class="header-section-number">6.5.5</span> Thought experiment<a class="anchor" aria-label="anchor" href="#thought-experiment"><i class="fas fa-link"></i></a>
</h3>
<p>As with many of the other tests we’ve covered, the ANOVA setting can be evaluated mathematically (as seen in these notes) <em>and</em> computationally, using a randomization test. How would you set up a simulation to create a null sampling distribution for the question at hand? The important pieces of the simulation will include:</p>
<ul>
<li>What statistic do you plan to use?</li>
<li>For what values of the statistics will you reject <span class="math inline">\(H_0\)</span>? (Big or small?)</li>
<li>How will you shuffle the observed data values to force the null hypothesis to be true?</li>
<li>How many shuffles do you need to accurately describe the null sampling distribution?</li>
</ul>
<div id="r2" class="section level4 unnumbered">
<h4>
<span class="math inline">\(R^2\)</span><a class="anchor" aria-label="anchor" href="#r2"><i class="fas fa-link"></i></a>
</h4>
<p>We won’t show it, but <span class="math inline">\(SSTO = SST + SSE\)</span>.</p>
<p><span class="math display">\[\begin{eqnarray*}
R^2 = \frac{SST}{SSTO} = 1 - \frac{SSE}{SSTO}
\end{eqnarray*}\]</span></p>
<p>Notice that <span class="math inline">\(MSTO\)</span> is simply the variability in x completely regardless of the model (groups, etc.) It is the same value we would have calculated for the variance of x if we hadn’t known anything about the groups of interest. <span class="math inline">\(SST\)</span> is the proportion of that variability that we attribute (<em>explain</em>) by breaking the response down by groups.</p>
<p>For the egg length data:
<span class="math display">\[\begin{eqnarray*}
SSTO &amp;=&amp; 42.94 + 94.248 = 137.188\\
R^2 &amp;=&amp; 42.94 / 137.188 = 0.313
\end{eqnarray*}\]</span>
31.3% of the variability in egg lengths can be explained by the differences in host birds (that is, can be explained by where the cuckoo decides to lay the egg).</p>
</div>
<div id="post-hoc-comparison-of-means" class="section level4 unnumbered">
<h4>Post-hoc comparison of means<a class="anchor" aria-label="anchor" href="#post-hoc-comparison-of-means"><i class="fas fa-link"></i></a>
</h4>
<p>If, in fact, the research question addresses a prespecified comparison of means, the two independent sample t-test applies directly. Note that the two differences have to do with the estimated SE. We now estimate the SE using <em>all</em> of the data (even though our primary interest is in only 2 of the groups).</p>
<p><span class="math display">\[\hat{\sigma}^2 = s_p^2 = \frac{(n_1-1)s_1^2 + (n_2 - 1) s_2^2 + \cdots + (n_k -1)s_k^2}{n_1 + n_2 + \cdots + n_k -k}\]</span></p>
<p>Additionally, because <span class="math inline">\(k\)</span> means are estimated in in order to calculate the variability, there are <span class="math inline">\(n-k\)</span> degrees of freedom. Therefore, a <span class="math inline">\((1-\alpha)100\%\)</span> confidence interval for <span class="math inline">\(\mu_i - \mu_j\)</span> is
<span class="math display">\[\overline{X}_i - \overline{X}_j \pm t_{(\alpha/2,N-k)} s_p \sqrt{1/n_i + 1/n_j}\]</span></p>
<p>Let’s say we were originally interested in whether the eggs hatched in meadow pipit and tree pipit nests were significantly different sizes, on average.</p>
<p><span class="math display">\[
\begin{align*}
s_p^2 &amp;=  MS_{resid} = 0.827\\
(22.99 - 23.09) &amp;\pm  t_{(.05, 120-6)} \sqrt{0.827} \sqrt{1/45 + 1/15}\\
&amp; (-0.55, 0.35)\\
\verb;xqt;(0.05, 114) &amp;= -1.658
\end{align*}
\]</span></p>
<p>We’re 90% confident that the true difference in average cuckoo egg length for meadow pipits minus tree pipits is between -0.55 mm and 0.35mm. Because zero is contained in the interval, we cannot tell which type of bird hosts larger eggs.</p>
</div>
<div id="multiple-comparisons" class="section level4 unnumbered">
<h4>Multiple Comparisons<a class="anchor" aria-label="anchor" href="#multiple-comparisons"><i class="fas fa-link"></i></a>
</h4>
<p>As you might expect, if you have 10 groups, <strong>all of which come from the same population</strong>, you might wrongly conclude that some of the means are <em>significantly</em> different. If you try pairwise comparisons on all 10 groups, you’ll have <span class="math inline">\({10 \choose 2} = 45\)</span> comparisons. Out of the 45 CI, you’d expect 2.25 of them to not contain the true difference (of zero); equivalently, you’d expect 2.25 tests to reject the true <span class="math inline">\(H_0\)</span>. In an overall test of comparing all 10 groups simultaneously, you can’t use size as a performance measure anymore.</p>
<p><strong>FWER</strong>
The Familywise Error Rate (FWER) is the probability of making one or more type I errors in a series of multiple tests. In the example above (with 10 comparisons), you would almost always make at least one type I error if you used a size of <span class="math inline">\(\alpha = 0.05\)</span>. So, your FWER would be close to 1. Methods exist for controlling the FWER instead of the size (<span class="math inline">\(\alpha\)</span>).</p>
<p>We can use Bonferroni or the Tukey-Kramer method to adjust the FWER. Other possibilities for determining significance (like the false discover rate (FDR) or q-values) also exist.</p>
</div>
</div>
</div>
<div id="r-code-for-inference-on-1-or-2-means." class="section level2" number="6.6">
<h2>
<span class="header-section-number">6.6</span> R code for inference on 1 or 2 means.<a class="anchor" aria-label="anchor" href="#r-code-for-inference-on-1-or-2-means."><i class="fas fa-link"></i></a>
</h2>
<p>Above, R is used primarily as a calculator and a way to find the appropriate values from the t-distribution (using <code><a href="https://www.mosaic-web.org/mosaic/reference/pdist.html">mosaic::xpt</a></code> and <code><a href="https://www.mosaic-web.org/mosaic/reference/qdist.html">mosaic::xqt</a></code> <span class="math inline">\(\rightarrow\)</span> note that along with the first argument (either a probability or a place on the x-axis) it is important to add the degrees of freedom <code>df</code>).</p>
<p>Consider the teacher salary data available in the OpenIntro textbook.</p>
<blockquote>
<p>This data set contains teacher salaries from 2009-2010 for 71 teachers employed by the St. Louis Public School in Michigan, as well as several covariates.
Posted on opendata.socrata.com by Jeff Kowalski. Original source: <a href="http://stlouis.edzone.net" class="uri">http://stlouis.edzone.net</a></p>
</blockquote>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">teachers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"https://www.openintro.org/data/tab-delimited/teacher.txt"</span>, </span>
<span>                       delim<span class="op">=</span> <span class="st">"\t"</span><span class="op">)</span></span></code></pre></div>
<div id="t.test" class="section level3" number="6.6.1">
<h3>
<span class="header-section-number">6.6.1</span> <code>t.test()</code><a class="anchor" aria-label="anchor" href="#t.test"><i class="fas fa-link"></i></a>
</h3>
<p>The function which is typically used to do t-tests is the function <code><a href="https://www.mosaic-web.org/mosaic/reference/ttest.html">t.test()</a></code>. Note that the <code><a href="https://www.mosaic-web.org/mosaic/reference/ttest.html">t.test()</a></code> function requires a complete dataset, not just the summary statistics. However, the <code><a href="https://www.mosaic-web.org/mosaic/reference/ttest.html">t.test()</a></code> can be used to do any of the variety of tests we’ve seen (and the ones we haven’t seen!): one sample t-test, two independent samples t-test (with or without equal variances), paired t-test.</p>
<div id="one-sample-t-test" class="section level4 unnumbered">
<h4>One sample t-test<a class="anchor" aria-label="anchor" href="#one-sample-t-test"><i class="fas fa-link"></i></a>
</h4>
<p>For example, we might be interested in testing whether the average salary (of all teachers in St Louis) is above $47,000 a year. The p-value is extremely small. We reject <span class="math inline">\(H_0\)</span>. That is, we can claim that the true average base salary is above $47,000. (Note, to calculate a CI, use <code>alternative = "two.sided"</code>.)</p>
<p><span class="math inline">\(H_0: \mu = 47,000\)</span></p>
<p><span class="math inline">\(H_A: \mu &gt; 47,000\)</span></p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">teachers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">base</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span><span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/ttest.html">t.test</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">47000</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  .
## t = 7.9466, df = 70, p-value = 1.146e-11
## alternative hypothesis: true mean is greater than 47000
## 95 percent confidence interval:
##  54440.82      Inf
## sample estimates:
## mean of x 
##  56415.96</code></pre>
</div>
<div id="two-independent-samples-t-test" class="section level4 unnumbered">
<h4>Two independent samples t-test<a class="anchor" aria-label="anchor" href="#two-independent-samples-t-test"><i class="fas fa-link"></i></a>
</h4>
<p>Or, maybe interest is in knowing whether the base salary for teachers with a BA degree is less than those with an MA degree, on average. Note, <span class="math inline">\(\mu\)</span> denotes the average salary in the population group denoted by the subscript. The p-value is 0.442, so we would not reject the null hypothesis. (Note, to calculate a CI, use <code>alternative = "two.sided"</code>.)</p>
<p><span class="math inline">\(H_0: \mu_{BA} = \mu_{MA}\)</span></p>
<p><span class="math inline">\(H_A: \mu_{BA} &lt; \mu_{MA}\)</span></p>
<div class="sourceCode" id="cb179"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">teachers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/ttest.html">t.test</a></span><span class="op">(</span><span class="va">base</span> <span class="op">~</span> <span class="va">degree</span>, alternative <span class="op">=</span> <span class="st">"less"</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  base by degree
## t = -0.14639, df = 65.238, p-value = 0.442
## alternative hypothesis: true difference in means between group BA and group MA is less than 0
## 95 percent confidence interval:
##      -Inf 3664.912
## sample estimates:
## mean in group BA mean in group MA 
##         56257.10         56609.56</code></pre>
</div>
</div>
<div id="bootstrapping-in-r" class="section level3" number="6.6.2">
<h3>
<span class="header-section-number">6.6.2</span> Bootstrapping in R<a class="anchor" aria-label="anchor" href="#bootstrapping-in-r"><i class="fas fa-link"></i></a>
</h3>
<p>Notice that the simulation syntax is almost identical to that which we covered when we were working with proportions. Also, notice that the computational approach gives almost identical answers to the mathematical model (t-distribution) from above.</p>
<div id="one-sample-bootstrapping-on-mean" class="section level4 unnumbered">
<h4>One sample bootstrapping on mean<a class="anchor" aria-label="anchor" href="#one-sample-bootstrapping-on-mean"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb181"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/infer">infer</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span></span>
<span><span class="co"># calculate the observed test statistic</span></span>
<span><span class="co"># note that we could use `stat = "median"` or `stat = "t"`</span></span>
<span><span class="op">(</span> <span class="va">x_bar_base</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">base</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>## Response: base (numeric)
## # A tibble: 1 × 1
##     stat
##    &lt;dbl&gt;
## 1 56416.</code></pre>
<div class="sourceCode" id="cb183"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create the null sampling distribution</span></span>
<span><span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span>response <span class="op">=</span> <span class="va">base</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"point"</span>, mu <span class="op">=</span> <span class="fl">47000</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># visualize the null sampling distribution</span></span>
<span><span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb184"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the p-value</span></span>
<span><span class="va">null_dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   p_value
##     &lt;dbl&gt;
## 1       0</code></pre>
</div>
<div id="two-independent-samples-comparing-two-means" class="section level4 unnumbered">
<h4>Two independent samples comparing two means<a class="anchor" aria-label="anchor" href="#two-independent-samples-comparing-two-means"><i class="fas fa-link"></i></a>
</h4>
<p>p-value is now 0.464 (very close to 0.442 given by the smooth t-distribution curve).</p>
<div class="sourceCode" id="cb186"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">47</span><span class="op">)</span></span>
<span><span class="co"># calculate the observed test statistic</span></span>
<span><span class="op">(</span> <span class="va">diff_x_bar_base</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">base</span> <span class="op">~</span> <span class="va">degree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MA"</span>, <span class="st">"BA"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<pre><code>## Response: base (numeric)
## Explanatory: degree (factor)
## # A tibble: 1 × 1
##    stat
##   &lt;dbl&gt;
## 1  352.</code></pre>
<div class="sourceCode" id="cb188"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create the null sampling distribution</span></span>
<span><span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">teachers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/specify.html">specify</a></span><span class="op">(</span><span class="va">base</span> <span class="op">~</span> <span class="va">degree</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/hypothesize.html">hypothesize</a></span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/generate.html">generate</a></span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">1000</span>, type <span class="op">=</span><span class="st">"permute"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/calculate.html">calculate</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"diff in means"</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MA"</span>, <span class="st">"BA"</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># visualize the null sampling distribution</span></span>
<span><span class="fu"><a href="https://infer.tidymodels.org/reference/visualize.html">visualize</a></span><span class="op">(</span><span class="va">null_dist</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/shade_p_value.html">shade_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">diff_x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-14-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb189"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># calculate the p-value</span></span>
<span><span class="va">null_dist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/get_p_value.html">get_p_value</a></span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">diff_x_bar_base</span>, direction <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   p_value
##     &lt;dbl&gt;
## 1   0.454</code></pre>
</div>
</div>
<div id="nba-salaries-example-from-iscam-inv-4.2" class="section level3" number="6.6.3">
<h3>
<span class="header-section-number">6.6.3</span> NBA Salaries example from ISCAM Inv 4.2<a class="anchor" aria-label="anchor" href="#nba-salaries-example-from-iscam-inv-4.2"><i class="fas fa-link"></i></a>
</h3>
<p>There is R code in the ISCAM book. I’ve written the series of steps in a slightly different way with the same results.</p>
<div id="eda" class="section level4 unnumbered">
<h4>EDA<a class="anchor" aria-label="anchor" href="#eda"><i class="fas fa-link"></i></a>
</h4>
<p>Before thinking about inference, let’s look at the population (for 2017-18). The information for today is the population because it includes the salaries of all NBA players in 2017. We can see that in this particular year, the average salary in the Western conference is slightly higher.</p>
<div class="sourceCode" id="cb191"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NBAsalary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_delim</a></span><span class="op">(</span><span class="st">"http://www.rossmanchance.com/iscam3/data/NBASalaries2017.txt"</span>, delim <span class="op">=</span> <span class="st">"\t"</span>, escape_double <span class="op">=</span> <span class="cn">FALSE</span>, trim_ws <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">NBAsalary</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">conference</span>, y <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-15-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb192"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">NBAsalary</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">conference</span>, x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-15-2.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb193"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">NBAsalary</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span> <span class="va">conference</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-15-3.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb194"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NBAsalary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">conference</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, sigma <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">sd</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, N <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">min</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">max</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">median</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>## # A tibble: 2 × 7
##   conference    mu sigma     N `min(salary)` `max(salary)` `median(salary)`
##   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
## 1 eastern     6.61  7.01   227        0.0577          33.3             3.81
## 2 western     7.42  7.76   221        0.0320          34.4             4</code></pre>
</div>
<div id="sampling-distribution-for-one-mean" class="section level4 unnumbered">
<h4>Sampling distribution for one mean<a class="anchor" aria-label="anchor" href="#sampling-distribution-for-one-mean"><i class="fas fa-link"></i></a>
</h4>
<p>Before considering how the sample means vary, let’s visualize samples from each conference.</p>
<div class="sourceCode" id="cb196"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NBAsalary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"eastern"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"eastern salary"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">NBAsalary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"western"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"western salary"</span><span class="op">)</span></span></code></pre></div>
<p><img src="04-InfNum_files/figure-html/unnamed-chunk-16-1.png" width="768" style="display: block; margin: auto;"><img src="04-InfNum_files/figure-html/unnamed-chunk-16-2.png" width="768" style="display: block; margin: auto;"></p>
<p>One way to think about how the difference in means varies is to first visualize the variability in the distribution for a single mean (i.e., from one conference). Let’s look at the variability in the Eastern conference as well as the variability in the Western conference.</p>
<p>Note that from the population analysis above (full set of observations), we see that <span class="math inline">\(\sigma \approx 7\)</span>. So the histograms below should have a standard deviation of close to <span class="math inline">\(\sigma / \sqrt{20} = 1.5\)</span>. Do they?</p>
<p>Are the two histograms centered at the same place? Should they be?</p>
<div class="sourceCode" id="cb197"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NBAsalary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"eastern"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>, reps <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_sal <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mean_sal</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-17-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb198"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">NBAsalary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">conference</span> <span class="op">==</span> <span class="st">"western"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://infer.tidymodels.org/reference/rep_sample_n.html">rep_sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span>, reps <span class="op">=</span> <span class="fl">500</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mean_sal <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">salary</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">mean_sal</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-17-2.png" width="480" style="display: block; margin: auto;"></div>
</div>
<div id="sampling-distribution-for-two-means" class="section level4 unnumbered">
<h4>Sampling distribution for two means<a class="anchor" aria-label="anchor" href="#sampling-distribution-for-two-means"><i class="fas fa-link"></i></a>
</h4>
<p>Note: the code selects 20 random salaries from the Eastern NBA conference and 20 random salaries from the Western NBA conference. Using those two different samples, a t-statistic is selected. The whole process is repeated 1000 times.</p>
<div class="sourceCode" id="cb199"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4747</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_salaries</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>meandiff <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span>, tstat <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/double.html">double</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">one_t</span><span class="op">&lt;-</span> <span class="va">NBAsalary</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">conference</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/sample_n.html">sample_n</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>mn <span class="op">=</span> <span class="fu">mean</span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, sd <span class="op">=</span> <span class="fu"><a href="https://www.mosaic-web.org/mosaic/reference/aggregating.html">sd</a></span><span class="op">(</span><span class="va">salary</span><span class="op">)</span>, n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">conference</span>, values_from <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>meandiff <span class="op">=</span> <span class="op">(</span><span class="va">mn_eastern</span> <span class="op">-</span> <span class="va">mn_western</span><span class="op">)</span>, </span>
<span>              tstat <span class="op">=</span> <span class="op">(</span><span class="va">mn_eastern</span> <span class="op">-</span> <span class="va">mn_western</span><span class="op">)</span> <span class="op">/</span> </span>
<span>                <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="va">sd_eastern</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_eastern</span> <span class="op">+</span> <span class="va">sd_western</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">n_western</span><span class="op">)</span><span class="op">)</span> </span>
<span></span>
<span>  <span class="va">t_salaries</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">&lt;-</span> <span class="va">one_t</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">t_salaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">meandiff</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-18-1.png" width="480" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb200"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">t_salaries</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">tstat</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-InfNum_files/figure-html/unnamed-chunk-18-2.png" width="480" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="reflection-questions-4" class="section level2" number="6.7">
<h2>
<span class="header-section-number">6.7</span> <i class="fas fa-lightbulb" target="_blank"></i> Reflection Questions<a class="anchor" aria-label="anchor" href="#reflection-questions-4"><i class="fas fa-link"></i></a>
</h2>
<div id="quantitative-variable-ims-section-7.1" class="section level3" number="6.7.1">
<h3>
<span class="header-section-number">6.7.1</span> 1 quantitative variable: IMS Section 7.1<a class="anchor" aria-label="anchor" href="#quantitative-variable-ims-section-7.1"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>What changed about the studies (data structure) from Chapters 2 &amp; 3?</li>
<li>What is the statistic of interest now? What is the parameter of interest?</li>
<li>What is the difference between the distribution of the data and the distribution of the statistic? There is a theoretical difference as well as a computational difference.</li>
<li>What is the limiting sampling distribution of the statistic? (Note, the answer here is for big samples, that is the Central <strong>Limit</strong> Theorem works only where there is a limit… i.e., the sample size is big.)</li>
<li>If interest is in a statistics other than the sample mean, what is a tool we can use for finding the alternative statistic’s sampling distribution?</li>
<li>Explain the intuition behind bootstrapping.</li>
<li>Explain how the SE for the statistic is calculated using bootstrapping.</li>
<li>What is the difference between a normal distribution and a t distribution?</li>
<li>When do we use a z and when do we use a t?</li>
<li>When would you use a confidence interval and when would you use a hypothesis test?</li>
<li>What different information does a boxplot give versus a histogram?</li>
</ol>
</div>
<div id="means-1-quantitative-variable-1-binary-variable-ims-section-7.2" class="section level3" number="6.7.2">
<h3>
<span class="header-section-number">6.7.2</span> 2 means (1 quantitative variable, 1 binary variable): IMS Section 7.2<a class="anchor" aria-label="anchor" href="#means-1-quantitative-variable-1-binary-variable-ims-section-7.2"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>What changed about the studies (data structure) from section 4.1?</li>
<li>What is the statistic of interest now? What is the parameter of interest?</li>
<li>What is the sampling distribution for the statistic of interest?</li>
<li>How is the t-distribution become relevant?</li>
<li>What are degrees of freedom in general? What are the actual degrees of freedom for the test in section 4.3?</li>
<li>How is the null mechanism different across the three analysis methods in section 3.2: randomization test, two-sample t-test, random sampling test (n.b. this is also called the parametric bootstrap)?</li>
<li>How do you create a CI? How do you interpret the CI?</li>
<li>What if your data are NOT normal? What strategies can you try out?</li>
</ol>
</div>
<div id="wont-cover-spring-2022-paired-sample-difference-in-means-ims-section-7.3" class="section level3" number="6.7.3">
<h3>
<span class="header-section-number">6.7.3</span> (won’t cover spring 2022) Paired sample, difference in means: IMS Section 7.3<a class="anchor" aria-label="anchor" href="#wont-cover-spring-2022-paired-sample-difference-in-means-ims-section-7.3"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>What changed about the studies (data structure) in section 4.2 as compared with 4.1 or 4.3?</li>
<li>What is the statistic of interest now? What is the parameter of interest?</li>
<li>What is the sampling distribution for the statistic of interest?</li>
<li>What benefit does pairing have on the analysis?</li>
<li>What happens if a paired study is analyzed as if it were an independent two sample study? (What happens to the p-value? What happens to the CI?)</li>
<li>What is the easiest way to think of / analyze paired data?</li>
</ol>
</div>
<div id="anova-ims-section-7.5" class="section level3" number="6.7.4">
<h3>
<span class="header-section-number">6.7.4</span> ANOVA: IMS Section 7.5<a class="anchor" aria-label="anchor" href="#anova-ims-section-7.5"><i class="fas fa-link"></i></a>
</h3>
<ol style="list-style-type: decimal">
<li>Why are these tests called ANalysis Of VAriance (ANOVA)?</li>
<li>Describe the variability in the numerator and the variability in the denominator. What does each measure?</li>
<li>What are the null and alternative hypotheses for ANOVA?</li>
<li>What features of the data affect the power of the test? What does power mean here?</li>
<li>What are the technical conditions? Why do we need equal variances here?</li>
</ol>
</div>
</div>
<div id="ethics-considerations-4" class="section level2" number="6.8">
<h2>
<span class="header-section-number">6.8</span> <i class="fas fa-balance-scale"></i> Ethics Considerations<a class="anchor" aria-label="anchor" href="#ethics-considerations-4"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>Why would you perform a power analysis before collecting the full dataset?</li>
<li>How do you choose which method to apply to the dataset at hand?</li>
<li>How do you decide whether to perform a hypothesis test or compute a confidence interval?</li>
<li>How are all the methods in this chapter related? What would happen if you applied the methods to a dataset with a binary response variable?</li>
</ol>
</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="inference-for-categorical-data.html"><span class="header-section-number">5</span> Inference for categorical data</a></div>
<div class="next"><a href="reginf.html"><span class="header-section-number">7</span> Inference on Correlation &amp; Regression</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#inference-for-numerical-data"><span class="header-section-number">6</span> Inference for numerical data</a></li>
<li>
<a class="nav-link" href="#important-measures-related-to-quantitative-numeric-variables"><span class="header-section-number">6.1</span> Important measures related to quantitative (numeric) variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#quantitative-descriptives"><span class="header-section-number">6.1.1</span> Quantitative Descriptives</a></li>
<li><a class="nav-link" href="#mean1dist"><span class="header-section-number">6.1.2</span> Sampling distribution of a sample mean</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#mean1inf"><span class="header-section-number">6.2</span> Inference for a single mean, \(\mu\)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#mathematical-model-for-distribution-of-the-sample-mean"><span class="header-section-number">6.2.1</span> Mathematical model for distribution of the sample mean</a></li>
<li><a class="nav-link" href="#example-healthy-body-temperature"><span class="header-section-number">6.2.2</span> Example: healthy body temperature21</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#mean2inf"><span class="header-section-number">6.3</span> Comparing two independent means</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#using-the-mathematical-derivations"><span class="header-section-number">6.3.1</span> Using the mathematical derivations</a></li>
<li><a class="nav-link" href="#randomization-test"><span class="header-section-number">6.3.2</span> Randomization test</a></li>
<li><a class="nav-link" href="#bootstrap-confidence-interval"><span class="header-section-number">6.3.3</span> Bootstrap Confidence Interval</a></li>
</ul>
</li>
<li><a class="nav-link" href="#mean2infpair"><span class="header-section-number">6.4</span> Comparing two paired means</a></li>
<li>
<a class="nav-link" href="#ANOVA"><span class="header-section-number">6.5</span> ANOVA</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#anova-f-test"><span class="header-section-number">6.5.1</span> ANOVA F-test</a></li>
<li><a class="nav-link" href="#anova-table"><span class="header-section-number">6.5.2</span> ANOVA table</a></li>
<li><a class="nav-link" href="#technical-conditions"><span class="header-section-number">6.5.3</span> Technical Conditions</a></li>
<li><a class="nav-link" href="#anova-r-code"><span class="header-section-number">6.5.4</span> ANOVA R code</a></li>
<li><a class="nav-link" href="#thought-experiment"><span class="header-section-number">6.5.5</span> Thought experiment</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#r-code-for-inference-on-1-or-2-means."><span class="header-section-number">6.6</span> R code for inference on 1 or 2 means.</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#t.test"><span class="header-section-number">6.6.1</span> t.test()</a></li>
<li><a class="nav-link" href="#bootstrapping-in-r"><span class="header-section-number">6.6.2</span> Bootstrapping in R</a></li>
<li><a class="nav-link" href="#nba-salaries-example-from-iscam-inv-4.2"><span class="header-section-number">6.6.3</span> NBA Salaries example from ISCAM Inv 4.2</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reflection-questions-4"><span class="header-section-number">6.7</span>  Reflection Questions</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#quantitative-variable-ims-section-7.1"><span class="header-section-number">6.7.1</span> 1 quantitative variable: IMS Section 7.1</a></li>
<li><a class="nav-link" href="#means-1-quantitative-variable-1-binary-variable-ims-section-7.2"><span class="header-section-number">6.7.2</span> 2 means (1 quantitative variable, 1 binary variable): IMS Section 7.2</a></li>
<li><a class="nav-link" href="#wont-cover-spring-2022-paired-sample-difference-in-means-ims-section-7.3"><span class="header-section-number">6.7.3</span> (won’t cover spring 2022) Paired sample, difference in means: IMS Section 7.3</a></li>
<li><a class="nav-link" href="#anova-ims-section-7.5"><span class="header-section-number">6.7.4</span> ANOVA: IMS Section 7.5</a></li>
</ul>
</li>
<li><a class="nav-link" href="#ethics-considerations-4"><span class="header-section-number">6.8</span>  Ethics Considerations</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/hardin47/website/blob/master/04-InfNum.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/hardin47/website/edit/master/04-InfNum.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to (Bio)Statistics</strong>" was written by Jo Hardin. It was last built on 2023-02-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
