# Graphics {#sec-grammar-graphics}

Data visualization is integral to understanding both data and models.  Computational statistics and data science sometimes focus on models or resulting predictions from the models.  But there is no doubt that the structure and format of the data are the key to whether or not a model is appropriate or good.  A good data analyst will always spend a lot of time and effort on exploratory data analysis, much of which includes making as many visualizations of the data as possible.

```{r, include=FALSE, eval=TRUE, echo=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(message=FALSE, warning=FALSE, 
                      fig.height=3, fig.width=5,  
                      cache=TRUE, fig.align = "center")

library(tidyverse)
```



Depending on other classes you have had, your instructor may have focused more or less on visualizations in class.  They (I) may have even said something like *making visualizations are incredibly important to the entire data analysis process.*  But even if you buy that perspective, why is it that we don't see more good graphics in our analyses?   Andrew Gelman [@Gelman11] responds by stating, "Good statistical graphics are hard to do, much harder than running regressions and making tables."   

::: callout-important
Our goal will be to create graphics and visualizations that convey statistical information.
:::

Nolan [@Nolan16] describes three important ways that graphics can be used to convey statistical information.  The "guiding principles" will be used as a way of evaluating others' figures as well as a metric for creating our own visualizations to help with statistical analysis.

1.  *Make the data stand out* 

The important idea here is to find anything unusual in the data.  Are there patterns?  Outliers?  What are the bounds of the variables?  How should the axes be scaled?  Are transformations warranted?   

2. *Facilitate comparison*

The second item allows us to consider the research questions at hand. What are the important variables?  How do we emphasize them?  Which variables should be plotted together?  Can they be super-imposed?  Does color, plotting character, size of plot character help to bring out the important relationships?  Be aware of over plotting and issues of color blindness. 

<a href = "http://colorbrewer2.org/" target = "_blank">Color Brewer</a> is a diagnostic tool for evaluating the robustness of individual color schemes. 

3. *Add information*

Plots should also add context to the comparison.  Figure legends, axes scales, and reference markers (e.g., a line at $y=x$) go a long way toward helping the reader understand your message.  Captions should be self-contained (and not assume the user has also read your text) and descriptive; they should summarize the content of the figure and the conclusion related to the message you want to convey.


Randy Pruim asks the following question to decide whether or not a plot is good:  *Does my plot make the comparisons I am interested in...*

* easily? and
* accurately?

Consider adding alt text to allow screen readers to parse the image.  The DataViz Society/Nightingale by way of Amy Cesal has an article on writing good alt text for plots/graphs, <a href = "https://medium.com/nightingale/writing-alt-text-for-data-visualization-2a218ef43f81" target = "_blank">Writing Alt Text for Data Visualization</a>.

## Examples

The first two examples are taken from a book by Edward Tufte who is arguably a master at visualizations.  The book is *Visual and Statistical Thinking: Displays of Evidence for Making decisions*.  The book can be purchased at http://www.edwardtufte.com/tufte/books_textb, though there may be online versions of it that you can download. 


##### An aside {-}
Generally, the better your graphics are, the better able you will be to communicate ideas broadly (that's how you become rich and famous).  By graphics I mean not only figures associated with analyses, but also power point presentations, posters, and information on your website provided for other scientists who might be interested in your work.  Tufte is a master at understanding how to convey information visually, and I strongly recommend you look at his work.  Start with Wikipedia where some of his main ideas are provided (e.g., "data-ink ratio") and then check out his incredible texts.  I have many of them in my office and am happy to let you peruse them. http://www.edwardtufte.com/tufte/books_vdqi


As mentioned in the booklet we are using, there are two main motivational steps to working with graphics as part of an argument [@Tufte97].

1. "An essential analytic task in making decisions based on evidence is to understand how things work."
2. Making decisions based on evidence requires the appropriate display of that evidence."

Back to the examples... 

### Cholera via Tufte

In September 1854, the worst outbreak of cholera in London occurred in a few block radius - within 10 days, there were more than 500 fatalities.  John Snow recognized the clumping of deaths, and hypothesized that they were due to contamination of the Broad Street water pump.  Despite testing the water from the pump and finding no suspicious impurities, he did notice that the water quality varies from data to day.  More importantly, there seemed to be no other possible causal mechanism for the outbreak.  Eight days after the outbreak began, Snow described his findings to the authorities, and the Board of Guardians of St. James's Parish ordered the Broad Street pump handle removed.  The epidemic ended soon after. 

*Why was John Snow successful at solving the problem?*  Some thoughts to consider (as reported in @Tufte97):

1. The bacterium *Vibrio cholerae* was not discovered until 1886, however Snow had myriad experience both as a medical doctor and in looking at patterns of of other outbreaks.  He was the first to realized that cholera was transmitted through water instead of by air or other means.

2. **Data in Context**  Snow thought carefully about how to present the data.  Instead of simply looking at the data as counts or frequencies, he looked at the death *spatially* - on a map of the area.

3. **Comparisons**  In order to isolate the pump as the *cause* of the outbreak, Snow needed to understand how the individuals who had died were different than the individuals who had survived.  Snow found two other groups of individuals (brewers who drank only beer, and employees at a work house who had an on-site pump) who had not succumbed to the disease.

4. **Alternatives**  Whenever a theory is present, it is vitally important to contrast the theory against all possible alternative possibilities.  In Snow's case, he needed to consider all individuals who did not regularly use the Broad Street pump - he was able to understand the exceptions in every case.

5. Did removing the pump handle really *cause* the outbreak to cease?  Wasn't it already on the decline?

6. **Assessment of the Graphic**  Did the individuals die at the place on the map?  Live at the place on the map? Which (types of) individuals were missing from the graph?  Missing at random?  What decisions did he make in creating the graph (axes, binning of histogram bars, time over which data are plotted, etc.) that change the story needing to be told?



### Challenger via Tufte

John Snow's story of the successful graphical intervention in the cholera outbreak is contrasted with the fateful poor-graphical non-intervention of the Challenger disaster.  On January 28, 1986, the space shuttle Challenger took off from Cape Canaveral, FL and immediately exploded, killing all seven astronauts aboard.  We now know that the reason for the explosion was due to the failure of two rubber O-rings which malfunctioned due to the cold temperature of the day ($\sim 29^\circ$ F).   

Unlike the cholera epidemic, those who understood the liability of a shuttle launch under cold conditions were unable to convince the powers that be to postpone the launch (there was much political momentum going forward to get the shuttle off the ground, including the first teacher in space, Christa McAuliffe).  As seen in the Tufte chapter, the evidence was clear but not *communicated*! 

The biggest problem (existing in many of the bullet points below) is that the engineers failed to as the important question about the data: **in relation to what??**

1. The engineers who understood the problem created tables and engineering graphs which were
     (a) Not visually appealing.
     (b) Not decipherable to the layman (e.g., "At about $50^\circ$ F blow-by could be experienced in case joints")
     (c) There was also no authorship (reproducibility!).  **Figures should always have both accountability and reproducibility.**

2. The information provided included very relevant points (about temperature) and superfluous information unrelated to temperature.  The univariate analysis was insufficient because the story the data were trying to tell was about the **bivariate relationship between temperature and o-ring failure**.

3. Missing data created an illusion of *lack of evidence*, when in fact, the true story was quite strong given the full set of information.  (92% of the temperature data was missing from some of the most vital tables.)

4. Anecdotal evidence was misconstrued:  SRM-15 at 57F had the most damage, but SRM-22 at 75F had the second most damage.

5. In the end, the shuttle launched on a day which was an extrapolation from the model suggested by the data.  They had never launched a shuttle at temperatures of $26^\circ-29^\circ$F.

6. Tufte goes on to describe many ways which the final presentation by the engineers to the administrators was inadequate:  disappearing legend (labels), chartjunk, lack of clarity depicting cause and effect, and wrong order.

As with the cholera outbreak, a persuasive argument could have been made if the visualizations had

(1) been in context *plot data versus temperature not time!*, 
(2) used appropriate comparisons: *as compared with what?*, 
(3) consider alternative scenarios *when else did O-rings fail?  What is the science behind O-ring failure?*, and 
(4) the graphics had been assessed *what is all of the extra noise?  are the words being used accessible to non-engineers?*. 

Tufte [@Tufte97] created the graphic below which should have been used before the launch to convince others to postpone.  As you can see, the graphic is extremely convincing.  An aside: the O-ring data are well suited for an analysis using logistic regression.  Today, most scientists believe that the temperature *caused* the O-ring failure, however, the data do not speak to the causal relationship because they were not collected using a randomized experiment.  That is, there could have been other confounding variables (e.g., humidity) which were possible causal mechanisms.


```{r fig.cap = "The graphic the engineers should have led with in trying to persuade the administrators not to launch.  It is evident that the number of O-ring failures is quite highly associated with the ambient temperature.  Note the *vital* information on the x-axis associated with the large number of launches at warm temperatures that had *zero* O-ring failures. [@Tufte97]", fig.align='center', echo=FALSE}
knitr::include_graphics("images/TuftestemperatureandOringrelationshi.jpg")
```

## Thoughts on Plotting {#thoughts}

### Advice

(I think that the advice below is a compilation of important ideas from many amazing graphical and visual scientists and what I've come to know from my own work.  For example see @Yau, @cleveland1984, @Tufte97. The advice, however, may have come more directly from another single source (which I am currently unable to find), and I am appreciative of such good advice.)

* Think carefully about the basic plot
    - Avoid having other graph elements interfere with data
    - Use visually prominent symbols
    - Avoid over-plotting  (One way to avoid over plotting: Jitter the values)
    - Different values of data may obscure each other
    - Include all or nearly all of the data
    - Fill data region
* Eliminate superfluous material
    - Chart junk & stuff that adds no meaning, e.g. butterflies on top of barplots, background images
    - Extra tick marks and grid lines
    - Unnecessary text and arrows
    - Decimal places beyond the measurement error or the level of difference
* Facilitate Comparisons
    - Put juxtaposed plots on same scale
    - Make it easy to distinguish elements of  superposed plots (e.g. color)
    - Emphasizes the important difference
    - Comparison: volume, area, height  (be careful, volume can seem bigger than you mean it to)
* Choose the scale well (n.b., some of the principles may go counter to one another, use your judgment.)
    - Keep scales on x and y axes the same for both plots to facilitate the comparison
    - Zoom in to focus on the region that contains the bulk of the data
    - Keep the scale the same throughout the plot (i.e. don't change it mid-axis)
    - Origin need not be on the scale
    - Choose a scale that improves resolution
    - Avoid jiggling the baseline
* How to make a plot information rich
    - Describe what you see in the caption
    - Add context with reference markers (lines and points) including text
    - Add legends and labels
    - Use color and plotting symbols to add more information
    - Plot the same thing more than once in different ways/scales
    - Reduce clutter
* Create good captions
    - Be comprehensive
    - Self-contained
    - Describe what has been graphed
    - Draw attention to important features
    - Describe conclusions drawn from graph
* Follow good plot making practice
    - Put major conclusions in graphical form
    - Provide reference information
    - Proof read for clarity and consistency
    - Graphing is an iterative process
    - Multiplicity is OK, i.e. two plots of the same variable may provide different messages
    - Make plots data rich


Creating a statistical graphic is an iterative process of discovery and fine tuning. We try to model the process of creating visualizations in the course by dedicating class time to an iterative creation of a plot. We begin either with a plot that screams for correction, and we transform it step-by-step, always thinking about the goal of a graph that is data rich and presents a clear vision of the important features of the data.

### An example from Information is Beautiful

Consider the plot at http://www.informationisbeautiful.net/visualizations/caffeine-and-calories/.  Note that the origin is at the point (150,150).  While we can get over the hurdle, it is not what is expected when looking at a graph.


```{r fig.cap = "http://infobeautiful3.s3.amazonaws.com/2013/01/1276_buzz_v_bulge.png", fig.width = 7, fig.align='center', echo=FALSE}
knitr::include_graphics("images/buzzvbulge.png")
```

I have removed the vertical and horizontal lines which detracted from the idea of an origin.  I have also added additional information (color) to describe the chain from which the drink comes from.  Notice that an additional difference between my plot and the original plot is that I have many more observations.


```{r fig.cap = "Calories and Caffeine for drinks from various drinks and other items.  Data source is: World Cancer Research Fund, Starbucks Beverage Nutrition Guide, Calorie Counter Database.  Seemingly, the observational units (rows) are not a random sample of anything.  As such, we should be careful of summarizing the data in any way - what would the 'average' calories even mean?  Note, from the entire dataset give, the average calories is 179.8 and the average caffeine is 134.43.  How do those numbers compare to the original plot?", fig.width = 7, fig.align='center', echo=FALSE}
knitr::include_graphics("images/Math154_HW2_viz-ggdrink.png")
```

Data retrieved from: 
https://docs.google.com/spreadsheets/d/1KYMUjrCulPtpUHwep9bVvsBvmVsDEbucdyRZ5uHCDxw/edit?hl=en_GB#gid=0


#### Fonts Matter

At RStudio::conf 2020, [The Glamour of Graphics](https://rstudio.com/resources/rstudioconf-2020/the-glamour-of-graphics/), Will Chase makes some very important points about how and why making good graphics matters. The talk might be summarized by the plot below: fonts matter.


```{r, out.width = "500px", echo=FALSE}
knitr::include_graphics("images/fontsmatter.png")
``` 

### Assessing Graphics (and Other Analyses)

| Critical Task 	| Needs Improvement 	| Basic 	| Surpassed 	|
|------------------------------------------------------------------------------------------------	|-------------------------------------------------------------------------------	|---------------------------------------------------------------------------------------------------	|--------------------------------------------------------------------------------------	|
| **Computation** Perform computations 	| Computations contain errors and extraneous code 	| Computations are correct but contain extraneous / unnecessary computations 	| Computations are correct and properly identified and labeled 	|
| **Analysis** Choose and carry out analysis appropriate for data and content(s) 	| Choice of analysis is overly simplistic, irrelevant, or missing key component 	| Analysis appropriate, but incomplete, or not important features and assumptions not made explicit 	| Analysis appropriate, complete, advanced, relevant, and informative 	|
| **Synthesis** Identify key features of the analysis, and interpret results (including context) 	| Conclusions are missing, incorrect, or not made based on results of analysis 	| Conclusions reasonable, but is partially correct or partially complete 	| Make relevant conclusions explicitly connect to analysis and to context 	|
| **Visual presentation** Communicate findings graphically clearly, precisely, and concisely 	| Inappropriate choice of plots; poorly labeled plots; plots missing 	| Plots convey information correctly but lack context for interpretation 	| Plots convey information correctly with adequate / appropriate reference information 	|
| **Written** Communicate findings clearly, precisely, and concisely 	| Explanation is illogical, incorrect, or incoherent 	| Explanation is partially correct but incomplete or unconvincing 	| Explanation is correct, complete, and convincing 	|

A rubric for assessing analysis and corresponding visualization.  Note that there can be a large amount of information gained in moving from basic competency to surpassed competency.  Table taken from @Nolan16.


<!---
% look at Di's plenary talk from rstudio::conf 2018
% (1) making many different plots from the same data, they show very different things!
% (2) ideas of null plots
--->

## <i class="fas fa-lightbulb"></i> Reflection questions  

* What different aspects deconstruct a plot?

* Provide some of the guidelines which lead to improved visualizations.

* Consider the comparison of interest, does your plot make that comparison easily and accurately?

## <i class="fas fa-balance-scale"></i> Ethics considerations 
* What are you trying to communicate with your plot?  Is that what your graph communicates?

* Did you add alt text to your images? (see <a href = "https://medium.com/nightingale/writing-alt-text-for-data-visualization-2a218ef43f81" target = "_blank">Writing Alt Text for Data Visualizations</a>)

* Is your plot accessible to those who are color blind or looking at the image in black and white?



