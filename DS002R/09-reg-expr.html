<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.4.553" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />

<meta name="author" content="Jo Hardin" />

<title>Foundations of Data Science in R – 9  Regular expressions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="text/x-mathjax-config">
const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers){
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');
  
  // Will this work with TeX on its own line?
  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
  	MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
  	MathJax.Hub.Queue(function(){
      popover.setAttribute('data-content', div.innerHTML);
  	})
  }
}
</script>

<link rel="shortcut icon" href="figs/favicon.ico" />

<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="stylesheet" media="screen" href="https://fonts.googleapis.com/css2?family=Quicksand" type="text/css"/>


</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn"
      data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" 
      aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
      onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <h1 class="quarto-secondary-nav-title no-breadcrumbs"></h1>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" 
        aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation"
        onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="/">
      Foundations of Data Science in R
      </a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/hardin47/ds002r-fds"  title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome to Foundations of Data Science in R</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="/p0-data-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to data science</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/02-github.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>2</span>  <span class='chapter-title'>GitHub</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="/p1-data-acquire.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data acquisition</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/03-rvest.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>3</span>  <span class='chapter-title'>Web scraping</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/04-sql-in-R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>4</span>  <span class='chapter-title'>SQL in R and DBeaver</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/05-sql-verbs.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>5</span>  <span class='chapter-title'>SQL clauses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/06-sql-joins.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>6</span>  <span class='chapter-title'>Combining tables in SQL</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="/p2-data-explore.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data exploration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/07-wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>7</span>  <span class='chapter-title'>Data Wrangling</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/08-text-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>8</span>  <span class='chapter-title'>Text analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/09-reg-expr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class='chapter-number'>9</span>  <span class='chapter-title'>Regular expressions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="/p3-data-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data visualization</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/10-grammar-graphics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>10</span>  <span class='chapter-title'>Grammar of graphics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/11-ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>11</span>  <span class='chapter-title'>ggplot</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="/p4-data-conclude.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data conclusions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/12-iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>12</span>  <span class='chapter-title'>Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/13-permutation-tests.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>13</span>  <span class='chapter-title'>Permutation tests</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="/p5-data-communicate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Data communication</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/14-version-control.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>14</span>  <span class='chapter-title'>Version control</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/15-R-tip-of-the-day.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>15</span>  <span class='chapter-title'>R tip-of-the-day</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="/16-reprex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class='chapter-number'>16</span>  <span class='chapter-title'>Reproducible examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" ></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-reg-expr" class="quarto-section-identifier"><span class="chapter-number">9</span>  <span class="chapter-title">Regular expressions</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#r-packages-to-make-your-life-easier" id="toc-r-packages-to-make-your-life-easier"><span class="header-section-number">9.1</span> R packages to make your life easier</a></li>
  <li><a href="#tools-for-characterizing-a-regular-expression" id="toc-tools-for-characterizing-a-regular-expression"><span class="header-section-number">9.2</span> Tools for characterizing a regular expression</a>
  <ul>
  <li><a href="#escape-sequences" id="toc-escape-sequences"><span class="header-section-number">9.2.1</span> Escape sequences</a></li>
  <li><a href="#quantifiers" id="toc-quantifiers"><span class="header-section-number">9.2.2</span> Quantifiers</a></li>
  <li><a href="#position-of-pattern-within-the-string" id="toc-position-of-pattern-within-the-string"><span class="header-section-number">9.2.3</span> Position of pattern within the string</a></li>
  <li><a href="#operators" id="toc-operators"><span class="header-section-number">9.2.4</span> Operators</a></li>
  <li><a href="#character-classes" id="toc-character-classes"><span class="header-section-number">9.2.5</span> Character classes</a></li>
  </ul></li>
  <li><a href="#examples-to-work-through" id="toc-examples-to-work-through"><span class="header-section-number">9.3</span> Examples to work through</a>
  <ul>
  <li><a href="#case-insenstive" id="toc-case-insenstive"><span class="header-section-number">9.3.1</span> Case insenstive</a></li>
  <li><a href="#proper-times-and-dates" id="toc-proper-times-and-dates"><span class="header-section-number">9.3.2</span> Proper times and dates</a></li>
  <li><a href="#alternation-operator" id="toc-alternation-operator"><span class="header-section-number">9.3.3</span> Alternation operator</a></li>
  <li><a href="#an-example-from-my-work" id="toc-an-example-from-my-work"><span class="header-section-number">9.3.4</span> An example from my work</a></li>
  </ul></li>
  <li><a href="#lookaround" id="toc-lookaround"><span class="header-section-number">9.4</span> Lookaround</a></li>
  <li><a href="#example---taskmaster" id="toc-example---taskmaster"><span class="header-section-number">9.5</span> Example - Taskmaster</a>
  <ul>
  <li><a href="#scraping-and-wrangling-taskmaster" id="toc-scraping-and-wrangling-taskmaster"><span class="header-section-number">9.5.1</span> Scraping and wrangling Taskmaster</a></li>
  <li><a href="#cleaning-the-score-column" id="toc-cleaning-the-score-column"><span class="header-section-number">9.5.2</span> Cleaning the score column</a></li>
  </ul></li>
  <li><a href="#extracting-episode-information" id="toc-extracting-episode-information"><span class="header-section-number">9.6</span> Extracting episode information</a></li>
  <li><a href="#lookaround-again" id="toc-lookaround-again"><span class="header-section-number">9.7</span> Lookaround (again)</a>
  <ul>
  <li><a href="#lookbehinds" id="toc-lookbehinds"><span class="header-section-number">9.7.1</span> Lookbehinds</a></li>
  <li><a href="#lookaheads" id="toc-lookaheads"><span class="header-section-number">9.7.2</span> Lookaheads</a></li>
  </ul></li>
  <li><a href="#regular-expressions-and-sql" id="toc-regular-expressions-and-sql"><span class="header-section-number">9.8</span> Regular expressions and <strong>SQL</strong></a></li>
  <li><a href="#reflection-questions" id="toc-reflection-questions"><span class="header-section-number">9.9</span> <i class="fas fa-lightbulb"></i> Reflection questions</a></li>
  <li><a href="#ethics-considerations" id="toc-ethics-considerations"><span class="header-section-number">9.10</span> <i class="fas fa-balance-scale"></i> Ethics considerations</a></li>
  </ul>
</nav>
<!--
* think about using regular expressions when scraping data from a website

* use TidyTuesday from 11/29/23 to link Dr. Who rankings with IMDb rankings.-->
<blockquote>
<p>A regular expression … is a sequence of characters that define a search pattern. Usually such patterns are used by string searching algorithms for “find” or “find and replace” operations on strings, or for input validation. It is a technique developed in theoretical computer science and formal language theory. [From https://en.wikipedia.org/wiki/Regular_expression]</p>
</blockquote>
<p>Regular expressions are composed of two types of characters:</p>
<ul>
<li>special characters (like <code>*</code>) are called <em>metacharacters</em></li>
<li>all other characters are called normal text characters or <em>literal</em> characters</li>
</ul>
<p>The metacharacters allow for advanced pattern matching in finding regular expressions.</p>
<section id="main-tasks-in-character-matching" class="level4 unnumbered">
<h4 class="unnumbered">Main tasks in character matching:</h4>
<ol type="1">
<li>basic string operations</li>
<li>pattern matching (regular expressions)</li>
<li>sentiment analysis</li>
</ol>
<p>Many of the ideas below are taken from <a href = "https://github.com/STAT545-UBC/STAT545-UBC-original-website/blob/master/block022_regular-expression.rmd" target = "_blank">Jenny Bryan’s STAT545 class</a>.</p>
</section>
<section id="r-packages-to-make-your-life-easier" class="level2" data-number="9.1">
<h2 data-number="9.1"><span class="header-section-number">9.1</span> R packages to make your life easier</h2>
<ul>
<li><a href="https://stringr.tidyverse.org/"><strong>stringr</strong> package</a> A core package in the <strong>tidyverse</strong>. It is installed via <code>install.packages("tidyverse")</code> and also loaded via <code>library(tidyverse)</code>. Of course, you can also install or load it individually.
<ul>
<li>Many of the main functions start with <code>str_</code>. Auto-complete is your friend.</li>
<li>Replacements for base functions re: string manipulation and regular expressions (see below).</li>
<li>Main advantages over base functions: greater consistency about inputs and outputs. Outputs are more ready for your next analytical task.</li>
<li><a href = "https://github.com/rstudio/cheatsheets/raw/master/strings.pdf" target = "_blank"><strong>stringr</strong> cheat sheet</a></li>
</ul></li>
<li><a href="https://tidyr.tidyverse.org/"><code>tidyr</code> package</a> Especially useful for functions that split one character vector into many and vice versa: <code>separate()</code>, <code>unite()</code>, <code>extract()</code>.</li>
<li>Base functions: <code>nchar()</code>, <code>strsplit()</code>, <code>substr()</code>, <code>paste()</code>, <code>paste0()</code>.</li>
<li>The <code>glue</code> package is fantastic for string interpolation. If <code>stringr::str_interp()</code> doesn’t get your job done, check out the <code>glue</code> package.</li>
</ul>
<section id="string-functions-related-to-regular-expression" class="level4 unnumbered">
<h4 class="unnumbered">String functions related to regular expression</h4>
<p>Regular expression is a pattern that describes a specific set of strings with a common structure. It is heavily used for string matching / replacing in many programming languages, although specific syntax may differ a bit. It is truly the heart and soul for string operations. In R, many string functions in <code>base</code> R as well as in <strong>stringr</strong> package use regular expressions, even RStudio’s search and replace allows regular expression:</p>
<ul>
<li>identify match to a pattern: <code>grep(..., value = FALSE)</code>, <code>grepl()</code>, <code>stringr::str_detect()</code></li>
<li>extract match to a pattern: <code>grep(..., value = TRUE)</code>, <code>stringr::str_extract()</code>, <code>stringr::str_extract_all()</code><br />
</li>
<li>locate pattern within a string, i.e. give the start position of matched patterns. <code>regexpr()</code>, <code>gregexpr()</code>, <code>stringr::str_locate()</code>, <code>string::str_locate_all()</code><br />
</li>
<li>replace a pattern: <code>sub()</code>, <code>gsub()</code>, <code>stringr::str_replace()</code>, <code>stringr::str_replace_all()</code><br />
</li>
<li>split a string using a pattern: <code>strsplit()</code>, <code>stringr::str_split()</code></li>
</ul>
<p>Regular expressions typically specify characters (or character classes) to seek out, possibly with information about repeats and location within the string. This is accomplished with the help of metacharacters that have specific meaning: <code>$ * + . ? [ ] ^ { } | ( ) \</code>. We will use some small examples to introduce regular expression syntax and what these metacharacters mean.</p>
<p><code>grep()</code> stands for “global regular expression print”. <code>grep()</code> returns a character vector containing the selected elements, <code>grepl()</code> returns a logical vector of TRUE/FALSE for whether or not there was a match.</p>
</section>
</section>
<section id="tools-for-characterizing-a-regular-expression" class="level2" data-number="9.2">
<h2 data-number="9.2"><span class="header-section-number">9.2</span> Tools for characterizing a regular expression</h2>
<section id="escape-sequences" class="level3" data-number="9.2.1">
<h3 data-number="9.2.1"><span class="header-section-number">9.2.1</span> Escape sequences</h3>
<p>There are some special characters in R that cannot be directly coded in a string. For example, let’s say you specify your pattern with single quotes and you want to find countries with the single quote <code>'</code>. You would have to “escape” the single quote in the pattern, by preceding it with <code>\</code>, so it is clear that it is not part of the string-specifying machinery.</p>
<p>There are other characters in R that require escaping, and this rule applies to all string functions in R, including regular expressions. See <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/Quotes.html">here</a> for a complete list of R escape sequences.</p>
<ul>
<li><code>\'</code>: single quote. You don’t need to escape single quote inside a double-quoted string, so we can also use <code>" ' "</code>.<br />
</li>
<li><code>\"</code>: double quote. Similarly, double quotes can be used inside a single-quoted string, i.e. <code>' " '</code>.<br />
</li>
<li><code>\n</code>: newline.<br />
</li>
<li><code>\r</code>: carriage return.<br />
</li>
<li><code>\t</code>: tab character.</li>
</ul>
<blockquote>
<p>Note: <code>cat()</code> and <code>print()</code> handle escape sequences differently, if you want to print a string out with the interpretation of the sequences above, use <code>cat()</code>.</p>
</blockquote>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;a</span><span class="sc">\n</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;a\nb&quot;</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;a</span><span class="sc">\n</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a
b</code></pre>
</div>
</div>
</section>
<section id="quantifiers" class="level3" data-number="9.2.2">
<h3 data-number="9.2.2"><span class="header-section-number">9.2.2</span> Quantifiers</h3>
<p>Quantifiers specify how many repetitions of the pattern.</p>
<ul>
<li><code>*</code>: matches at least 0 times.<br />
</li>
<li><code>+</code>: matches at least 1 times.<br />
</li>
<li><code>?</code>: matches at most 1 times.<br />
</li>
<li><code>{n}</code>: matches exactly n times.<br />
</li>
<li><code>{n,}</code>: matches at least n times.<br />
</li>
<li><code>{n,m}</code>: matches between n and m times.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;ab&quot;</span>, <span class="st">&quot;acb&quot;</span>, <span class="st">&quot;accb&quot;</span>, <span class="st">&quot;acccb&quot;</span>, <span class="st">&quot;accccb&quot;</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac*b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;ab&quot;     &quot;acb&quot;    &quot;accb&quot;   &quot;acccb&quot;  &quot;accccb&quot;</code></pre>
</div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac*b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2 3 4 5 6</code></pre>
</div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac+b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;acb&quot;    &quot;accb&quot;   &quot;acccb&quot;  &quot;accccb&quot;</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac?b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;ab&quot;  &quot;acb&quot;</code></pre>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac{2}b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;accb&quot;</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac{2,}b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;accb&quot;   &quot;acccb&quot;  &quot;accccb&quot;</code></pre>
</div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ac{2,3}b&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;accb&quot;  &quot;acccb&quot;</code></pre>
</div>
</div>
</section>
<section id="position-of-pattern-within-the-string" class="level3" data-number="9.2.3">
<h3 data-number="9.2.3"><span class="header-section-number">9.2.3</span> Position of pattern within the string</h3>
<ul>
<li><code>^</code>: matches the start of the string.<br />
</li>
<li><code>$</code>: matches the end of the string.<br />
</li>
<li><code>\b</code>: matches the boundary of a <em>word</em>. Don’t confuse it with <code>^ $</code> which marks the edge of a <em>string</em>.<br />
</li>
<li><code>\B</code>: matches the empty string provided it is not at an edge of a word.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb19"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;abcd&quot;</span>, <span class="st">&quot;cdab&quot;</span>, <span class="st">&quot;cabd&quot;</span>, <span class="st">&quot;c abd&quot;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ab&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abcd&quot;  &quot;cdab&quot;  &quot;cabd&quot;  &quot;c abd&quot;</code></pre>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;^ab&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abcd&quot;</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ab$&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;cdab&quot;</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">bab&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abcd&quot;  &quot;c abd&quot;</code></pre>
</div>
</div>
</section>
<section id="operators" class="level3" data-number="9.2.4">
<h3 data-number="9.2.4"><span class="header-section-number">9.2.4</span> Operators</h3>
<ul>
<li><code>.</code>: matches any single character, as shown in the first example.</li>
<li><code>[...]</code>: a character list, matches any one of the characters inside the square brackets. We can also use <code>-</code> inside the brackets to specify a range of characters.<br />
</li>
<li><code>[^...]</code>: an inverted character list, similar to <code>[...]</code>, but matches any characters <strong>except</strong> those inside the square brackets.<br />
</li>
<li><code>\</code>: suppress the special meaning of metacharacters in regular expression, i.e. <code>$ * + . ? [ ] ^ { } | ( ) \</code>, similar to its usage in escape sequences. Since <code>\</code> itself needs to be escaped in R, we need to escape these metacharacters with double backslash like <code>\\$</code>.<br />
</li>
<li><code>|</code>: an “or” operator, matches patterns on either side of the <code>|</code>.<br />
</li>
<li><code>(...)</code>: grouping in regular expressions. This allows you to retrieve the bits that matched various parts of your regular expression so you can alter them or use them for building up a new string. Each group can than be refer using <code>\\N</code>, with N being the No. of <code>(...)</code> used. This is called <strong>backreference</strong>.</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb27"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;^ab&quot;</span>, <span class="st">&quot;ab&quot;</span>, <span class="st">&quot;abc&quot;</span>, <span class="st">&quot;abd&quot;</span>, <span class="st">&quot;abe&quot;</span>, <span class="st">&quot;ab 12&quot;</span>, <span class="st">&quot;a|b&quot;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ab.&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abc&quot;   &quot;abd&quot;   &quot;abe&quot;   &quot;ab 12&quot;</code></pre>
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ab[c-e]&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abc&quot; &quot;abd&quot; &quot;abe&quot;</code></pre>
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;ab[^c]&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abd&quot;   &quot;abe&quot;   &quot;ab 12&quot;</code></pre>
</div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;^ab&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;ab&quot;    &quot;abc&quot;   &quot;abd&quot;   &quot;abe&quot;   &quot;ab 12&quot;</code></pre>
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;</span><span class="sc">\\</span><span class="st">^ab&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;^ab&quot;</code></pre>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;abc|abd&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;abc&quot; &quot;abd&quot;</code></pre>
</div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grep</span>(<span class="st">&quot;a[b|c]&quot;</span>, strings, <span class="at">value =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;^ab&quot;   &quot;ab&quot;    &quot;abc&quot;   &quot;abd&quot;   &quot;abe&quot;   &quot;ab 12&quot; &quot;a|b&quot;  </code></pre>
</div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(strings, <span class="st">&quot;a[b|c]&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;ab&quot; &quot;ab&quot; &quot;ab&quot; &quot;ab&quot; &quot;ab&quot; &quot;ab&quot; &quot;a|&quot;</code></pre>
</div>
</div>
</section>
<section id="character-classes" class="level3" data-number="9.2.5">
<h3 data-number="9.2.5"><span class="header-section-number">9.2.5</span> Character classes</h3>
<p>Character classes allow specifying entire classes of characters, such as numbers, letters, etc. There are two flavors of character classes, one uses <code>[:</code> and <code>:]</code> around a predefined name inside square brackets and the other uses <code>\</code> and a special character. They are sometimes interchangeable.</p>
<ul>
<li>(?i) before the string indicates that the match should be case insensitive.</li>
<li><code>[:digit:]</code> or <code>\d</code>: digits, 0 1 2 3 4 5 6 7 8 9, equivalent to <code>[0-9]</code>.<br />
</li>
<li><code>\D</code>: non-digits, equivalent to <code>[^0-9]</code>.<br />
</li>
<li><code>[:lower:]</code>: lower-case letters, equivalent to <code>[a-z]</code>.<br />
</li>
<li><code>[:upper:]</code>: upper-case letters, equivalent to <code>[A-Z]</code>.<br />
</li>
<li><code>[:alpha:]</code>: alphabetic characters, equivalent to <code>[[:lower:][:upper:]]</code> or <code>[A-z]</code>.<br />
</li>
<li><code>[:alnum:]</code>: alphanumeric characters, equivalent to <code>[[:alpha:][:digit:]]</code> or <code>[A-z0-9]</code>.<br />
</li>
<li><code>\w</code>: word characters, equivalent to <code>[[:alnum:]_]</code> or <code>[A-z0-9_]</code> (letter, number, or underscore).</li>
<li><code>\W</code>: not word, equivalent to <code>[^A-z0-9_]</code>.<br />
</li>
<li><code>[:xdigit:]</code>: hexadecimal digits (base 16), 0 1 2 3 4 5 6 7 8 9 A B C D E F a b c d e f, equivalent to <code>[0-9A-Fa-f]</code>.</li>
<li><code>[:blank:]</code>: blank characters, i.e. space and tab.<br />
</li>
<li><code>[:space:]</code>: space characters: tab, newline, vertical tab, form feed, carriage return, space.</li>
<li><code>\s</code>: space, <code></code>. Matches any whitespace (space, tab, newline, and carriage return).</li>
<li><code>\S</code>: not space.<br />
</li>
<li><code>[:punct:]</code>: punctuation characters, ! ” # $ % &amp; ’ ( ) * + , - . / : ; &lt; = &gt; ? @ [  ] ^ _ ` { | } ~.</li>
<li><code>[:graph:]</code>: graphical (human readable) characters: equivalent to <code>[[:alnum:][:punct:]]</code>.</li>
<li><code>[:print:]</code>: printable characters, equivalent to <code>[[:alnum:][:punct:]\\s]</code>.</li>
<li><code>[:cntrl:]</code>: control characters, like <code>\n</code> or <code>\r</code>, <code>[\x00-\x1F\x7F]</code>.</li>
</ul>
<p>Note:<br />
* <code>[:...:]</code> has to be used inside square brackets, e.g. <code>[[:digit:]]</code>.<br />
* <code>\</code> itself is a special character that needs escape, e.g. <code>\\d</code>. Do not confuse these regular expressions with R escape sequences such as <code>\t</code>.</p>
</section>
</section>
<section id="examples-to-work-through" class="level2" data-number="9.3">
<h2 data-number="9.3"><span class="header-section-number">9.3</span> Examples to work through</h2>
<p>I have found that the best way to truly understand regular expressions is to work through as many examples as possible (actually, maybe this is true about learning anything new!). For the following examples, try to figure out the solution on your own before looking at the footnote which contains the solution.</p>
<section id="case-insenstive" class="level3" data-number="9.3.1">
<h3 data-number="9.3.1"><span class="header-section-number">9.3.1</span> Case insenstive</h3>
<ul>
<li>Match only the word <code>meter</code> in “The cemetery is 1 meter from the stop sign.” Also match <code>Meter</code> in “The cemetery is 1 Meter from the stop sign.”</li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;The cemetery is 1 meter from the stop sign.&quot;</span>, </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;The cemetery is 1 Meter from the stop sign.&quot;</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;(?i)</span><span class="sc">\\</span><span class="st">bmeter</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;meter&quot; &quot;Meter&quot;</code></pre>
</div>
</div>
</section>
<section id="proper-times-and-dates" class="level3" data-number="9.3.2">
<h3 data-number="9.3.2"><span class="header-section-number">9.3.2</span> Proper times and dates</h3>
<ul>
<li>Match dates like 01/15/24 and also like 01.15.24 and like 01-15-24.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;01/15/24&quot;</span>, <span class="st">&quot;01.15.24&quot;</span>, <span class="st">&quot;01-15-24&quot;</span>, <span class="st">&quot;01 15 24&quot;</span>, <span class="st">&quot;011524&quot;</span>, <span class="st">&quot;January 15, 2024&quot;</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d.</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d.</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;01/15/24&quot; &quot;01.15.24&quot; &quot;01-15-24&quot; &quot;01 15 24&quot; NA         NA        </code></pre>
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d[/.</span><span class="sc">\\</span><span class="st">-]</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d[/.</span><span class="sc">\\</span><span class="st">-]</span><span class="sc">\\</span><span class="st">d</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;01/15/24&quot; &quot;01.15.24&quot; &quot;01-15-24&quot; NA         NA         NA        </code></pre>
</div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d{2}[/.</span><span class="sc">\\</span><span class="st">-]</span><span class="sc">\\</span><span class="st">d{2}[/.</span><span class="sc">\\</span><span class="st">-]</span><span class="sc">\\</span><span class="st">d{2}&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;01/15/24&quot; &quot;01.15.24&quot; &quot;01-15-24&quot; NA         NA         NA        </code></pre>
</div>
</div>
<ul>
<li>Match a time of day such as “9:17 am” or “12:30 pm”. Require that the time be a valid time (not “99:99 pm”). Assume no leading zeros (i.e., “09:17 am”).<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb51"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;9:17 am&quot;</span>, <span class="st">&quot;12:30 pm&quot;</span>, <span class="st">&quot;99:99 pm&quot;</span>, <span class="st">&quot;09:17 am&quot;</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;(1[012]|[1-9]):[0-5][0-9] (am|pm)&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;9:17 am&quot;  &quot;12:30 pm&quot; NA         &quot;9:17 am&quot; </code></pre>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;^(1[012]|[1-9]):[0-5][0-9] (am|pm)$&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;9:17 am&quot;  &quot;12:30 pm&quot; NA         NA        </code></pre>
</div>
</div>
</section>
<section id="alternation-operator" class="level3" data-number="9.3.3">
<h3 data-number="9.3.3"><span class="header-section-number">9.3.3</span> Alternation operator</h3>
<p>The “or” operator, <code>|</code> has the lowest precedence and parentheses have the highest precedence, which means that parentheses get evaluated before “or”.</p>
<ul>
<li>What is the difference between <code>\bMary|Jane|Sue\b</code> and <code>\b(Mary|Jane|Sue)\b</code>?<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></li>
</ul>
<div class="cell">
<div class="sourceCode" id="cb55"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>string <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Mary&quot;</span>, <span class="st">&quot;Mar&quot;</span>, <span class="st">&quot;Janet&quot;</span>, <span class="st">&quot;jane&quot;</span>, <span class="st">&quot;Susan&quot;</span>, <span class="st">&quot;Sue&quot;</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">bMary|Jane|Sue</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Mary&quot; NA     &quot;Jane&quot; NA     NA     &quot;Sue&quot; </code></pre>
</div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(string, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">b(Mary|Jane|Sue)</span><span class="sc">\\</span><span class="st">b&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Mary&quot; NA     NA     NA     NA     &quot;Sue&quot; </code></pre>
</div>
</div>
</section>
<section id="an-example-from-my-work" class="level3" data-number="9.3.4">
<h3 data-number="9.3.4"><span class="header-section-number">9.3.4</span> An example from my work</h3>
<p>Below are a handful of string characters that represent genomic sequences which were measured in an RNA Sequencing dataset. The task below is to find intergenic regions (IGR) and identify which coding sequences (CDS) bookend the intergenic regions. Note that IGRs do not code for proteins while CDSs do. Additionally, AS refers to anti-sense which identifies the genomic sequence in the opposite orientation (e.g., CGGATCC vs CCTAGGC). [The code below was written by Madison Hobbs, Scripps ’19.]</p>
<section id="the-names-of-the-genomic-pieces" class="level5 unnumbered">
<h5 class="unnumbered">The names of the genomic pieces</h5>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>allCounts <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Geneid =</span> <span class="fu">c</span>(<span class="st">&quot;CDS:b2743:pcm:L-isoaspartate_protein_carboxylmethyltransferase_type_II:cds2705:-:626:NC_000913.3&quot;</span>,</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;CDS:b2764:cysJ:sulfite_reductase2C_alpha_subunit2C_flavoprotein:cds2726:-:1799:NC_000913.3&quot;</span>,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;IGR:(CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220/CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893):+:945:NC_000913.3&quot;</span>,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;AS_IGR:(CDS,b0008,talB,transaldolase_B,cds7,+,953/CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587):+:639:NC_000913.3&quot;</span>,</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;IGR:(CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910/CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344):+:396:NC_000913.3&quot;</span>))</span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>allCounts<span class="sc">$</span>GeneidBackup <span class="ot">=</span> allCounts<span class="sc">$</span>Geneid</span></code></pre></div>
</div>
<p>First, it is important to identify which are IGR, CDS, and anti-sense.</p>
<div class="cell">
<div class="sourceCode" id="cb60"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>allCounts <span class="ot">&lt;-</span> allCounts <span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(Geneid, <span class="fu">c</span>(<span class="st">&quot;feature&quot;</span>, <span class="st">&quot;rest&quot;</span>), <span class="at">sep=</span><span class="st">&quot;[:]&quot;</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>allCounts</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  feature
1     CDS
2     CDS
3     IGR
4  AS_IGR
5     IGR
                                                                                                                                                                                       rest
1                                                                                                                                                                                     b2743
2                                                                                                                                                                                     b2764
3 (CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220/CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893)
4                                                         (CDS,b0008,talB,transaldolase_B,cds7,+,953/CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587)
5                                       (CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910/CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344)
                                                                                                                                                                                                     GeneidBackup
1                                                                                                                CDS:b2743:pcm:L-isoaspartate_protein_carboxylmethyltransferase_type_II:cds2705:-:626:NC_000913.3
2                                                                                                                      CDS:b2764:cysJ:sulfite_reductase2C_alpha_subunit2C_flavoprotein:cds2726:-:1799:NC_000913.3
3 IGR:(CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220/CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893):+:945:NC_000913.3
4                                                      AS_IGR:(CDS,b0008,talB,transaldolase_B,cds7,+,953/CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587):+:639:NC_000913.3
5                                       IGR:(CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910/CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344):+:396:NC_000913.3</code></pre>
</div>
</div>
<p>We keep only the IGR and AS_IGR strings, and we separate the two bookends. Note, the separation comes at the backslash.</p>
<div class="cell">
<div class="sourceCode" id="cb62"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>igr <span class="ot">&lt;-</span> allCounts <span class="sc">|&gt;</span> <span class="fu">filter</span>(feature <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;IGR&quot;</span>, <span class="st">&quot;AS_IGR&quot;</span>))</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>igr <span class="ot">&lt;-</span> igr <span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(GeneidBackup, <span class="fu">c</span>(<span class="st">&quot;Geneid1&quot;</span>, <span class="st">&quot;Geneid2&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;[/]&quot;</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(igr)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;feature&quot; &quot;rest&quot;    &quot;Geneid1&quot; &quot;Geneid2&quot;</code></pre>
</div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>igr</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  feature
1     IGR
2  AS_IGR
3     IGR
                                                                                                                                                                                       rest
1 (CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220/CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893)
2                                                         (CDS,b0008,talB,transaldolase_B,cds7,+,953/CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587)
3                                       (CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910/CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344)
                                                                                                           Geneid1
1 IGR:(CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220
2                                                                AS_IGR:(CDS,b0008,talB,transaldolase_B,cds7,+,953
3                                 IGR:(CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910
                                                                                                   Geneid2
1           CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893):+:945:NC_000913.3
2 CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587):+:639:NC_000913.3
3                 CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344):+:396:NC_000913.3</code></pre>
</div>
</div>
<p>For each of the two bookend Genes, we need to separate out the feature from the rest. Note that we write over feature1 in the second line of code below. Both of the bookends for all sequences are CDS elements.</p>
<div class="cell">
<div class="sourceCode" id="cb66"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>feature1 <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(igr, Geneid1, <span class="fu">c</span>(<span class="st">&quot;feature1&quot;</span>, <span class="st">&quot;rest&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;[,]&quot;</span>)<span class="sc">$</span>feature1</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>feature1 <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(igr, feature1, <span class="fu">c</span>(<span class="st">&quot;rest&quot;</span>, <span class="st">&quot;feature1&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;[()]&quot;</span>)<span class="sc">$</span>feature1</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>feature2 <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(igr, Geneid2, <span class="fu">c</span>(<span class="st">&quot;feature2&quot;</span>, <span class="st">&quot;rest&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;[,]&quot;</span>)<span class="sc">$</span>feature2</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(igr)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;feature&quot;  &quot;rest&quot;     &quot;Geneid1&quot;  &quot;Geneid2&quot;  &quot;feature1&quot; &quot;feature2&quot;</code></pre>
</div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>igr</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  feature
1     IGR
2  AS_IGR
3     IGR
                                                                                                                                                                                       rest
1 (CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220/CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893)
2                                                         (CDS,b0008,talB,transaldolase_B,cds7,+,953/CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587)
3                                       (CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910/CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344)
                                                                                                           Geneid1
1 IGR:(CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220
2                                                                AS_IGR:(CDS,b0008,talB,transaldolase_B,cds7,+,953
3                                 IGR:(CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910
                                                                                                   Geneid2
1           CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893):+:945:NC_000913.3
2 CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587):+:639:NC_000913.3
3                 CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344):+:396:NC_000913.3
  feature1 feature2
1      CDS      CDS
2      CDS      CDS
3      CDS      CDS</code></pre>
</div>
</div>
<p>As CDS, it is now important to find the actual genenames for each of the IGR sequences. We also keep each element’s <code>bnum</code> which represents a unique gene identifier in <em>E. coli</em>.</p>
<p><code>bnum</code>, <code>genename</code>, <code>rna.name</code> act as place holders for the types of elements that we will need to identify the bookends of the IGRs.</p>
<div class="cell">
<div class="sourceCode" id="cb70"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>bnum <span class="ot">=</span> <span class="st">&quot;b[0-9]{4}&quot;</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>bnum</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;b[0-9]{4}&quot;</code></pre>
</div>
<div class="sourceCode" id="cb72"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>genename <span class="ot">=</span> <span class="st">&quot;,[a-z]{3}[A-Z,].&quot;</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>rna.name <span class="ot">=</span> <span class="st">&quot;,rna[0-9]..&quot;</span></span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb73"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>start.gene <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  igr<span class="sc">$</span>feature1 <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(igr<span class="sc">$</span>Geneid1, genename),</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(igr<span class="sc">$</span>Geneid1, rna.name))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>end.gene <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  igr<span class="sc">$</span>feature2 <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(igr<span class="sc">$</span>Geneid2, genename),</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(igr<span class="sc">$</span>Geneid2, rna.name))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>start.bnum <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>  igr<span class="sc">$</span>feature1 <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(igr<span class="sc">$</span>Geneid1, bnum),</span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>igr<span class="sc">$</span>end.bnum <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  igr<span class="sc">$</span>feature2 <span class="sc">==</span> <span class="st">&quot;CDS&quot;</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_extract</span>(igr<span class="sc">$</span>Geneid2, bnum),</span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>igr <span class="ot">&lt;-</span> igr <span class="sc">|&gt;</span> tidyr<span class="sc">::</span><span class="fu">separate</span>(start.gene, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;comma&quot;</span>, <span class="st">&quot;start.gene&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;[,]&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-14"><a href="#cb73-14" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>comma) <span class="sc">|&gt;</span> </span>
<span id="cb73-15"><a href="#cb73-15" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">separate</span>(end.gene, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">&quot;comma&quot;</span>, <span class="st">&quot;end.gene&quot;</span>), <span class="at">sep =</span> <span class="st">&quot;[,]&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-16"><a href="#cb73-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>comma)</span>
<span id="cb73-17"><a href="#cb73-17" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(igr)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] &quot;feature&quot;    &quot;rest&quot;       &quot;Geneid1&quot;    &quot;Geneid2&quot;    &quot;feature1&quot;  
 [6] &quot;feature2&quot;   &quot;start.gene&quot; &quot;end.gene&quot;   &quot;start.bnum&quot; &quot;end.bnum&quot;  </code></pre>
</div>
<div class="sourceCode" id="cb75"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>igr</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  feature
1     IGR
2  AS_IGR
3     IGR
                                                                                                                                                                                       rest
1 (CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220/CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893)
2                                                         (CDS,b0008,talB,transaldolase_B,cds7,+,953/CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587)
3                                       (CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910/CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344)
                                                                                                           Geneid1
1 IGR:(CDS,b1594,mlc,glucosamine_anaerobic_growth_regulon_transcriptional_repressor3B_autorepressor,cds1581,-,1220
2                                                                AS_IGR:(CDS,b0008,talB,transaldolase_B,cds7,+,953
3                                 IGR:(CDS,b1808,yoaA,putative_ATP-dependent_helicase2C_DinG_family,cds1798,-,1910
                                                                                                   Geneid2
1           CDS,b1595,ynfL,LysR_family_putative_transcriptional_regulator,cds1582,-,893):+:945:NC_000913.3
2 CDS,b0009,mog,molybdochelatase_incorporating_molybdenum_into_molybdopterin,cds8,+,587):+:639:NC_000913.3
3                 CDS,b1809,yoaB,putative_reactive_intermediate_deaminase,cds1799,+,344):+:396:NC_000913.3
  feature1 feature2 start.gene end.gene start.bnum end.bnum
1      CDS      CDS        mlc     ynfL      b1594    b1595
2      CDS      CDS       talB      mog      b0008    b0009
3      CDS      CDS       yoaA     yoaB      b1808    b1809</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="lookaround" class="level2" data-number="9.4">
<h2 data-number="9.4"><span class="header-section-number">9.4</span> Lookaround</h2>
<p>A lookaround specifies a <strong>place</strong> in the regular expression that will anchor the string you’d like to match. There are four types of lookarounds: positive lookahead, positive lookbehind, negative lookahead, and negative lookbehind.</p>
<ul>
<li>“x(?=y)” – positive lookahead (matches ‘x’ when it is followed by ‘y’)</li>
<li>“x(?!y)” – negative lookahead (matches ‘x’ when it is not followed by ‘y’)</li>
<li>“(?&lt;=y)x” – positive lookbehind (matches ‘x’ when it is preceded by ‘y’)</li>
<li>“(?&lt;!y)x” – negative lookbehind (matches ‘x’ when it is not preceded by ‘y’)</li>
</ul>
<p>Note that the lookaround specifies a <strong>place</strong> in the string which means it does not return the details of the lookaround. Using lookarounds, you can test strings against patterns without including the lookaround pattern in the resulting match.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lookaround" class="quarto-figure quarto-figure-center quarto-float" alt="The four different lookaround options: positive and negative lookahead and lookbehind. Each lookaround provides an anchor for where to start the regular expression matching.">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-lookaround-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/lookaround.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1"><img src="images/lookaround.png" class="img-fluid" style="width:70.0%" alt="The four different lookaround options: positive and negative lookahead and lookbehind. Each lookaround provides an anchor for where to start the regular expression matching." /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lookaround-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 9.1: Image credit: Stefan Judis https://www.stefanjudis.com/blog/a-regular-expression-lookahead-lookbehind-cheat-sheet/
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="example---taskmaster" class="level2" data-number="9.5">
<h2 data-number="9.5"><span class="header-section-number">9.5</span> Example - Taskmaster</h2>
<p>In the following example, we will wrangle some data scraped from the wiki site for the TV series, Taskmaster. We won’t cover the html scraping here, but I include the code for completeness.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-taskmaster" class="quarto-figure quarto-figure-center quarto-float" alt="Screenshot of the wiki page for the Taskmaster TV series.">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-taskmaster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/taskmaster.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2"><img src="images/taskmaster.jpg" class="img-fluid" style="width:70.0%" alt="Screenshot of the wiki page for the Taskmaster TV series." /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taskmaster-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 9.2: Taskmaster Wiki https://taskmaster.fandom.com/wiki/Series_11
</figcaption>
</figure>
</div>
</div>
</div>
<section id="scraping-and-wrangling-taskmaster" class="level3" data-number="9.5.1">
<h3 data-number="9.5.1"><span class="header-section-number">9.5.1</span> Scraping and wrangling Taskmaster</h3>
<p>Goal: to scrape the Taskmaster wiki into a data frame including task, description, episode, episode name, air date, contestant, score, and series.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="cell">
<div class="sourceCode" id="cb77"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">read_html</span>(<span class="st">&quot;https://taskmaster.fandom.com/wiki/Series_11&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_element</span>(<span class="st">&quot;.tmtable&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">html_table</span>() <span class="sc">|&gt;</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">episode =</span> <span class="fu">ifelse</span>(<span class="fu">startsWith</span>(Task, <span class="st">&quot;Episode&quot;</span>), Task, <span class="cn">NA</span>)) <span class="sc">|&gt;</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(episode, <span class="at">.direction =</span> <span class="st">&quot;down&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">startsWith</span>(Task, <span class="st">&quot;Episode&quot;</span>), </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span>(Task <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;Total&quot;</span>, <span class="st">&quot;Grand Total&quot;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span><span class="fu">c</span>(Task, Description, episode),</span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;contestant&quot;</span>,</span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&quot;score&quot;</span>) <span class="sc">|&gt;</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">series =</span> <span class="dv">11</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb78"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Task, Description, episode, contestant, score, series) <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 6
  Task  Description                              episode contestant score series
  &lt;chr&gt; &lt;chr&gt;                                    &lt;chr&gt;   &lt;chr&gt;      &lt;chr&gt;  &lt;dbl&gt;
1 1     Prize: Best thing you can carry, but on… Episod… Charlotte… 1         11
2 1     Prize: Best thing you can carry, but on… Episod… Jamali Ma… 2         11
3 1     Prize: Best thing you can carry, but on… Episod… Lee Mack   4         11
4 1     Prize: Best thing you can carry, but on… Episod… Mike Wozn… 5         11
5 1     Prize: Best thing you can carry, but on… Episod… Sarah Ken… 3         11
6 2     Do the most impressive thing under the … Episod… Charlotte… 2         11
# ℹ 4 more rows</code></pre>
</div>
</div>
<section id="more-succinct-results" class="level4 unnumbered">
<h4 class="unnumbered">more succinct results</h4>
<div class="cell">
<div class="sourceCode" id="cb80"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>   Task  Description         episode   contestant score series</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>     Prize<span class="sc">:</span> Best thing…  Episode <span class="dv">1</span>… Charlotte… <span class="dv">1</span>         <span class="dv">11</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>     Prize<span class="sc">:</span> Best thing…  Episode <span class="dv">1</span>… Jamali Ma… <span class="dv">2</span>         <span class="dv">11</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>     Prize<span class="sc">:</span> Best thing…  Episode <span class="dv">1</span>… Lee Mack   <span class="dv">4</span>         <span class="dv">11</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>     Prize<span class="sc">:</span> Best thing…  Episode <span class="dv">1</span>… Mike Wozn… <span class="dv">5</span>         <span class="dv">11</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="dv">1</span>     Prize<span class="sc">:</span> Best thing…  Episode <span class="dv">1</span>… Sarah Ken… <span class="dv">3</span>         <span class="dv">11</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>     Do the most…        Episode <span class="dv">1</span>… Charlotte… <span class="dv">2</span>         <span class="dv">11</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>     Do the most…        Episode <span class="dv">1</span>… Jamali Ma… <span class="dv">3</span>[<span class="dv">1</span>]      <span class="dv">11</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>     Do the most…        Episode <span class="dv">1</span>… Lee Mack   <span class="dv">3</span>         <span class="dv">11</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>     Do the most…        Episode <span class="dv">1</span>… Mike Wozn… <span class="dv">5</span>         <span class="dv">11</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a>  <span class="dv">2</span>     Do the most…        Episode <span class="dv">1</span>… Sarah Ken… <span class="dv">4</span>         <span class="dv">11</span></span></code></pre></div>
</div>
<p>Currently, the episode column contains entries like</p>
<div class="cell">
<div class="sourceCode" id="cb81"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Episode 1: It&#39;s not your fault. (18 March 2021)&quot;</span></span></code></pre></div>
</div>
</section>
</section>
<section id="cleaning-the-score-column" class="level3" data-number="9.5.2">
<h3 data-number="9.5.2"><span class="header-section-number">9.5.2</span> Cleaning the score column</h3>
<div class="cell">
<div class="sourceCode" id="cb82"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(results<span class="sc">$</span>score)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
   –    ✔    ✘    0    1    2    3 3[1] 3[2]    4 4[2]    5   DQ 
   7    1    1   11   37   42   48    1    3   50    1   55   13 </code></pre>
</div>
</div>
<p>How <em>should</em> the scores be stored? What is the cleaning task?</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-taskmaster-scores" class="quarto-figure quarto-figure-center quarto-float" alt="Screenshot of the scores for each contestand on each task. Note that many of the scores have footnotes which are recorded in the results table from scraping the wiki.">
<figure class="quarto-float quarto-float-fig">
<div aria-describedby="fig-taskmaster-scores-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="images/taskmaster-scores.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3"><img src="images/taskmaster-scores.jpg" class="img-fluid" style="width:70.0%" alt="Screenshot of the scores for each contestand on each task. Note that many of the scores have footnotes which are recorded in the results table from scraping the wiki." /></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-taskmaster-scores-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure 9.3: Taskmaster Wiki https://taskmaster.fandom.com/wiki/Series_11
</figcaption>
</figure>
</div>
</div>
</div>
<section id="extracting-numeric-information" class="level4 unnumbered">
<h4 class="unnumbered">Extracting numeric information</h4>
<p>Suppose we have the following string:</p>
<div class="cell">
<div class="sourceCode" id="cb84"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;3[1]&quot;</span></span></code></pre></div>
</div>
<p>And we want to extract just the number “3”:</p>
<div class="cell">
<div class="sourceCode" id="cb85"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;3[1]&quot;</span>, <span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;3&quot;</code></pre>
</div>
</div>
<p>What if we don’t know which number to extract?</p>
<div class="cell">
<div class="sourceCode" id="cb87"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;3[1]&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;3&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb89"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;4[1]&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;4&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb91"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;10[1]&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;1&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb93"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;10[1]&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;10&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb95"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;DQ&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
</div>
</section>
<section id="str_extract" class="level4 unnumbered">
<h4 class="unnumbered"><code>str_extract()</code></h4>
<p><code>str_extract()</code> is an <strong>R</strong> function in the <strong>stringr</strong> package which finds <em>regular expressions</em> in strings of text.</p>
<div class="cell">
<div class="sourceCode" id="cb97"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My cat is 3 years old&quot;</span>, <span class="st">&quot;cat&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;cat&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb99"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My cat is 3 years old&quot;</span>, <span class="st">&quot;3&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;3&quot;</code></pre>
</div>
</div>
</section>
<section id="matching-multiple-options" class="level4 unnumbered">
<h4 class="unnumbered">Matching multiple options</h4>
<p><code>str_extract()</code> returns the first match; <code>str_extract_all()</code> allows more than one match.</p>
<div class="cell">
<div class="sourceCode" id="cb101"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My cat is 3 years old&quot;</span>, <span class="st">&quot;cat|dog&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;cat&quot;</code></pre>
</div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My dog is 10 years old&quot;</span>, <span class="st">&quot;cat|dog&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;dog&quot;</code></pre>
</div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My dog is 10 years old, my cat is 3 years old&quot;</span>, </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;cat|dog&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;dog&quot;</code></pre>
</div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract_all</span>(<span class="st">&quot;My dog is 10 years old, my cat is 3 years old&quot;</span>, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;cat|dog&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] &quot;dog&quot; &quot;cat&quot;</code></pre>
</div>
</div>
</section>
<section id="matching-groups-of-characters" class="level4 unnumbered">
<h4 class="unnumbered">Matching groups of characters</h4>
<p>What if I want to extract a <em>number</em>?</p>
<div class="cell">
<div class="sourceCode" id="cb109"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My cat is 3 years old&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;3&quot;</code></pre>
</div>
</div>
<p>What will the result be for the following code?</p>
<div class="cell">
<div class="sourceCode" id="cb111"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My dog is 10 years old&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb112"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My dog is 10 years old&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;1&quot;</code></pre>
</div>
</div>
<p>The <code>+</code> symbol in a regular expression means “repeated one or more times”</p>
<div class="cell">
<div class="sourceCode" id="cb114"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;My dog is 10 years old&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;10&quot;</code></pre>
</div>
</div>
</section>
<section id="extracting-from-multiple-strings" class="level4 unnumbered">
<h4 class="unnumbered">Extracting from multiple strings</h4>
<div class="cell">
<div class="sourceCode" id="cb116"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;My cat is 3 years old&quot;</span>, <span class="st">&quot;My dog is 10 years old&quot;</span>)</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(strings, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;3&quot;  &quot;10&quot;</code></pre>
</div>
</div>
<p>What if we have multiple instances across multiple strings? We need to be careful working with lists (instead of vectors).</p>
<div class="cell">
<div class="sourceCode" id="cb118"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>strings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;My cat is 3 years old&quot;</span>, <span class="st">&quot;My dog is 10 years old&quot;</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(strings, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;My&quot; &quot;My&quot;</code></pre>
</div>
<div class="sourceCode" id="cb120"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract_all</span>(strings, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">w+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[1] &quot;My&quot;    &quot;cat&quot;   &quot;is&quot;    &quot;3&quot;     &quot;years&quot; &quot;old&quot;  

[[2]]
[1] &quot;My&quot;    &quot;dog&quot;   &quot;is&quot;    &quot;10&quot;    &quot;years&quot; &quot;old&quot;  </code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="extracting-episode-information" class="level2" data-number="9.6">
<h2 data-number="9.6"><span class="header-section-number">9.6</span> Extracting episode information</h2>
<p>Currently, the <code>episode</code> column contains entries like:</p>
<div class="cell">
<div class="sourceCode" id="cb122"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span></span></code></pre></div>
</div>
<p>How would I extract just the episode number?</p>
<div class="cell">
<div class="sourceCode" id="cb123"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;2&quot;</code></pre>
</div>
</div>
<p>How would I extract the episode name?</p>
<p>Goal: find a pattern to match: <em>anything</em> that starts with a <code>:</code>, ends with a <code>.</code></p>
<p>Let’s break down that task into pieces.</p>
<p>How can we find the period at the end of the sentence? What does each of these lines of code return?</p>
<div class="cell">
<div class="sourceCode" id="cb125"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, <span class="st">&quot;.&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;E&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb127"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, <span class="st">&quot;.+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</code></pre>
</div>
</div>
<p>We use an <em>escape character</em> when we actually want to choose a period:</p>
<div class="cell">
<div class="sourceCode" id="cb129"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;.&quot;</code></pre>
</div>
</div>
<p>Recall the goal: find a pattern to match: <em>anything</em> that starts with a <code>:</code>, ends with a <code>.</code></p>
<div class="cell">
<div class="sourceCode" id="cb131"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;:.+</span><span class="sc">\\</span><span class="st">.&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;: The pie whisperer.&quot;</code></pre>
</div>
</div>
</section>
<section id="lookaround-again" class="level2" data-number="9.7">
<h2 data-number="9.7"><span class="header-section-number">9.7</span> Lookaround (again)</h2>
<section id="lookbehinds" class="level3" data-number="9.7.1">
<h3 data-number="9.7.1"><span class="header-section-number">9.7.1</span> Lookbehinds</h3>
<p><code>(?&lt;=)</code> is a <em>positive lookbehind</em>. It is used to identify expressions which are <em>preceded</em> by a particular expression.</p>
<div class="cell">
<div class="sourceCode" id="cb133"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;(?&lt;=: ).+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;The pie whisperer. (4 August 2015)&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb135"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;(?&lt;=</span><span class="sc">\\</span><span class="st">. ).+&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;(4 August 2015)&quot;</code></pre>
</div>
</div>
</section>
<section id="lookaheads" class="level3" data-number="9.7.2">
<h3 data-number="9.7.2"><span class="header-section-number">9.7.2</span> Lookaheads</h3>
<p><code>(?=)</code> is a <em>positive lookahead</em>. It is used to identify expressions which are <em>followed</em> by a particular expression.</p>
<div class="cell">
<div class="sourceCode" id="cb137"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;.+(?=</span><span class="sc">\\</span><span class="st">.)&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Episode 2: The pie whisperer&quot;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode" id="cb139"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;.+(?=:)&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;Episode 2&quot;</code></pre>
</div>
</div>
<section id="extracting-episode-information-1" class="level4 unnumbered">
<h4 class="unnumbered">Extracting episode information</h4>
<p>Getting everything between the <code>:</code> and the <code>.</code></p>
<div class="cell">
<div class="sourceCode" id="cb141"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;(?&lt;=: ).+(?=</span><span class="sc">\\</span><span class="st">.)&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;The pie whisperer&quot;</code></pre>
</div>
</div>
</section>
<section id="extracting-air-date" class="level4 unnumbered">
<h4 class="unnumbered">Extracting air date</h4>
<p>I want to extract just the air date. What pattern do I want to match?</p>
<div class="cell">
<div class="sourceCode" id="cb143"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, ...)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode" id="cb144"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str_extract</span>(<span class="st">&quot;Episode 2: The pie whisperer. (4 August 2015)&quot;</span>, </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;(?&lt;=</span><span class="sc">\\</span><span class="st">().+(?=</span><span class="sc">\\</span><span class="st">))&quot;</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] &quot;4 August 2015&quot;</code></pre>
</div>
</div>
</section>
<section id="wrangling-the-episode-info" class="level4 unnumbered">
<h4 class="unnumbered">Wrangling the episode info</h4>
<p>Currently:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 1
  episode                                        
  &lt;chr&gt;                                          
1 Episode 1: It&#39;s not your fault. (18 March 2021)
2 Episode 1: It&#39;s not your fault. (18 March 2021)
3 Episode 1: It&#39;s not your fault. (18 March 2021)
4 Episode 1: It&#39;s not your fault. (18 March 2021)
5 Episode 1: It&#39;s not your fault. (18 March 2021)
6 Episode 1: It&#39;s not your fault. (18 March 2021)
# ℹ 264 more rows</code></pre>
</div>
</div>
<p>One option:</p>
<div class="cell">
<div class="sourceCode" id="cb147"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">|&gt;</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(episode) <span class="sc">|&gt;</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">episode_name =</span> <span class="fu">str_extract</span>(episode, <span class="st">&quot;(?&lt;=: ).+(?=</span><span class="sc">\\</span><span class="st">.)&quot;</span>),</span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">air_date =</span> <span class="fu">str_extract</span>(episode, <span class="st">&quot;(?&lt;=</span><span class="sc">\\</span><span class="st">().+(?=</span><span class="sc">\\</span><span class="st">))&quot;</span>),</span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">episode =</span> <span class="fu">str_extract</span>(episode, <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 3
  episode episode_name        air_date     
  &lt;chr&gt;   &lt;chr&gt;               &lt;chr&gt;        
1 1       It&#39;s not your fault 18 March 2021
2 1       It&#39;s not your fault 18 March 2021
3 1       It&#39;s not your fault 18 March 2021
4 1       It&#39;s not your fault 18 March 2021
5 1       It&#39;s not your fault 18 March 2021
6 1       It&#39;s not your fault 18 March 2021
# ℹ 264 more rows</code></pre>
</div>
</div>
<p>Another option:</p>
<div class="cell">
<div class="sourceCode" id="cb149"><pre class="sourceCode r cell-code"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>results <span class="sc">|&gt;</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate_wider_regex</span>(episode, </span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">patterns =</span> <span class="fu">c</span>(<span class="st">&quot;.+ &quot;</span>, </span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">episode =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">d+&quot;</span>, </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;: &quot;</span>, </span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">episode_name =</span> <span class="st">&quot;.+&quot;</span>, </span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;</span><span class="sc">\\</span><span class="st">. </span><span class="sc">\\</span><span class="st">(&quot;</span>, </span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>                                    <span class="at">air_date =</span> <span class="st">&quot;.+&quot;</span>, </span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>                                    <span class="st">&quot;</span><span class="sc">\\</span><span class="st">)&quot;</span>))</span></code></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 270 × 3
  episode episode_name        air_date     
  &lt;chr&gt;   &lt;chr&gt;               &lt;chr&gt;        
1 1       It&#39;s not your fault 18 March 2021
2 1       It&#39;s not your fault 18 March 2021
3 1       It&#39;s not your fault 18 March 2021
4 1       It&#39;s not your fault 18 March 2021
5 1       It&#39;s not your fault 18 March 2021
6 1       It&#39;s not your fault 18 March 2021
# ℹ 264 more rows</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="regular-expressions-and-sql" class="level2" data-number="9.8">
<h2 data-number="9.8"><span class="header-section-number">9.8</span> Regular expressions and <strong>SQL</strong></h2>
<p>Back to the IMDb database…</p>
<div class="cell">
<div class="sourceCode" id="cb151"><pre class="sourceCode sql cell-code"><code class="sourceCode sql"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="kw">SELECT</span> production_year, title</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="kw">FROM</span> title</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">WHERE</span> kind_id <span class="op">=</span> <span class="dv">1</span> <span class="kw">AND</span></span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>        title REGEXP <span class="st">&#39;(?i)star&#39;</span></span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">LIMIT</span> <span class="dv">0</span>, <span class="dv">20</span>;</span></code></pre></div>
<div class="cell-output-display">
<table>
<caption>Displaying records 1 - 10</caption>
<thead>
<tr class="header">
<th style="text-align: right;">production_year</th>
<th style="text-align: left;">title</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">“Dancing with the Stars” (I)</td>
</tr>
<tr class="even">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">“Dancing with the Stars” (II)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2005</td>
<td style="text-align: left;">“Dancing with the Stars” (III)</td>
</tr>
<tr class="even">
<td style="text-align: right;">2017</td>
<td style="text-align: left;">“Girl Starter” (II)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">“Popstars” (I)</td>
</tr>
<tr class="even">
<td style="text-align: right;">2001</td>
<td style="text-align: left;">“Popstars” (II)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2002</td>
<td style="text-align: left;">“Popstars” (I)</td>
</tr>
<tr class="even">
<td style="text-align: right;">2000</td>
<td style="text-align: left;">“Popstars” (I)</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1959</td>
<td style="text-align: left;">“Startime” (II)</td>
</tr>
<tr class="even">
<td style="text-align: right;">1959</td>
<td style="text-align: left;">“Startime” (I)</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="reflection-questions" class="level2" data-number="9.9">
<h2 data-number="9.9"><span class="header-section-number">9.9</span> <i class="fas fa-lightbulb"></i> Reflection questions</h2>
<ol type="1">
<li><p>What is the difference between <code>[a|b]</code> and <code>(a|b)</code>?</p></li>
<li><p>What is the main character which needs to be escaped inside <code>[...]</code>? Why?</p></li>
<li><p>Why do we use lookarounds instead of just putting the location of interest inside our regular expression pattern?</p></li>
<li><p>What are the differences between <code>*</code>, <code>+</code>, and <code>?</code> ? How do the three metacharacters apply to a single character or a group of characters?</p></li>
<li><p>How can you find a string between two patterns without picking up the bookending patterns themselves?</p></li>
<li><p>Why does it make sense to write the regular expression pattern that matches the entire string of interest and not just a pattern which evaluates to TRUE?</p></li>
</ol>
</section>
<section id="ethics-considerations" class="level2" data-number="9.10">
<h2 data-number="9.10"><span class="header-section-number">9.10</span> <i class="fas fa-balance-scale"></i> Ethics considerations</h2>
<ol type="1">
<li><p>How can we use regular expressions to check for name mispellings or other similar data cleaning tasks?</p></li>
<li><p>Name one thing that you noticed in the course materials (either in class or reading the notes, etc.) where you thought to yourself “Oh, I’ll have to be really careful about <strong>that</strong>.” Why would you need to be careful?</p></li>
</ol>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden" data-render-id="quarto-int-sidebar-title">Foundations of Data Science in R</span> <span class="hidden" data-render-id="quarto-int-navbar-title">Foundations of Data Science in R</span> <span class="hidden" data-render-id="quarto-int-next">Data visualization</span> <span class="hidden" data-render-id="quarto-int-prev"><span class="chapter-number">8</span>  <span class="chapter-title">Text analysis</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/index.htmlWelcome-to-Foundations-of-Data-Science-in-R">Welcome to Foundations of Data Science in R</span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-1">Introduction to data science</span> <span class="hidden" data-render-id="quarto-int-sidebar:/01-intro.html&lt;span-class=&#39;chapter-number&#39;&gt;1&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Introduction&lt;/span&gt;"><span class="chapter-number">1</span>  <span class="chapter-title">Introduction</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/02-github.html&lt;span-class=&#39;chapter-number&#39;&gt;2&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;GitHub&lt;/span&gt;"><span class="chapter-number">2</span>  <span class="chapter-title">GitHub</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-2">Data acquisition</span> <span class="hidden" data-render-id="quarto-int-sidebar:/03-rvest.html&lt;span-class=&#39;chapter-number&#39;&gt;3&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Web-scraping&lt;/span&gt;"><span class="chapter-number">3</span>  <span class="chapter-title">Web scraping</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/04-sql-in-R.html&lt;span-class=&#39;chapter-number&#39;&gt;4&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;SQL-in-R-and-DBeaver&lt;/span&gt;"><span class="chapter-number">4</span>  <span class="chapter-title">SQL in R and DBeaver</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/05-sql-verbs.html&lt;span-class=&#39;chapter-number&#39;&gt;5&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;SQL-clauses&lt;/span&gt;"><span class="chapter-number">5</span>  <span class="chapter-title">SQL clauses</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/06-sql-joins.html&lt;span-class=&#39;chapter-number&#39;&gt;6&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Combining-tables-in-SQL&lt;/span&gt;"><span class="chapter-number">6</span>  <span class="chapter-title">Combining tables in SQL</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-3">Data exploration</span> <span class="hidden" data-render-id="quarto-int-sidebar:/07-wrangling.html&lt;span-class=&#39;chapter-number&#39;&gt;7&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Data-Wrangling&lt;/span&gt;"><span class="chapter-number">7</span>  <span class="chapter-title">Data Wrangling</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/08-text-analysis.html&lt;span-class=&#39;chapter-number&#39;&gt;8&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Text-analysis&lt;/span&gt;"><span class="chapter-number">8</span>  <span class="chapter-title">Text analysis</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/09-reg-expr.html&lt;span-class=&#39;chapter-number&#39;&gt;9&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Regular-expressions&lt;/span&gt;"><span class="chapter-number">9</span>  <span class="chapter-title">Regular expressions</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-4">Data visualization</span> <span class="hidden" data-render-id="quarto-int-sidebar:/10-grammar-graphics.html&lt;span-class=&#39;chapter-number&#39;&gt;10&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Grammar-of-graphics&lt;/span&gt;"><span class="chapter-number">10</span>  <span class="chapter-title">Grammar of graphics</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/11-ggplot.html&lt;span-class=&#39;chapter-number&#39;&gt;11&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;ggplot&lt;/span&gt;"><span class="chapter-number">11</span>  <span class="chapter-title">ggplot</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-5">Data conclusions</span> <span class="hidden" data-render-id="quarto-int-sidebar:/12-iteration.html&lt;span-class=&#39;chapter-number&#39;&gt;12&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Iteration&lt;/span&gt;"><span class="chapter-number">12</span>  <span class="chapter-title">Iteration</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/13-permutation-tests.html&lt;span-class=&#39;chapter-number&#39;&gt;13&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Permutation-tests&lt;/span&gt;"><span class="chapter-number">13</span>  <span class="chapter-title">Permutation tests</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:quarto-sidebar-section-6">Data communication</span> <span class="hidden" data-render-id="quarto-int-sidebar:/14-version-control.html&lt;span-class=&#39;chapter-number&#39;&gt;14&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Version-control&lt;/span&gt;"><span class="chapter-number">14</span>  <span class="chapter-title">Version control</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/15-R-tip-of-the-day.html&lt;span-class=&#39;chapter-number&#39;&gt;15&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;R-tip-of-the-day&lt;/span&gt;"><span class="chapter-number">15</span>  <span class="chapter-title">R tip-of-the-day</span></span> <span class="hidden" data-render-id="quarto-int-sidebar:/16-reprex.html&lt;span-class=&#39;chapter-number&#39;&gt;16&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Reproducible-examples&lt;/span&gt;"><span class="chapter-number">16</span>  <span class="chapter-title">Reproducible examples</span></span> <span class="hidden" data-render-id="quarto-breadcrumbs-Data-exploration">Data exploration</span> <span class="hidden" data-render-id="quarto-breadcrumbs-&lt;span-class=&#39;chapter-number&#39;&gt;9&lt;/span&gt;--&lt;span-class=&#39;chapter-title&#39;&gt;Regular-expressions&lt;/span&gt;"><span class="chapter-number">9</span>  <span class="chapter-title">Regular expressions</span></span></p>
<div class="hidden" data-render-id="footer-left">
<p>Foundations of Data Science in R, by Jo Hardin.</p>
</div>
<div class="hidden" data-render-id="footer-right">
<p>Built with 💚 and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden" data-render-id="quarto-metatitle">Foundations of Data Science in R - <span id="sec-reg-expr" class="quarto-section-identifier"><span class="chapter-number">9</span>  <span class="chapter-title">Regular expressions</span></span></span> <span class="hidden" data-render-id="quarto-twittercardtitle">Foundations of Data Science in R - <span id="sec-reg-expr" class="quarto-section-identifier"><span class="chapter-number">9</span>  <span class="chapter-title">Regular expressions</span></span></span> <span class="hidden" data-render-id="quarto-ogcardtitle">Foundations of Data Science in R - <span id="sec-reg-expr" class="quarto-section-identifier"><span class="chapter-number">9</span>  <span class="chapter-title">Regular expressions</span></span></span> <span class="hidden" data-render-id="quarto-metasitename">Foundations of Data Science in R</span> <span class="hidden" data-render-id="quarto-twittercarddesc"></span> <span class="hidden" data-render-id="quarto-ogcardddesc"></span></p>
</div>
<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure 9.1: Image credit: Stefan Judis https://www.stefanjudis.com/blog/a-regular-expression-lookahead-lookbehind-cheat-sheet/</span>
<span class="glightbox-desc lightbox-desc-2">Figure 9.2: Taskmaster Wiki https://taskmaster.fandom.com/wiki/Series_11</span>
<span class="glightbox-desc lightbox-desc-3">Figure 9.3: Taskmaster Wiki https://taskmaster.fandom.com/wiki/Series_11</span>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p> <code>\d\d.\d\d.\d\d</code> will work, but it will also match 123456. It is better to replace the dot with the characters of interest: <code>\d\d[/.\-]\d\d[/.\-]\d\d</code>. Remember that a dot inside a character class is just a dot. <a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><code>^(1[012]|[1-9]):[0-5][0-9] (am|pm)$</code><a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>In the former, the regex will search for <code>\bMary</code> or <code>Jane</code> or <code>Sue\b</code>. In the latter, the regex will search for <code>\bMary\b</code> or <code>\bJane\b</code> or <code>\bSue\b</code>. That is, Janet will match the former but not the latter.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Thanks to Ciaran Evans at Wake Forest University for example and code, https://sta279-f23.github.io/<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/ds002r-fds\.netlify\.app\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a  href="/08-text-analysis.html" class="pagination-link" aria-label="Text analysis">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class='chapter-number'>8</span>  <span class='chapter-title'>Text analysis</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a  href="/p3-data-viz.html" class="pagination-link" aria-label="Data visualization">
        <span class="nav-page-text">Data visualization</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <div class='footer-contents'>Foundations of Data Science in R, by Jo Hardin.
</div>  
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <div class='footer-contents'>Built with 💚 and <a href="https://quarto.org/">Quarto</a>.
</div>  
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"descPosition":"bottom","closeEffect":"zoom","selector":".lightbox","openEffect":"zoom","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>

</body>

</html>
