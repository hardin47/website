<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Simulating | Computational Statistics</title>
  <meta name="description" content="Class notes for Math 154 at Pomona College: Computational Statistics. The notes are based extensively on An Introduction to Statistical Learning by James, Witten, Hastie, and Tibshirani as well as Modern Data Science with R by Baumer, Kaplan, and Horton." />
  <meta name="generator" content="bookdown 0.13 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Simulating | Computational Statistics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Class notes for Math 154 at Pomona College: Computational Statistics. The notes are based extensively on An Introduction to Statistical Learning by James, Witten, Hastie, and Tibshirani as well as Modern Data Science with R by Baumer, Kaplan, and Horton." />
  <meta name="github-repo" content="hardin47/website/Math154/" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Simulating | Computational Statistics" />
  
  <meta name="twitter:description" content="Class notes for Math 154 at Pomona College: Computational Statistics. The notes are based extensively on An Introduction to Statistical Learning by James, Witten, Hastie, and Tibshirani as well as Modern Data Science with R by Baumer, Kaplan, and Horton." />
  

<meta name="author" content="Jo Hardin" />


<meta name="date" content="2019-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="wrang.html"/>
<link rel="next" href="references.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Computational Statistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Class Information</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#Sep3"><i class="fa fa-check"></i><b>1.1</b> 9/3/19 Agenda</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#course-logistics"><i class="fa fa-check"></i><b>1.2</b> Course Logistics</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#course-content"><i class="fa fa-check"></i><b>1.3</b> Course Content</a><ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#topics"><i class="fa fa-check"></i><b>1.3.1</b> Topics</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#vocabulary"><i class="fa fa-check"></i><b>1.3.2</b> Vocabulary</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#the-workflow"><i class="fa fa-check"></i><b>1.3.3</b> The Workflow</a></li>
<li class="chapter" data-level="1.3.4" data-path="intro.html"><a href="intro.html#principles-for-the-data-science-process-tldr"><i class="fa fa-check"></i><b>1.3.4</b> Principles for the Data Science Process tl;dr</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#Sep5"><i class="fa fa-check"></i><b>1.4</b> 9/5/19 Agenda</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#repro"><i class="fa fa-check"></i><b>1.5</b> Reproducibility</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#need-for-reproducibility"><i class="fa fa-check"></i><b>1.5.1</b> Need for Reproducibility</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-1"><i class="fa fa-check"></i>Example 1</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-2"><i class="fa fa-check"></i>Example 2</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-3"><i class="fa fa-check"></i>Example 3</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#example-4"><i class="fa fa-check"></i>Example 4</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#the-reproducible-data-analysis-process"><i class="fa fa-check"></i><b>1.5.2</b> The reproducible data analysis process</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#data-examples"><i class="fa fa-check"></i><b>1.6</b> Data Examples</a><ul>
<li class="chapter" data-level="1.6.1" data-path="intro.html"><a href="intro.html#college-rankings-systems"><i class="fa fa-check"></i><b>1.6.1</b> College Rankings Systems</a></li>
<li class="chapter" data-level="1.6.2" data-path="intro.html"><a href="intro.html#trump-and-twitter"><i class="fa fa-check"></i><b>1.6.2</b> Trump and Twitter</a></li>
<li class="chapter" data-level="1.6.3" data-path="intro.html"><a href="intro.html#can-twitter-predict-election-results"><i class="fa fa-check"></i><b>1.6.3</b> Can Twitter Predict Election Results?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>2</b> Visualization</a><ul>
<li class="chapter" data-level="2.1" data-path="visualization.html"><a href="visualization.html#Sep10"><i class="fa fa-check"></i><b>2.1</b> 9/10/19 Agenda</a></li>
<li class="chapter" data-level="2.2" data-path="visualization.html"><a href="visualization.html#examples"><i class="fa fa-check"></i><b>2.2</b> Examples</a><ul>
<li class="chapter" data-level="2.2.1" data-path="visualization.html"><a href="visualization.html#cholera-via-tufte"><i class="fa fa-check"></i><b>2.2.1</b> Cholera via Tufte</a></li>
<li class="chapter" data-level="2.2.2" data-path="visualization.html"><a href="visualization.html#challenger-via-tufte"><i class="fa fa-check"></i><b>2.2.2</b> Challenger via Tufte</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="visualization.html"><a href="visualization.html#thoughts"><i class="fa fa-check"></i><b>2.3</b> Thoughts on Plotting</a><ul>
<li class="chapter" data-level="2.3.1" data-path="visualization.html"><a href="visualization.html#advice"><i class="fa fa-check"></i><b>2.3.1</b> Advice</a></li>
<li class="chapter" data-level="2.3.2" data-path="visualization.html"><a href="visualization.html#an-example-from-information-is-beautiful"><i class="fa fa-check"></i><b>2.3.2</b> An example from Information is Beautiful</a></li>
<li class="chapter" data-level="2.3.3" data-path="visualization.html"><a href="visualization.html#assessing-graphics-and-other-analyses"><i class="fa fa-check"></i><b>2.3.3</b> Assessing Graphics (and Other Analyses)</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="visualization.html"><a href="visualization.html#Sep12"><i class="fa fa-check"></i><b>2.4</b> 9/12/19 Agenda</a></li>
<li class="chapter" data-level="2.5" data-path="visualization.html"><a href="visualization.html#deconstruct"><i class="fa fa-check"></i><b>2.5</b> Deconstructing a graph</a><ul>
<li class="chapter" data-level="2.5.1" data-path="visualization.html"><a href="visualization.html#gg"><i class="fa fa-check"></i><b>2.5.1</b> The Grammar of Graphics (<code>gg</code>)</a></li>
<li class="chapter" data-level="2.5.2" data-path="visualization.html"><a href="visualization.html#ggplot2"><i class="fa fa-check"></i><b>2.5.2</b> <code>ggplot2</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="wrang.html"><a href="wrang.html"><i class="fa fa-check"></i><b>3</b> Data Wrangling</a><ul>
<li class="chapter" data-level="3.1" data-path="wrang.html"><a href="wrang.html#Sep17"><i class="fa fa-check"></i><b>3.1</b> 9/17/19 Agenda</a></li>
<li class="chapter" data-level="3.2" data-path="wrang.html"><a href="wrang.html#datastruc"><i class="fa fa-check"></i><b>3.2</b> Structure of Data</a><ul>
<li class="chapter" data-level="3.2.1" data-path="wrang.html"><a href="wrang.html#building-tidy-data"><i class="fa fa-check"></i><b>3.2.1</b> Building Tidy Data</a></li>
<li class="chapter" data-level="3.2.2" data-path="wrang.html"><a href="wrang.html#examples-of-chaining"><i class="fa fa-check"></i><b>3.2.2</b> Examples of Chaining</a></li>
<li class="chapter" data-level="3.2.3" data-path="wrang.html"><a href="wrang.html#data-verbs-on-single-data-frames"><i class="fa fa-check"></i><b>3.2.3</b> Data Verbs (on single data frames)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="wrang.html"><a href="wrang.html#r-examples-basic-verbs"><i class="fa fa-check"></i><b>3.3</b> R examples, basic verbs</a><ul>
<li class="chapter" data-level="3.3.1" data-path="wrang.html"><a href="wrang.html#datasets"><i class="fa fa-check"></i><b>3.3.1</b> Datasets</a></li>
<li class="chapter" data-level="3.3.2" data-path="wrang.html"><a href="wrang.html#examples-of-chaining-1"><i class="fa fa-check"></i><b>3.3.2</b> Examples of Chaining</a></li>
<li class="chapter" data-level="3.3.3" data-path="wrang.html"><a href="wrang.html#data-verbs"><i class="fa fa-check"></i><b>3.3.3</b> Data Verbs</a></li>
<li class="chapter" data-level="3.3.4" data-path="wrang.html"><a href="wrang.html#summarize-and-group_by"><i class="fa fa-check"></i><b>3.3.4</b> <code>summarize</code> and <code>group_by</code></a></li>
<li class="chapter" data-level="3.3.5" data-path="wrang.html"><a href="wrang.html#babynames"><i class="fa fa-check"></i><b>3.3.5</b> babynames</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="wrang.html"><a href="wrang.html#Sep19"><i class="fa fa-check"></i><b>3.4</b> 9/19/19 Agenda</a></li>
<li class="chapter" data-level="3.5" data-path="wrang.html"><a href="wrang.html#highverb"><i class="fa fa-check"></i><b>3.5</b> Higher Level Data Verbs</a></li>
<li class="chapter" data-level="3.6" data-path="wrang.html"><a href="wrang.html#r-examples-higher-level-verbs"><i class="fa fa-check"></i><b>3.6</b> R examples, higher level verbs</a><ul>
<li class="chapter" data-level="3.6.1" data-path="wrang.html"><a href="wrang.html#pivot_longer"><i class="fa fa-check"></i><b>3.6.1</b> <code>pivot_longer</code></a></li>
<li class="chapter" data-level="3.6.2" data-path="wrang.html"><a href="wrang.html#pivot_wider"><i class="fa fa-check"></i><b>3.6.2</b> <code>pivot_wider</code></a></li>
<li class="chapter" data-level="3.6.3" data-path="wrang.html"><a href="wrang.html#join-use-join-to-merge-two-datasets"><i class="fa fa-check"></i><b>3.6.3</b> <code>join</code> (use <code>join</code> to <strong>merge</strong> two datasets)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="wrang.html"><a href="wrang.html#reprex"><i class="fa fa-check"></i><b>3.7</b> <code>reprex</code></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulating.html"><a href="simulating.html"><i class="fa fa-check"></i><b>4</b> Simulating</a><ul>
<li class="chapter" data-level="4.1" data-path="simulating.html"><a href="simulating.html#Sep24"><i class="fa fa-check"></i><b>4.1</b> 9/24/19 Agenda</a></li>
<li class="chapter" data-level="4.2" data-path="simulating.html"><a href="simulating.html#simulating-complicated-models"><i class="fa fa-check"></i><b>4.2</b> Simulating Complicated Models</a><ul>
<li class="chapter" data-level="4.2.1" data-path="simulating.html"><a href="simulating.html#goals-of-simulating-complicated-models"><i class="fa fa-check"></i><b>4.2.1</b> Goals of Simulating Complicated Models</a></li>
<li class="chapter" data-level="4.2.2" data-path="simulating.html"><a href="simulating.html#examples-of-pigs-and-blackjack"><i class="fa fa-check"></i><b>4.2.2</b> Examples of Pigs and Blackjack</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="simulating.html"><a href="simulating.html#Sep26"><i class="fa fa-check"></i><b>4.3</b> 9/26/19 Agenda</a></li>
<li class="chapter" data-level="4.4" data-path="simulating.html"><a href="simulating.html#simulating-to-assess-sensitivity"><i class="fa fa-check"></i><b>4.4</b> Simulating to Assess Sensitivity</a><ul>
<li class="chapter" data-level="4.4.1" data-path="simulating.html"><a href="simulating.html#technical-conditions"><i class="fa fa-check"></i><b>4.4.1</b> Technical Conditions</a></li>
<li class="chapter" data-level="4.4.2" data-path="simulating.html"><a href="simulating.html#generating-random-numbers"><i class="fa fa-check"></i><b>4.4.2</b> Generating random numbers</a></li>
<li class="chapter" data-level="4.4.3" data-path="simulating.html"><a href="simulating.html#generating-other-rvs-the-inverse-transform-method"><i class="fa fa-check"></i><b>4.4.3</b> Generating other RVs: <strong>The Inverse Transform Method</strong></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://st47s.com/Math154" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Computational Statistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulating" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Simulating</h1>
<div id="Sep24" class="section level2">
<h2><span class="header-section-number">4.1</span> 9/24/19 Agenda</h2>
<ol style="list-style-type: decimal">
<li>Why simulate?</li>
<li>What makes a good simulation</li>
<li>pigs / blackjack examples</li>
</ol>
<p>Below, computer simulations will be used for two main objectives:</p>
<ol style="list-style-type: decimal">
<li>To understand complicated models</li>
<li>To assess sensitivity of procedures</li>
</ol>
<p>We can use simulation studies to understand complex estimators, stochastic processes, etc. Often times, such analytic solutions exist in theory, but are extremely complicated to solve. In particular, as slight variations to the model are added, the simulation is often trivial to change whereas the analytic solution often becomes intractable. Similarly, repeated applications of a procedure (e.g., linear regression) to a scenario (e.g., a dataset, a set of parameters, etc.) can provide important insight into how the procedure varies / behaves.</p>
<!--
Snell's probability book discusses the need for simulation at length:  \url{http://www.dartmouth.edu/~chance/teaching_aids/books_articles/probability_book/amsbook.mac.pdf}
-->
</div>
<div id="simulating-complicated-models" class="section level2">
<h2><span class="header-section-number">4.2</span> Simulating Complicated Models</h2>
<p>Simulation is done to model a scenario which allows us to understand random behavior without actually replicating the entire study multiple times or trying to model the process analytically.</p>
<p>For example, what if you have a keen interest in understanding the probability of getting a single during room draw? Or getting a single on north campus? You wouldn’t actually run room draw thousands of times to find your probability of getting a single room. Similarly, the situation (e.g., room draw) may have too much information (e.g., all the different permutations of integers assigned to groups of 3 or 4 people) to model (easily) in a closed form solution. With a few moderate assumptions (proportion of students in groups of 1, 2, 3, 4; probability of choosing dorm X over dorm Y; random allocation of integers to students; etc.) it is straightforward to simulate the scenario thousands of time and measure the proportion of times your rank (47) will give you the room you want (single in Sontag).</p>
<p><strong>Example 1</strong> Consider the following problem from probability. Two points are selected randomly on a line of length <span class="math inline">\(L\)</span> so as to be on opposite sides of the midpoint of the line. [In other words, the two points <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are independent random variables such that <span class="math inline">\(X\)</span> is uniformly distributed over <span class="math inline">\((0,L/2)\)</span> and <span class="math inline">\(Y\)</span> is uniformly distributed over <span class="math inline">\((L/2, 1)\)</span>.] Find the probability that the 3 line segments from <span class="math inline">\(0\)</span> to <span class="math inline">\(X\)</span>, from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span>, and from <span class="math inline">\(Y\)</span> to <span class="math inline">\(L\)</span> could be made to form the three sides of a triangle. (Note that three line segments can be made to form a triangle if the length of each of them is less than the sum of the lengths of the others.)</p>
<p>The joint density is:
<span class="math display">\[ f(x,y) = \begin{cases} \frac{4}{L^2} &amp; 0 \le x \le L/2, \, L/2 \le y \le L \\ 0 &amp; else \end{cases} \]</span></p>
<p>The three pieces have lengths: <span class="math inline">\(X\)</span>, <span class="math inline">\(Y- X\)</span> and <span class="math inline">\(L - Y\)</span>. Three conditions need to be satisfied in order that the three pieces form a triangle:</p>
<p><span class="math display">\[\begin{eqnarray*}
X + (Y- X)&amp;&gt;&amp; (L - Y) \Rightarrow Y &gt; L - Y \Rightarrow 2 Y &gt; L \Rightarrow Y &gt; L/2 \\
X + (L-Y ) &amp;&gt;&amp; Y - X \Rightarrow 2X + L &gt; 2Y \Rightarrow X + \frac{L}{2} &gt; Y \\
Y + (L - Y) &amp;&gt;&amp; X \Rightarrow L &gt; X
\end{eqnarray*}\]</span></p>
<!--
%\begin{figure}[H]
%\begin{center}
%\includegraphics[scale=.2]{HW7Prob5.jpg}
%\caption{n.b. The picture is wrong.  The line should go from corner to corner, line $y=x + 1/2$.}
%\end{center}
%\end{figure}
-->
<p>The first and third conditions are always satisfied, so we just need to find the probability that <span class="math inline">\(Y\)</span> is below the line <span class="math inline">\(X + \frac{L}{2}\)</span>. The density is the same as in the previous problem, so, as before, we just need to find the area of the region below the line that is within the square <span class="math inline">\([0, L/2] \times [L/2, L]\)</span>, and then multiply it by <span class="math inline">\(\frac{4}{L^2}\)</span>.</p>
<p>Area = <span class="math inline">\(\displaystyle{ \frac{1}{2}\frac{L}{2}\frac{L}{2} = \frac{L^2}{8} }\)</span>.</p>
<p>Thus, the probability is</p>
<p><span class="math display">\[\begin{eqnarray*}
\int_{area} f(x,y)dxdy = \frac{4}{L^2} \frac{L^2}{8} =  \frac{1}{2}.
\end{eqnarray*}\]</span></p>
<p>What happens for different values of <span class="math inline">\(f(x,y)\)</span>? For example, if <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> have Beta(3,47) distributions on [0,.5] and [.5,1]? Simulating the probability in R is quite straightforward. What is the confidence bounds on the point estimates for the probabilities?? [n.b., we could simulate repeatedly to get a sense for the variability of our estimate!]</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb222-1" data-line-number="1">sticks &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb222-2" data-line-number="2">    pointx &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,<span class="dv">0</span>,.<span class="dv">5</span>)  <span class="co"># runif is &quot;random uniform&quot;, not &quot;run if&quot;</span></a>
<a class="sourceLine" id="cb222-3" data-line-number="3">    pointy &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>,.<span class="dv">5</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb222-4" data-line-number="4">    l1 &lt;-<span class="st"> </span>pointx</a>
<a class="sourceLine" id="cb222-5" data-line-number="5">    l2 &lt;-<span class="st"> </span>pointy<span class="op">-</span>pointx</a>
<a class="sourceLine" id="cb222-6" data-line-number="6">    l3 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pointy</a>
<a class="sourceLine" id="cb222-7" data-line-number="7">    <span class="kw">max</span>(l1,l2,l3) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">max</span>(l1,l2,l3)}</a>
<a class="sourceLine" id="cb222-8" data-line-number="8">    </a>
<a class="sourceLine" id="cb222-9" data-line-number="9"><span class="kw">sum</span>(<span class="kw">replicate</span>(<span class="dv">100000</span>, <span class="kw">sticks</span>())) <span class="op">/</span><span class="st"> </span><span class="dv">100000</span></a></code></pre></div>
<pre><code>## [1] 0.50257</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb224-1" data-line-number="1">sticks_beta &lt;-<span class="st"> </span><span class="cf">function</span>() {</a>
<a class="sourceLine" id="cb224-2" data-line-number="2">  pointx &lt;-<span class="st"> </span><span class="kw">rbeta</span>(<span class="dv">1</span>,<span class="dv">3</span>, <span class="dv">47</span>) <span class="op">/</span><span class="st"> </span><span class="dv">2</span>  <span class="co"># rbeta is random beta</span></a>
<a class="sourceLine" id="cb224-3" data-line-number="3">  pointy &lt;-<span class="st"> </span>(<span class="kw">rbeta</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">47</span>) <span class="op">+</span><span class="st">  </span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb224-4" data-line-number="4">  l1 &lt;-<span class="st"> </span>pointx</a>
<a class="sourceLine" id="cb224-5" data-line-number="5">  l2 &lt;-<span class="st"> </span>pointy<span class="op">-</span>pointx</a>
<a class="sourceLine" id="cb224-6" data-line-number="6">  l3 &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>pointy</a>
<a class="sourceLine" id="cb224-7" data-line-number="7">  <span class="kw">max</span>(l1,l2,l3) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">max</span>(l1,l2,l3)}</a>
<a class="sourceLine" id="cb224-8" data-line-number="8"></a>
<a class="sourceLine" id="cb224-9" data-line-number="9"><span class="kw">sum</span>(<span class="kw">replicate</span>(<span class="dv">100000</span>, <span class="kw">sticks_beta</span>())) <span class="op">/</span><span class="st"> </span><span class="dv">100000</span></a></code></pre></div>
<pre><code>## [1] 0.49774</code></pre>
<p><strong>Example 2</strong> Or consider the problem where the goal is to estimate <span class="math inline">\(E(X)\)</span> where <span class="math inline">\(X=\max \{ k: \sum_{i=1}^k U_i &lt; 1 \}\)</span> and <span class="math inline">\(U_i\)</span> are uniform(0,1). The simulation problem is quite straightforward. Look carefully at the pieces. How are they broken down into steps? Notice that the steps go from inside out.</p>
<ol style="list-style-type: decimal">
<li>Set k (the number of random numbers) equal to zero. And the running sum to zero.</li>
<li>Generate a uniform random variable.</li>
<li>Add the random variable to the running sum. Repeat steps 1 and 2 until the sum is larger than 1.</li>
<li>Figure out how many random variables were needed to get the sum larger than 1.</li>
<li>Repeat the entire process many times so as to account for variability in the simulation.</li>
<li>Use the law of large numbers to conclude that the average of the simulation approximates the expected value.</li>
</ol>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb226-1" data-line-number="1">allk &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb226-2" data-line-number="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb226-3" data-line-number="3">  k &lt;-<span class="st"> </span><span class="dv">0</span>; sumU &lt;-<span class="st"> </span><span class="dv">0</span>  </a>
<a class="sourceLine" id="cb226-4" data-line-number="4">  <span class="cf">while</span>(sumU <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) {</a>
<a class="sourceLine" id="cb226-5" data-line-number="5">    sumU &lt;-<span class="st"> </span>sumU <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb226-6" data-line-number="6">    k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> }</a>
<a class="sourceLine" id="cb226-7" data-line-number="7">  allk &lt;-<span class="st"> </span><span class="kw">c</span>(allk, k<span class="dv">-1</span>) }</a>
<a class="sourceLine" id="cb226-8" data-line-number="8"><span class="kw">mean</span>(allk)</a></code></pre></div>
<pre><code>## [1] 1.707</code></pre>
<div id="goals-of-simulating-complicated-models" class="section level3">
<h3><span class="header-section-number">4.2.1</span> Goals of Simulating Complicated Models</h3>
<p>The goal of simulating a complicated model is not only to create a program which will provide the desired results. We also hope to be able to code such that:</p>
<ol style="list-style-type: decimal">
<li>The problem is broken down into small pieces</li>
<li>The problem has checks in it to see what works (run the lines <em>inside</em> the if statements!)</li>
<li>Simple code is best</li>
</ol>
</div>
<div id="examples-of-pigs-and-blackjack" class="section level3">
<h3><span class="header-section-number">4.2.2</span> Examples of Pigs and Blackjack</h3>
<div id="pass-the-pigs" class="section level4">
<h4><span class="header-section-number">4.2.2.1</span> Pass the Pigs</h4>
<ul>
<li>Familiarize yourself with how to play Pass the Pigs at <a href="http://www.hasbro.com/common/instruct/passthepigs.pdf" class="uri">http://www.hasbro.com/common/instruct/passthepigs.pdf</a> and <a href="https://en.wikipedia.org/wiki/Pass_the_Pigs" class="uri">https://en.wikipedia.org/wiki/Pass_the_Pigs</a>.</li>
<li>For more information on how to play Pass the Pigs, google online resources and see the following manuscript, <a href="http://pubsonline.informs.org/doi/pdf/10.1287/ited.1120.0088" class="uri">http://pubsonline.informs.org/doi/pdf/10.1287/ited.1120.0088</a> <em>Analytics, Pedagogy and the Pass the Pigs Game</em>, (2012), Gorman, <strong>INFORMS Transactions on Education 1</strong>.</li>
<li>More sophisticated modeling: <a href="http://www.amstat.org/publications/jse/v14n3/datasets.kern.html" class="uri">http://www.amstat.org/publications/jse/v14n3/datasets.kern.html</a></li>
<li>Some strategies for playing: <a href="http://passpigs.tripod.com/strat.html" class="uri">http://passpigs.tripod.com/strat.html</a> (The link has other stuff, too.)</li>
</ul>
</div>
<div id="blackjack" class="section level4">
<h4><span class="header-section-number">4.2.2.2</span> Blackjack</h4>
<ul>
<li>Example and code come from **Data Science in R: a case studies approach to computational reasoning and problem solving*, by Nolan and Temple Lang.</li>
<li>Chapter 9 <em>Simulating Blackjack</em>, by Hadley Wickham</li>
<li>All R code is online at <a href="http://rdatasciencecases.org/">http://rdatasciencecases.org/</a></li>
<li>More about the game of blackjack, there are many online resources that you can use to learn about the came. Two resources that Nolan and Temple Lang recommend are <a href="http://wizardofodds.com/games/blackjack/" class="uri">http://wizardofodds.com/games/blackjack/</a> and <a href="http://hitorstand.net/" class="uri">http://hitorstand.net/</a>.</li>
</ul>
</div>
</div>
</div>
<div id="Sep26" class="section level2">
<h2><span class="header-section-number">4.3</span> 9/26/19 Agenda</h2>
<ol style="list-style-type: decimal">
<li>Sensitivity of mathematical procedures to technical conditions</li>
<li>Understanding bias in modeling</li>
<li>Generating random numbers</li>
</ol>
</div>
<div id="simulating-to-assess-sensitivity" class="section level2">
<h2><span class="header-section-number">4.4</span> Simulating to Assess Sensitivity</h2>
<p>As a second use of simulations, we can assess the sensitivity of parameters, model assumptions, sample size, etc. Ideally, the results will be summarized graphically, instead of as a table. A graphical representation can often provide insight into how parameters are related, whereas a table can be very hard to read.</p>
<p>Consider the following simulation where the top 10 GOP candidates get to participate in the debate, and the remaining 6 are kept out (example taken for debate on August 6, 2015). The write-up (and example) is a few years old, but the process is <strong>identical</strong> to the process used for deciding who is eligible for the 2020 Democtratic debates for president. <a href="http://www.nytimes.com/interactive/2015/07/21/upshot/election-2015-the-first-gop-debate-and-the-role-of-chance.html?_r=0" class="uri">http://www.nytimes.com/interactive/2015/07/21/upshot/election-2015-the-first-gop-debate-and-the-role-of-chance.html?_r=0</a></p>
<blockquote>
<p>A candidate needed to get at least two percent support in four different polls published from a list of approved pollsters between June 28 and August 28, 2019, which cannot be based on open-ended questions and may cover either the national level or one of the first four primary/caucus states (Iowa, New Hampshire, Nevada, and South Carolina). Only one poll from each approved pollster counted towards meeting the criterion in each region. <a href="https://en.wikipedia.org/wiki/2020_Democratic_Party_presidential_debates_and_forums">Wikipedia</a></p>
</blockquote>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="figs/GOPdebate.jpg" alt="For the 2016 election the Republican primary debates allowed only the top 10 candidates, ranked by national polls [NYT](https://www.nytimes.com/interactive/2015/07/21/upshot/election-2015-the-first-gop-debate-and-the-role-of-chance.html?_r=0)" width="981" />
<p class="caption">
Figure 1.5: For the 2016 election the Republican primary debates allowed only the top 10 candidates, ranked by national polls <a href="https://www.nytimes.com/interactive/2015/07/21/upshot/election-2015-the-first-gop-debate-and-the-role-of-chance.html?_r=0">NYT</a>
</p>
</div>
<div id="technical-conditions" class="section level3">
<h3><span class="header-section-number">4.4.1</span> Technical Conditions</h3>
<div id="definitions" class="section level4 unnumbered">
<h4>Definitions</h4>
<p><strong>p-value</strong> is the probability of obtaining the observed data or <em>more extreme</em> given the null hypothesis is true.</p>
<p><strong>confidence interval</strong> is a range of values collected in such a way that repeated samples of data (using the same mechanism) would capture the parameter of interest in <span class="math inline">\((1-\alpha)100\)</span>% of the intervals.</p>
</div>
<div id="examples-1" class="section level4 unnumbered">
<h4>Examples</h4>
<p><strong>Equal variance in the t-test</strong> Recall that one of the technical conditions for the t-test is that the two samples come from populations where the variance is equal (at least when <code>var.equal=TRUE</code> is specified). What happens if the null hypothesis is true (i.e., the <em>means</em> are equal!) but the technical conditions are violated (i.e., the variances are unequal)?</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb228-1" data-line-number="1">pvals &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb228-2" data-line-number="2">reps &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb228-3" data-line-number="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>reps){</a>
<a class="sourceLine" id="cb228-4" data-line-number="4">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean=</span><span class="dv">47</span>, <span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb228-5" data-line-number="5">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean=</span><span class="dv">47</span>, <span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb228-6" data-line-number="6">  pvals &lt;-<span class="st"> </span><span class="kw">c</span>(pvals, <span class="kw">t.test</span>(x1,x2, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)<span class="op">$</span>p.value) }</a>
<a class="sourceLine" id="cb228-7" data-line-number="7"></a>
<a class="sourceLine" id="cb228-8" data-line-number="8"><span class="kw">sum</span>(pvals <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>)<span class="op">/</span>reps</a></code></pre></div>
<pre><code>## [1] 0.0468</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb230-1" data-line-number="1">pvals &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb230-2" data-line-number="2">reps &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb230-3" data-line-number="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>reps){</a>
<a class="sourceLine" id="cb230-4" data-line-number="4">  x1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean=</span><span class="dv">47</span>, <span class="dt">sd=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb230-5" data-line-number="5">  x2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean=</span><span class="dv">47</span>, <span class="dt">sd=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb230-6" data-line-number="6">  pvals &lt;-<span class="st"> </span><span class="kw">c</span>(pvals, <span class="kw">t.test</span>(x1,x2, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)<span class="op">$</span>p.value) }</a>
<a class="sourceLine" id="cb230-7" data-line-number="7"></a>
<a class="sourceLine" id="cb230-8" data-line-number="8"><span class="kw">sum</span>(pvals <span class="op">&lt;</span><span class="st"> </span><span class="fl">.05</span>)<span class="op">/</span>reps</a></code></pre></div>
<pre><code>## [1] 0.067</code></pre>
<p><strong>Equal variance in the linear model</strong></p>
<p>Consider the following linear model with the points normally distributed with <em>equal</em> variance around the line. [Spoiler: when the technical conditions are met, the theory works out well. It turns out that the confidence interval will capture the true parameter in 95% of samples!]</p>
<p><span class="math display">\[ Y = -1 + 0.5 X_1 + 1.5 X_2 + \epsilon, \ \ \ \epsilon \sim N(0,1)\]</span></p>
<p><img src="04-simulating_files/figure-html/unnamed-chunk-8-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb232-1" data-line-number="1">beta2.in &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb232-2" data-line-number="2">beta0 &lt;-<span class="st"> </span><span class="dv">-1</span></a>
<a class="sourceLine" id="cb232-3" data-line-number="3">beta1 &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb232-4" data-line-number="4">beta2 &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb232-5" data-line-number="5">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb232-6" data-line-number="6">reps &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb232-7" data-line-number="7"></a>
<a class="sourceLine" id="cb232-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">4747</span>)</a>
<a class="sourceLine" id="cb232-9" data-line-number="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>reps){</a>
<a class="sourceLine" id="cb232-10" data-line-number="10">  x1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">each=</span>n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb232-11" data-line-number="11">  x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb232-12" data-line-number="12">  y &lt;-<span class="st"> </span>beta0 <span class="op">+</span><span class="st"> </span>beta1<span class="op">*</span>x1 <span class="op">+</span><span class="st"> </span>beta2<span class="op">*</span>x2 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb232-13" data-line-number="13"></a>
<a class="sourceLine" id="cb232-14" data-line-number="14">  CI &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x1<span class="op">+</span>x2) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tidy</span>(<span class="dt">conf.int=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb232-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb232-16" data-line-number="16">  beta2.in &lt;-<span class="st"> </span><span class="kw">c</span>(beta2.in, <span class="kw">between</span>(beta2, CI[<span class="dv">3</span>,<span class="dv">6</span>], CI[<span class="dv">3</span>,<span class="dv">7</span>]))</a>
<a class="sourceLine" id="cb232-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb232-18" data-line-number="18"></a>
<a class="sourceLine" id="cb232-19" data-line-number="19"><span class="co"># coverage rate of the CI is given by:</span></a>
<a class="sourceLine" id="cb232-20" data-line-number="20"><span class="kw">sum</span>(beta2.in)<span class="op">/</span>reps</a></code></pre></div>
<pre><code>## [1] 0.9516</code></pre>

<p>Consider the following linear model with the points normally distributed with <em>unequal</em> variance around the line. [Spoiler: when the technical conditions are met, the theory does not work out as well. It turns out that the confidence interval will not capture the true parameter in 95% of samples!]</p>
<p><span class="math display">\[ Y = -1 + 0.5 X_1 + 1.5 X_2 + \epsilon, \ \ \ \epsilon \sim N(0,1+ X_1 + 10 \cdot |X_2|)\]</span></p>
<p><img src="04-simulating_files/figure-html/unnamed-chunk-10-1.png" width="480" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb234-1" data-line-number="1">beta2.in &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb234-2" data-line-number="2">beta0 &lt;-<span class="st"> </span><span class="dv">-1</span></a>
<a class="sourceLine" id="cb234-3" data-line-number="3">beta1 &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb234-4" data-line-number="4">beta2 &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb234-5" data-line-number="5">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb234-6" data-line-number="6">reps &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb234-7" data-line-number="7"></a>
<a class="sourceLine" id="cb234-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">4747</span>)</a>
<a class="sourceLine" id="cb234-9" data-line-number="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>reps){</a>
<a class="sourceLine" id="cb234-10" data-line-number="10">  x1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">each=</span>n<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb234-11" data-line-number="11">  x2 &lt;-<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">max=</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb234-12" data-line-number="12">  y &lt;-<span class="st"> </span>beta0 <span class="op">+</span><span class="st"> </span>beta1<span class="op">*</span>x1 <span class="op">+</span><span class="st"> </span>beta2<span class="op">*</span>x2 <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x1 <span class="op">+</span><span class="st"> </span><span class="dv">10</span><span class="op">*</span><span class="kw">abs</span>(x2))</a>
<a class="sourceLine" id="cb234-13" data-line-number="13"></a>
<a class="sourceLine" id="cb234-14" data-line-number="14">  CI &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x1<span class="op">+</span>x2) <span class="op">%&gt;%</span><span class="st"> </span>broom<span class="op">::</span><span class="kw">tidy</span>(<span class="dt">conf.int=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">data.frame</span>()</a>
<a class="sourceLine" id="cb234-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb234-16" data-line-number="16">  beta2.in &lt;-<span class="st"> </span><span class="kw">c</span>(beta2.in, <span class="kw">between</span>(beta2, CI[<span class="dv">3</span>,<span class="dv">6</span>], CI[<span class="dv">3</span>,<span class="dv">7</span>]))</a>
<a class="sourceLine" id="cb234-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb234-18" data-line-number="18"></a>
<a class="sourceLine" id="cb234-19" data-line-number="19"><span class="co"># coverage rate of the CI is given by:</span></a>
<a class="sourceLine" id="cb234-20" data-line-number="20"><span class="kw">sum</span>(beta2.in)<span class="op">/</span>reps</a></code></pre></div>
<pre><code>## [1] 0.8717</code></pre>
</div>
</div>
<div id="generating-random-numbers" class="section level3">
<h3><span class="header-section-number">4.4.2</span> Generating random numbers</h3>
<p>(you are not responsible for the material on generating random numbers, but it’s pretty cool stuff that relies heavily on simulation.)</p>
<div id="how-do-we-generate-uniform01-numbers" class="section level4">
<h4><span class="header-section-number">4.4.2.1</span> How do we generate uniform[0,1] numbers?</h4>
<p>LCG - linear congruence generators. Set <span class="math inline">\(a,b,m\)</span> to be large integers. The sequence of numbers <span class="math inline">\(X_i / m\)</span> will pass all tests for uniformly distributed variables.
<span class="math display">\[ X_{n+1} = (aX_n + b) \mod m \]</span></p>
<p>where
* <span class="math inline">\(m\)</span> and <span class="math inline">\(b\)</span> are relatively prime,
* <span class="math inline">\(a - 1\)</span> is divisible by all prime factors of <span class="math inline">\(m\)</span>,
* <span class="math inline">\(a - 1\)</span> is divisible by 4 if <span class="math inline">\(m\)</span> is divisible by 4.</p>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb236-1" data-line-number="1">a &lt;-<span class="st"> </span><span class="dv">31541435235</span></a>
<a class="sourceLine" id="cb236-2" data-line-number="2">b &lt;-<span class="st"> </span><span class="dv">23462146143</span> </a>
<a class="sourceLine" id="cb236-3" data-line-number="3">m &lt;-<span class="st"> </span><span class="dv">423514351351</span></a>
<a class="sourceLine" id="cb236-4" data-line-number="4"></a>
<a class="sourceLine" id="cb236-5" data-line-number="5">xval &lt;-<span class="st"> </span><span class="dv">47</span> </a>
<a class="sourceLine" id="cb236-6" data-line-number="6">reps &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb236-7" data-line-number="7">xval.all &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb236-8" data-line-number="8"></a>
<a class="sourceLine" id="cb236-9" data-line-number="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>reps){</a>
<a class="sourceLine" id="cb236-10" data-line-number="10">  xval &lt;-<span class="st"> </span>(a<span class="op">*</span>xval <span class="op">+</span><span class="st"> </span>b) <span class="op">%%</span><span class="st"> </span>m</a>
<a class="sourceLine" id="cb236-11" data-line-number="11">  xval.all &lt;-<span class="st"> </span><span class="kw">c</span>(xval.all, xval)   }</a>
<a class="sourceLine" id="cb236-12" data-line-number="12"></a>
<a class="sourceLine" id="cb236-13" data-line-number="13"><span class="kw">hist</span>(xval.all<span class="op">/</span>m)</a></code></pre></div>
<p><img src="04-simulating_files/figure-html/unnamed-chunk-12-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="generating-other-rvs-the-inverse-transform-method" class="section level3">
<h3><span class="header-section-number">4.4.3</span> Generating other RVs: <strong>The Inverse Transform Method</strong></h3>
<!--
%\textcolor{red}{See Bill De Roses's simulation!!}
-->
<div id="continuous-rvs" class="section level4 unnumbered">
<h4>Continuous RVs</h4>
<p>Use the inverse of the cumulative distribution function to generate data that come from a particular continuous distribution. For example, generate 100 random normal deviates. Start by assuming that <span class="math inline">\(F\)</span> is a continuous and increasing function. Also assume that <span class="math inline">\(F^{-1}\)</span> exists.</p>
<p><span class="math display">\[F(x) = P(X \leq x)\]</span>
Note that <span class="math inline">\(F\)</span> is just the area function describing the density (histogram) of the data.</p>

<p><strong>Proof:</strong> that the algorithm above generates variables that come from the probability distribution represented by <span class="math inline">\(F\)</span>.</p>
<p><span class="math display">\[\begin{eqnarray*}
P(X \leq x) &amp;=&amp; P(F^{-1}(U) \leq x)\\
&amp;=&amp; P(U \leq F(x))\\
&amp;=&amp; F(x)\\
\end{eqnarray*}\]</span></p>
<p><strong>Example:</strong>
<span class="math display">\[ f(x) = \begin{cases}
 2x e^{-x^2} &amp; 0 &lt; x \\ 0 &amp; x &lt; 0 \end{cases}\]</span>
*Note:} This is known as a (<span class="math inline">\(\lambda=1\)</span>, <span class="math inline">\(k=2\)</span>) distribution.</p>

<ul>
<li>What is <span class="math inline">\(F(x)\)</span>?
<span class="math display">\[ F(x) = \int_0^x 2w e^{-w^2} dw = 1 - e^{-x^2}\]</span></li>
<li>What is <span class="math inline">\(F^{-1}(u)\)</span>?</li>
</ul>
<p><span class="math display">\[\begin{eqnarray*}
u &amp;=&amp; F(x)\\
&amp;=&amp; 1 - e^{-x^2}\\
1-u &amp;=&amp; e^{-x^2}\\
-\ln(1-u) &amp;=&amp; x^2\\
\sqrt{-\ln(1-u)} &amp;=&amp; x\\
F^{-1}(u) &amp;=&amp; \sqrt{-\ln(1-u)}
\end{eqnarray*}\]</span></p>
<ul>
<li>Suppose you could simulate uniform random variables, <span class="math inline">\(U_1, U_2, \dots\)</span>. How
could you use these to simulate RV’s with the Weibull density, <span class="math inline">\(f(x)\)</span>, given above?
<span class="math display">\[ \mbox{Let: } X_i = \sqrt{-\ln(1-U_i)}\]</span></li>
</ul>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb237-1" data-line-number="1">unifdata =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb237-2" data-line-number="2">weib1data =<span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>unifdata))</a>
<a class="sourceLine" id="cb237-3" data-line-number="3">weib2data =<span class="st"> </span><span class="kw">rweibull</span>(<span class="dv">10000</span>,<span class="dv">2</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb237-4" data-line-number="4"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb237-5" data-line-number="5"><span class="kw">hist</span>(weib1data, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">xlab=</span><span class="st">&quot;Weibull(2,1)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Using Inverse Transform&quot;</span>)</a>
<a class="sourceLine" id="cb237-6" data-line-number="6"><span class="kw">hist</span>(weib2data, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">xlab=</span><span class="st">&quot;Weibull(2,1)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Using R Function&quot;</span>)</a></code></pre></div>
<p><img src="04-simulating_files/figure-html/unnamed-chunk-13-1.png" width="480" style="display: block; margin: auto;" /></p>
</div>
<div id="discrete-rvs" class="section level4 unnumbered">
<h4>Discrete RVs</h4>
<p>A similar algorithm is used to generate data that come from a particular discrete distribution. For example, generate 100 random normal deviates. We start by assuming the probability mass function of <span class="math inline">\(X\)</span> is
<span class="math display">\[ P(X = x_i) = p_i, i=1, \ldots, m\]</span></p>

<p><strong>Proof:</strong> that the algorithm above generates variables that come from the probability mass function <span class="math inline">\(\{p_1, p_2, \ldots, p_m\}\)</span>.</p>
<p><span class="math display">\[\begin{eqnarray*}
P(X = x_j) &amp;=&amp; \sum_{i=1}^{j-1} p_i \leq U \leq \sum_{i=1}^j p_i\\
&amp;=&amp; \sum_{i=1}^j p_i - \sum_{i=1}^{j-1} p_i\\
&amp;=&amp; p_j\\
\end{eqnarray*}\]</span></p>
</div>
<div id="what-if-you-dont-know-f-or-cant-calculate-f-1" class="section level4 unnumbered">
<h4>What if you don’t know <span class="math inline">\(F\)</span>? Or can’t calculate <span class="math inline">\(F^{-1}\)</span>?</h4>
<p>In the case that the CDF cannot be calculated explicitly (the normal for example), one could still use this methodology by estimating F at a collection of points <span class="math inline">\(x_i, u_i = F(x_i)\)</span>. Now we temporarily mimic the discrete inverse transform, as we generate a <span class="math inline">\(U\)</span> and see which subinterval it falls in, i.e. <span class="math inline">\(u_i \leq U \leq u_{i+1}\)</span>. Assuming the <span class="math inline">\(x_i\)</span> are close enough, we expect the CDF to be approximately linear on this subinterval, so then we take a linear interpolation of the CDF on the subinterval to get <span class="math inline">\(X\)</span> via</p>
<p><span class="math display">\[\begin{eqnarray*}
X = \frac{u_{i+1} -  U}{u_{i+1} - u_i} x_i + \frac{U - u_i}{u_{i+1} - u_i} x_j
\end{eqnarray*}\]</span></p>
<p>However, the linear interpolation requires a complete approximation of <span class="math inline">\(F(x)\)</span>, regardless of the sample size desired, and doesn’t generalize to higher dimensions, and of course only gives you something with the approximate distribution back, even if you have your hands on real uniform random variables.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="wrang.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-simulating.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["Math-150-Notes.pdf", "Math-150-Notes.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
